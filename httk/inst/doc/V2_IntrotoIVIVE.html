<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John Wambaugh and Elaina Kenyon" />


<title>Introduction to In Vitro-In Vivo Extrapolation (IVIVE) with R Package httk</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to <em>In Vitro-In Vivo</em>
Extrapolation (IVIVE) with R Package httk</h1>
<h4 class="author">John Wambaugh and Elaina Kenyon</h4>
<h4 class="date">November, 2022</h4>



<p><em>Please send questions to <a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></em></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Chemical risk assessment depends on knowledge of inherent chemical
hazard, the dose-response relationship, and the extent of exposure that
occurs (<a href="https://doi.org/10.17226/24635">NASEM 2017</a>). High
throughput screening (HTS) for <em>in vitro</em> bioactivity allows
characterization of potential hazard for thousands of chemicals for
which no other testing has occurred (<a href="https://doi.org/10.1289/ehp.0800168">Judson et al., 2009</a>).</p>
<p>Toxicokinetics (TK) describes the Absorption, Distribution,
Metabolism, and Excretion (ADME) of a chemical by the body. TK relates
external exposures to internal tissue concentrations of chemical and
therefore informs the chemical dose-response relationship (<a href="https://doi.org/10.1016/j.tiv.2012.06.012">Coecke et al.,
2013</a>). TK requires chemical-specific information that is
traditionally obtained <em>in vivo</em>. However, most chemicals do not
have TK data, so a new approach methodology (NAM) uses <em>in vitro</em>
TK methods adapted from the pharmaceutical industry to provide the
necessary chemical-specific information (<a href="https://doi.org/10.1016/j.cotox.2019.07.001">Wambaugh et al.,
2019</a>, <a href="https://doi.org/10.3390/toxics10050232">Chang et al.,
2022</a>). High(er) throughput toxicokinetics (HTTK) involves the
combination of chemical-specific <em>in vitro</em> TK data and
chemical-independent (“generic”) TK models to predict TK (<a href="https://doi.org/10.1080/17425255.2021.1935867">Breen et al.,
2021</a>).</p>
<p>The primary goal of HTTK is to provide a human dose context for
bioactive <em>in vitro</em> concentrations from HTS (that is, <em>in
vitro-in vivo</em> extrapolation, or IVIVE) (<a href="https://doi.org/10.1016/j.tox.2014.05.012">Wetmore, 2015</a>).
IVIVE is Utilization of <em>in vitro</em> experimental data to predict
phenomena <em>in vivo</em>. In pharmaceutical development, HTTK methods
allow IVIVE to estimate therapeutic doses for clinical studies –
predicted concentrations are typically on the order of values measured
in clinical trials (<a href="https://doi.org/10.1124/dmd.110.032177">Wang, 2010</a>). High
throughput screening + IVIVE can predict a daily chemical dose rate
(mg/kg bw/day) that might be adverse (<a href="https://doi.org/10.1093/toxsci/kfz201">Paul Friedman et al.,
2019</a>).</p>
<p>A secondary goal is to provide open source data and models for
evaluation and use by the scientific community (<a href="https://doi.org/10.18637%2Fjss.v079.i04">Pearce et al.,
2017</a>).</p>
<p><em>The following material is from a lecture taught as part of the
course “Computational Methods in Chemical Risk Assessment” at Rutgers
University in September, 2019.</em></p>
<div id="prepare-r-to-run-the-vignette" class="section level2">
<h2>Prepare R to run the vignette</h2>
<p>R package <strong>knitr</strong> generates html and PDF documents
from this RMarkdown file, Each bit of code that follows is known as a
“chunk”. We start by telling <strong>knitr</strong> how we want our
chunks to look.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">collapse =</span> <span class="cn">TRUE</span>, <span class="at">comment =</span> <span class="st">&#39;#&gt;&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">rmarkdown.html_vignette.check_title =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="clear-the-memory" class="section level3">
<h3>Clear the memory</h3>
<p>It is a bad idea to let variables and other information from previous
R sessions float around, so we first remove everything in the R
memory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
</div>
<div id="httk-version" class="section level2">
<h2>HTTK Version</h2>
<p>This vignette was created using <strong>httk</strong> v2.2.2 in 2022.
Although we attempt to maintain backward compatibility, if you encounter
issues with the latest release of <strong>httk</strong> and cannot
easily address the changes, historical versions of <strong>httk</strong>
are available from: <a href="https://cran.r-project.org/src/contrib/Archive/httk/" class="uri">https://cran.r-project.org/src/contrib/Archive/httk/</a></p>
</div>
</div>
<div id="background" class="section level1">
<h1>Background</h1>
<p>If you are familiar with computer files and R you might want to skip
directly to “Step 1: Loading In Vitro Bioactivity Data”.</p>
<div id="files-and-folders" class="section level2">
<h2>Files and Folders</h2>
<p>R (or any computer program) needs to know where to look to find
particular information (such as data generated by a panel of in vitro
assays). We describe a chunk of information as a “file”. Files range in
size and can be small (even 0 bytes) or very large (several GB). A file
my physically be located on a disk drive inside your computing device
or, increasingly, it might be located somewhere in a cloud storage
network. Regardless, most computers will treat a file as if it has a
specific location. Each file has a name, although multiple files can
have the same name as long as those files are stored in different
“folders”.</p>
<p>Files for all the operating systems with R are organized using a
folder (also called a “directory”) and sub-folder structure. A
sub-folder is a folder within another folder. They can be well
organized:</p>
<p>/animals/cats/tabbies/</p>
<p>Or not:</p>
<p>/animals/gradschoolfiles/photosfromchildhood</p>
<p>The sequence of folders and sub-folders leading to a particular file
is referred to as a “path”. For information on how folder structures
work, please check out these sites:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Directory_structure" class="uri">https://en.wikipedia.org/wiki/Directory_structure</a></li>
<li><a href="https://www.geeksforgeeks.org/structures-of-directory-in-operating-system/" class="uri">https://www.geeksforgeeks.org/structures-of-directory-in-operating-system/</a></li>
</ul>
<p>Within the command shell you use the “cd” command to “change
directories”.</p>
<p>One complication to watch out for is the direction of the symbol that
separates folder names in the path. On Windows the path is separated by
“back-slashes”: \</p>
<p>\animals\cats\black</p>
<p>On Unix-based operating systems (including Linux and MacOS) the path
is separated by “forward slashes”: /</p>
<p>/animals/cats/black</p>
<p>R always uses Unix forward slashes, even on a Windows machine, so if
you know that the path is:</p>
<p>c:\users\USERNAME\Downloads\</p>
<p>You need to tell R that you want:</p>
<p>c:/users/USERNAME/Downloads/</p>
<p>Finally, the bit at the front of the path (such as “C:\” or “L:\”
tells the computer which “drive” to look in to find your folders. Often
“C drive” (c:\) is physically inside your machine while other letters
might indicate network (or cloud) drives.</p>
<div id="home-directory" class="section level3">
<h3>Home Directory</h3>
<p>Whether you are on Linux or Windows you have a home directory. Often
you will only be able to write and edit files within your home directory
and its sub-directories. However, you may be able to read and copy from
most other folders.</p>
<p>On Windows your home directory will be a sub-directory of
“C:\users\”. For example, “C:\users\jwambaug”.</p>
</div>
<div id="common-and-important-directories" class="section level3">
<h3>Common and Important Directories</h3>
<p>You will want to create a directory for your R packages locally on
your machine:</p>
<p>C:\users\USERNAME\AppData\Loca\R</p>
</div>
<div id="download-folders" class="section level3">
<h3>Download Folders</h3>
<p>Many web browsers put their files in a default directory such as</p>
<p>C:\users\USERNAME\Downloads</p>
</div>
<div id="temporary-or-swap-space" class="section level3">
<h3>Temporary (or “Swap”) Space</h3>
<p>On Windows the path “c:\” refers to the physical hard drive inside
your computer. Therefore the only copy of “c:\users\USERNAME\” is on
your computer and if that drive or the whole computer is damaged or
destroyed you have lost those files. For this reason we call this
“temporary” space. You don’t want to keep the only copies of your files
there.</p>
</div>
</div>
<div id="installing-necessary-software" class="section level2">
<h2>Installing Necessary Software</h2>
<ul>
<li>Users will need the freely available R statistical computing
language: <a href="https://www.r-project.org/" class="uri">https://www.r-project.org/</a></li>
<li>Users will likely want a development environment like RStudio: <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></li>
<li>If you get the message “Error in library(X) : there is no package
called ‘X’” then you will need to install that package: From the R
command prompt: install.packages(“X”) Or, if using RStudio, look for
‘Install Packages’ under the ‘Tools’ tab.</li>
<li>Note that R does not recognize fancy versions of quotation marks
‘,<span class="math inline">\(~\)</span>’,<span class="math inline">\(~\)</span>“, or<span class="math inline">\(~\)</span>”. If you are cutting and pasting from
software like Word or Outlook you may need to replace the quotation
marks that curve toward each other with ones typed by the keyboard.</li>
</ul>
<div id="installing-r-package-httk" class="section level3">
<h3>Installing R package “httk”</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;httk&quot;</span>)</span></code></pre></div>
</div>
<div id="installing-r-package-readxl" class="section level3">
<h3>Installing R package “readxl”</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;readxl&quot;</span>)</span></code></pre></div>
</div>
<div id="installing-r-package-ggplot2" class="section level3">
<h3>Installing R package “ggplot2”</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
</div>
<div id="eval-execute.vignette" class="section level3">
<h3>eval = execute.vignette</h3>
<p>If you are using the RMarkdown version of this vignette (extension,
.RMD) you will be able to see that several chunks of code in this
vignette have the statement “eval = execute.vignette”. The next chunk of
code, by default, sets execute.vignette = FALSE. This means that the
code is included (and necessary) but was not run when the vignette was
built. We do this because some steps require extensive computing time
and the checks on CRAN limit how long we can spend building the package.
If you want this vignette to work, you must run all code, either by
cutting and pasting it into R. Or, if viewing the .RMD file, you can
either change execute.vignette to TRUE or press “play” (the green arrow)
on each chunk in RStudio.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set whether or not the following chunks will be executed (run):</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>execute.vignette <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
</div>
<div id="load-the-necessary-packages" class="section level2">
<h2>Load the necessary packages:</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httk)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</div>
<div id="control-run-speed" class="section level2">
<h2>Control run speed</h2>
<p>Portions of this vignette use Monte Carlo sampling to simulate
variability and propagate uncertainty. The more samples that are used,
the more stable the results are (that is, the less likely they are to
change if a different random sequence is used). However, the more
samples that are used, the longer it takes to run. So, to speed up how
fast these examples run, we specify here that we only want to use 25
samples, even though the actual <strong>httk</strong> default is 1000.
Increase this number to get more stable (and accurate) results:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NSAMP <span class="ot">&lt;-</span> <span class="dv">25</span></span></code></pre></div>
</div>
</div>
<div id="step-one-loading-in-vitro-screening-data" class="section level1">
<h1>Step One: Loading <em>In Vitro</em> Screening Data</h1>
<p>The <a href="https://doi.org/10.1021/tx3000939">ToxCast</a> and <a href="https://doi.org/10.1289/ehp.1205784">Tox21</a> research programs
employ batteries of high-throughput assays to assess chemical
bioactivity <em>in vitro</em>. Not every chemical is tested through
every assay (<a href="https://doi.org/10.1289/ehp.1205784">Richard et
al., 2016</a>). Most assays are conducted in concentration response, and
each corresponding assay endpoint is analyzed statistically to determine
if there is a concentration-dependent response or “hit” using the
ToxCast Pipeline (<a href="https://doi.org/10.1093/bioinformatics/btw680">Filer et al.,
2017</a>). Most assay endpoint-chemical combinations are nonresponsive.
Here, only the hits are treated as potential indicators of
bioactivity.</p>
<p><em>In vitro</em> bioactivity does not necessarily indicate adversity
or hazard. Biological models can be used to make predictions of toxicity
based on <em>in vitro</em> data (for example, <a href="https://doi.org/10.1093/toxsci/kfr220">Sipes et al., 2011</a>, <a href="https://doi.org/10.1021/acs.est.5b02641">Browne et al., 2015</a>
and <a href="https://doi.org/10.1021/acs.chemrestox.6b00347">Kleinstreuer et
al., 2017</a>). However, here we make a more conservative, precautionary
assumption that concentrations too low to cause <em>in vitro</em>
bioactivity are more likely to be safe (<a href="https://doi.org/10.1093/toxsci/kfz201">Paul Friedman et al.,
2019</a>). Among all of the assay hits for each chemical, we choose to
use the lower 10th percentile of the <span class="math inline">\(\mu
M\)</span> potencies (50% active concentration or <span class="math inline">\(AC_{50}\)</span>). We are assuming that the 10th
percentile represents a low concentration for activating multiple assays
(assuming 10 or more bioactive assays were observed for a given
chemical). However, this bioactivity does not necessarily have a direct
toxicological interpretation.</p>
<div id="downloading-toxcast-data" class="section level2">
<h2>Downloading ToxCast Data</h2>
<p>The main page for the data is here: <a href="https://www.epa.gov/comptox-tools/exploring-toxcast-data" class="uri">https://www.epa.gov/comptox-tools/exploring-toxcast-data</a></p>
<p>Most useful to us is a single file containing all the hits across all
chemicals and assays: <a href="https://clowder.edap-cluster.com/datasets/6364026ee4b04f6bb1409eda?space=62bb560ee4b07abf29f88fef" class="uri">https://clowder.edap-cluster.com/datasets/6364026ee4b04f6bb1409eda?space=62bb560ee4b07abf29f88fef</a></p>
<p>As of November, 2022 the most recent version was 3.5 and was
available as an .Rdata file (invitrodb_3_5_mc5.Rdata), which we can
download and place in our working directory (FOLDERPATH).</p>
</div>
<div id="loading-the-data-into-r" class="section level2">
<h2>Loading the Data into R</h2>
<p>Don’t forget to use “setwd(FOLDERPATH)” to change to your R working
folder:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;FOLDERPATH&quot;</span>)</span></code></pre></div>
<p>Then load the file:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;invitrodb_3_5_mc5.Rdata&quot;</span>)</span></code></pre></div>
<p>We now have a file “mc5” in our woking environment. It’s absolutely
huge, so lets shrink it down to contain only the chemicals we care
about.</p>
<p>This list could be chemicals with HTTK data (note, this step cuts
things down to chemicals with human HTTK data, you could change species
to rat and get something different).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>toxcast.httk <span class="ot">&lt;-</span> <span class="fu">subset</span>(mc5, dsstox_substance_id <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">info=</span><span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span></code></pre></div>
</div>
</div>
<div id="critical-step-select-your-chemicals-of-interest" class="section level1">
<h1>Critical Step: Select your chemicals of interest</h1>
<p>We might have chemicals we are interested in for one reason or
another – you could type any chemical ID’s you want into the following
my.chems vector, or even load it from a file.</p>
<p>Here we’ll pick 50 chemicals at random from among the ToxCast
chemicals:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>my.chems <span class="ot">&lt;-</span> <span class="fu">sample</span>(mc5<span class="sc">$</span>dsstox_substance_id,<span class="dv">50</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>example.toxcast <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mc5[mc5<span class="sc">$</span>dsstox_substance_id <span class="sc">%in%</span> my.chems,])</span></code></pre></div>
<p>Unfortunately for this vignette there are too many ToxCast data to
fit into a 5mb R package. So we will subset to just the selected
chemicals and distribute only those data. In addition, out of 78 columns
in the data, we will keep only eight. Download the full data following
the instructions above.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>example.toxcast <span class="ot">&lt;-</span> example.toxcast[, <span class="fu">c</span>(<span class="st">&quot;chnm&quot;</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;dsstox_substance_id&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;spid&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;hitc&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;modl&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;aeid&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;modl_ga&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;modl_ac10&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;modl_acc&quot;</span>)]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># reduce precision to decrease space:</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modl_ga&quot;</span>, <span class="st">&quot;modl_ac10&quot;</span>, <span class="st">&quot;modl_acc&quot;</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> cols)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  example.toxcast[, this.col] <span class="ot">=</span> <span class="fu">signif</span>(example.toxcast[, this.col], <span class="dv">3</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(example.toxcast,<span class="at">file=</span><span class="st">&quot;introtoivive-toxcast.Rdata&quot;</span>,<span class="at">version=</span><span class="dv">2</span>)</span></code></pre></div>
<div id="interpreting-the-assay-information" class="section level2">
<h2>Interpreting the Assay Information</h2>
<p>In the mc5 table, “aenm” gives the assay name while
“dsstox_substance_id” is the chemical identity from the <a href="https://comptox.epa.gov/dashboard">CompTox Chemicals
Dashboard</a>. Since both names and CAS-RN can be subject to variations,
we track chemical identities with the DSSTox Substance ID’s or “DTXSIDs”
(<a href="https://doi.org/10.1016/j.comtox.2019.100096">Grulke et al.,
2019</a>).</p>
<p>The column “hitc” is 1 (that is, “TRUE”) if there was a
statistically-signficant systematic concentration-response observed
(this is a “hit”). “hitc” is 0 (FALSE) if there was no hit. The column
“mc6_flags” indicates features of the hit that might be of interest for
further examination but are not necessarily disqualifying.</p>
<p>The column “modl” indicates the type of concentration-response modl
that was selected (based on <a href="https://doi.org/10.1002/wics.1460">Akaike Information
Criterion</a>) to best describe the data. The possibilities are constant
(“cnst” – no concentation response), <a href="https://en.wikipedia.org/wiki/Hill_equation_(biochemistry)">Hill
equation</a> (“hill”), or gain-loss model (“gnls” – the product of an
increasing and decreasing Hill equations). “gnls” is often interpreted
as being caused by cytotoxicity.</p>
<p>The column “modl_ga” indicates the log10 uM concentration at which
the chemical caused 50% activity. This is also called the chemical-assay
“potency” or “<span class="math inline">\(AC_{50}\)</span>”.</p>
<p>Each chemical might have multiple assays for which there is a hit.
Each chemical may have been run multiple times (experimental
replicates), so that there may be multiple samples from the same
chemical for the same assay. Different samples are indicated by the
column “spid” (sample id).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>example.toxcast <span class="ot">&lt;-</span> httk<span class="sc">::</span>example.toxcast</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(example.toxcast), <span class="at">caption =</span> <span class="st">&quot;ToxCast In Vitro Bioactivity Data&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">floating.environment=</span><span class="st">&quot;sidewaystable&quot;</span>)</span></code></pre></div>
<table>
<caption>ToxCast In Vitro Bioactivity Data</caption>
<colgroup>
<col width="45%" />
<col width="15%" />
<col width="6%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="6%" />
<col width="7%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">chnm</th>
<th align="left">dsstox_substance_id</th>
<th align="left">spid</th>
<th align="right">hitc</th>
<th align="left">modl</th>
<th align="right">aeid</th>
<th align="right">modl_ga</th>
<th align="right">modl_ac10</th>
<th align="right">modl_acc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="left">01504168</td>
<td align="right">0</td>
<td align="left">cnst</td>
<td align="right">63</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="left">01504168</td>
<td align="right">1</td>
<td align="left">hill</td>
<td align="right">64</td>
<td align="right">1.390</td>
<td align="right">-0.282</td>
<td align="right">1.86</td>
</tr>
<tr class="odd">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="left">01504168</td>
<td align="right">0</td>
<td align="left">cnst</td>
<td align="right">65</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="left">01504168</td>
<td align="right">0</td>
<td align="left">hill</td>
<td align="right">66</td>
<td align="right">1.460</td>
<td align="right">-0.526</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="left">01504168</td>
<td align="right">0</td>
<td align="left">gnls</td>
<td align="right">67</td>
<td align="right">0.293</td>
<td align="right">-1.670</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="left">01504168</td>
<td align="right">0</td>
<td align="left">cnst</td>
<td align="right">68</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="find-the-concentrations-of-interest" class="section level2">
<h2>Find the concentrations of interest</h2>
<p>Then we can build a table summarizing the <em>in vitro</em> data. For
a “hit”, the “AC50” indicates the 50% activation concentration from the
best curve-fit, “AC10” indicates the concentration estimated to cause
10%, and “ACC” is the “activity concentration at cutoff” are which is
the concentration that first causes statistically significant activity.
See <a href="https://doi.org/10.1093/bioinformatics/btw680">Filer et
al. (2017)</a> figure three for additional discussion.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>toxcast.table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(example.toxcast<span class="sc">$</span>dsstox_substance_id))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(example.toxcast, dsstox_substance_id <span class="sc">==</span> this.id)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  these.hits <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.subset, hitc<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dim</span>(these.hits)[<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Compound=</span><span class="fu">as.character</span>(this.subset[<span class="dv">1</span>,<span class="st">&quot;chnm&quot;</span>]),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">DTXSID=</span>this.id,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Total.Assays =</span> <span class="fu">dim</span>(this.subset)[<span class="dv">1</span>],</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Unique.Assays =</span> <span class="fu">length</span>(<span class="fu">unique</span>(this.subset<span class="sc">$</span>aeid)),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Total.Hits =</span> <span class="fu">dim</span>(these.hits)[<span class="dv">1</span>],</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Unique.Hits =</span> <span class="fu">length</span>(<span class="fu">unique</span>(these.hits<span class="sc">$</span>aeid)),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Low.AC50 =</span> <span class="fu">signif</span>(<span class="fu">min</span>(these.hits<span class="sc">$</span>modl_ga),<span class="dv">3</span>),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Low.AC10 =</span> <span class="fu">signif</span>(<span class="fu">min</span>(these.hits<span class="sc">$</span>modl_ac10),<span class="dv">3</span>),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Low.ACC =</span> <span class="fu">signif</span>(<span class="fu">min</span>(these.hits<span class="sc">$</span>modl_acc),<span class="dv">3</span>),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Q10.AC50 =</span> <span class="fu">signif</span>(<span class="fu">quantile</span>(these.hits<span class="sc">$</span>modl_ga,<span class="at">probs=</span><span class="fl">0.1</span>),<span class="dv">3</span>),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Q10.AC10 =</span> <span class="fu">signif</span>(<span class="fu">quantile</span>(these.hits<span class="sc">$</span>modl_ac10,<span class="at">probs=</span><span class="fl">0.1</span>),<span class="dv">3</span>),</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Q10.ACC =</span> <span class="fu">signif</span>(<span class="fu">quantile</span>(these.hits<span class="sc">$</span>modl_acc,<span class="at">probs=</span><span class="fl">0.1</span>),<span class="dv">3</span>),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Med.AC50 =</span> <span class="fu">signif</span>(<span class="fu">median</span>(these.hits<span class="sc">$</span>modl_ga),<span class="dv">3</span>),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Med.AC10 =</span> <span class="fu">signif</span>(<span class="fu">median</span>(these.hits<span class="sc">$</span>modl_ac10),<span class="dv">3</span>),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Med.ACC =</span> <span class="fu">signif</span>(<span class="fu">median</span>(these.hits<span class="sc">$</span>modl_acc),<span class="dv">3</span>),</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Q90.AC50 =</span> <span class="fu">signif</span>(<span class="fu">quantile</span>(these.hits<span class="sc">$</span>modl_ga,<span class="at">probs=</span><span class="fl">0.9</span>),<span class="dv">3</span>),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Q90.AC10 =</span> <span class="fu">signif</span>(<span class="fu">quantile</span>(these.hits<span class="sc">$</span>modl_ac10,<span class="at">probs=</span><span class="fl">0.9</span>),<span class="dv">3</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Q90.ACC =</span> <span class="fu">signif</span>(<span class="fu">quantile</span>(these.hits<span class="sc">$</span>modl_acc,<span class="at">probs=</span><span class="fl">0.9</span>),<span class="dv">3</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    toxcast.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(toxcast.table, this.row)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(toxcast.table) <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">dim</span>(toxcast.table)[<span class="dv">1</span>])</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(toxcast.table[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]), <span class="at">caption =</span> <span class="st">&quot;Summarized ToxCast Data&quot;</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">floating.environment=</span><span class="st">&quot;sidewaystable&quot;</span>)</span></code></pre></div>
<table>
<caption>Summarized ToxCast Data</caption>
<colgroup>
<col width="47%" />
<col width="12%" />
<col width="10%" />
<col width="11%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Compound</th>
<th align="left">DTXSID</th>
<th align="right">Total.Assays</th>
<th align="right">Unique.Assays</th>
<th align="right">Total.Hits</th>
<th align="right">Unique.Hits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Methyl
perfluoro(3-(1-ethenyloxypropan-2-yloxy)propanoate)</td>
<td align="left">DTXSID8044969</td>
<td align="right">1087</td>
<td align="right">467</td>
<td align="right">80</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="left">Nonafluoropentanamide</td>
<td align="left">DTXSID60400587</td>
<td align="right">792</td>
<td align="right">496</td>
<td align="right">7</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Bisphenol A</td>
<td align="left">DTXSID7020182</td>
<td align="right">4304</td>
<td align="right">1414</td>
<td align="right">814</td>
<td align="right">375</td>
</tr>
<tr class="even">
<td align="left">Tris(2-ethylhexyl) trimellitate</td>
<td align="left">DTXSID9026265</td>
<td align="right">1241</td>
<td align="right">941</td>
<td align="right">46</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">1-Octen-3-ol</td>
<td align="left">DTXSID3035214</td>
<td align="right">427</td>
<td align="right">427</td>
<td align="right">19</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">Thalidomide</td>
<td align="left">DTXSID9022524</td>
<td align="right">1161</td>
<td align="right">922</td>
<td align="right">6</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-two-high-throughput-toxicokinetics-from-in-vitro-data" class="section level1">
<h1>Step Two: High Throughput Toxicokinetics from <em>In Vitro</em>
Data</h1>
<p>For each chemical in your subset of ToxCast, add the HTTK plasma
steady-state concentration if it is available. calc_mc_css() gives us
the predicted steady-state plasma concentration resulting from an
ongoing 1 mg/kg/day exposure.</p>
<div id="steady-state-plasma-concentration-c_ss" class="section level2">
<h2>Steady State Plasma Concentration <span class="math inline">\(C_{ss}\)</span></h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(toxcast.table<span class="sc">$</span>DTXSID))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get_cheminfo() gives a list of all the CAS numbers for which HTTK will work:</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.id <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>, <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random number generator seed so that the Monte Carlo will always give</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the same random sequence:</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    toxcast.table[toxcast.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Css&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">calc_mc_css</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">samples=</span>NSAMP,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    toxcast.table[toxcast.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Css.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;in vitro&quot;</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s look at just the relevant columns from our table. Any Css
values of “NA” (not a number) indicate that we don’t currently have
<em>in vitro</em> TK data for those chemicals:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(toxcast.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;Q10.AC50&quot;</span>,<span class="st">&quot;Css&quot;</span>,<span class="st">&quot;Css.Type&quot;</span>)], </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">caption =</span> <span class="st">&quot;Summarized ToxCast Data&quot;</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">floating.environment=</span><span class="st">&quot;sidewaystable&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="step-three-high-throughput-toxicokinetics-with-qspr-predictions" class="section level1">
<h1>Step Three: High Throughput Toxicokinetics with QSPR
Predictions</h1>
<p>For chemicals where no <em>in vitro</em> toxicokinetic data are
available, we can sometimes load predictions from <em>in silico</em>
models. We do not provide <em>in silico</em> models for <span class="math inline">\(f_{up}\)</span> and <span class="math inline">\(Cl_{int}\)</span> themselves (in many cases those
models are much larger in terms of file size than the whole
<strong>httk</strong> package). However we do have tables of pre-made
predictions form a variety of models. For example, you can load the
table of quantitative structure-property relationship (QSPR) model
predictions from the <a href="https://doi.org/10.1021/acs.est.7b00650">Sipes et al. (2017)</a>
supplemental material:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load_sipes2017</span>()</span></code></pre></div>
<p>Now go through the list of chemicals again but only calculate if we
didn’t already have a value (NOTE: load_sipes2017 will not overwrite the
<em>in vitro</em> data by default, so you’ll still get the same answer
if you use the same random number seed, but you would also be wasting
time):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(toxcast.table<span class="sc">$</span>DTXSID))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.id <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(<span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>, <span class="at">suppress.messages=</span><span class="cn">TRUE</span>) <span class="sc">&amp;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(toxcast.table[toxcast.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Css&quot;</span>]))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random number generator seed so that the Monte Carlo will always give</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the same random sequence:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    toxcast.table[toxcast.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Css&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">calc_mc_css</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">samples=</span>NSAMP,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    toxcast.table[toxcast.table<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Css.Type&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;in silico&quot;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Take another look at our table – many of the gaps are now filled in.
Any Css values of “NA” (not a number) indicate that we don’t currently
have <em>in vitro</em> TK data or <em>in silico</em> predictions from <a href="https://doi.org/10.1021/acs.est.7b00650">Sipes et al. (2017)</a>
for those chemicals (note that there are also predictions available from
<a href="https://doi.org/10.1016/j.comtox.2020.100136">Pradeep et
al. (2020)</a> (load_pradeep2020) and <a href="https://doi.org/10.1021/acs.est.0c06117">Dawson et al. (2021)</a>
(load_dawson2021):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(toxcast.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;Q10.AC50&quot;</span>,<span class="st">&quot;Css&quot;</span>,<span class="st">&quot;Css.Type&quot;</span>)], </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">caption =</span> <span class="st">&quot;Summarized ToxCast Data&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">floating.environment=</span><span class="st">&quot;sidewaystable&quot;</span>)</span></code></pre></div>
</div>
<div id="step-four-reverse-dosimetry-in-vitro-in-vivo-extrapolation" class="section level1">
<h1>Step Four: Reverse Dosimetry <em>In Vitro-In Vivo</em>
Extrapolation</h1>
<p>Most IVIVE calculations in <strong>httk</strong> take advantage of
the fact that, to date, the toxicokinetic models included in
<strong>httk</strong> are linear in dose. What this means is that your
dose rate is <span class="math inline">\(X~mg/kg/day\)</span> and the
<span class="math inline">\(C_{ss}\)</span> for <span class="math inline">\(1~mg/kg/day\)</span> is <span class="math inline">\(Y~uM\)</span>, then the <span class="math inline">\(C_{ss}\)</span> for <span class="math inline">\(X~mg/kg/day\)</span> is <span class="math inline">\(X*Y~uM\)</span>, that is: <span class="math display">\[C_{ss}\left(X~mg/kg/day\right) = X *
C_{ss}\left(1~mg/kg/day\right)\]</span>. Using toxicokinetics to predict
tissue concentrations resulting from a known dose is known as “forward
dosimetry”. Using toxicokinetics to estimate the dose that might have
led to a known tissue cocentration is known as “reverse dosimetry” <a href="https://doi.org/10.1016/j.taap.2008.04.021">(Clewell, et al.,
2008)</a>. <strong>httk</strong> allows the use of reverse dosimetry to
calculate the equivalent steady-state dose to produce a plasma
concentration equal to a bioactive concentration identified <em>in
vitro</em> <a href="https://doi.org/10.1080/17425255.2021.1935867">(Breen et al.,
2021)</a>. For example, we can start from the tenth percentile ToxCast
<span class="math inline">\(AC_{50}\)</span> and find the administered
equivalent dose that would cause that concentration in the plasma. We do
this by dividing the <em>in vitro</em> concentration by the <span class="math inline">\(C_{ss}\)</span> from 1 mg/kg/day, ending up with a
dose rate with units of mg/kd/day that will product the <em>in
vitro</em> concentration: <span class="math display">\[AED =
\frac{AC_{50}}{C_{ss}\left(1~mg/kg/day\right)}~mg/kg/day\]</span> where
b0oth <span class="math inline">\(AC_{50}\)</span> and <span class="math inline">\(C_{ss}\)</span> must have the same units. Do not
forget that the ToxCast concentrations are given on the log-10
scale:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>toxcast.table<span class="sc">$</span>EquivDose <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>toxcast.table<span class="sc">$</span>Q10.AC50 <span class="sc">/</span> toxcast.table<span class="sc">$</span>Css,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">3</span>)</span></code></pre></div>
<p>Look at the table again:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(toxcast.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;Q10.AC50&quot;</span>,<span class="st">&quot;Css&quot;</span>,<span class="st">&quot;EquivDose&quot;</span>)], </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">caption =</span> <span class="st">&quot;Summarized ToxCast Data&quot;</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">floating.environment=</span><span class="st">&quot;sidewaystable&quot;</span>)          </span></code></pre></div>
</div>
<div id="step-five-compare-with-estimated-exposure-rates" class="section level1">
<h1>Step Five: Compare with Estimated Exposure Rates</h1>
<p>The U.S. National Academy of Sciences, Engineering, and Medicine
advises calculating chemical risk posed to the public health on the
basis of hazard, the dose-response relationship, and exposure <a href="https://doi.org/10.17226/366">(NRC, 1983)</a>. We can use <em>in
vitro</em> bioactivity as a surrogate for hazard and
<strong>httk</strong> as a surrogate for the dose-reponse relationship.
However, to prioritize chemicals on the basis of putative risk we need
some estimate of human exposure. Because most chemicals lack measured
data characterizing population intake rates (mg/kg body weight/ day) (<a href="https://doi.org/10.1016/j.scitotenv.2011.10.046">Egeghy,
2012</a>), a consensus prediction from EPA’s Systematic Empirical
Evaluation of Models (SEEM) is often the only option available for
exposures. The SEEM consensus prediction is composed of multiple
exposure predictors aggregated on the basis of likely exposure pathways
(<a href="https://doi.org/10.1021/acs.est.8b04056">Ring, 2018</a>). The
individual exposure predictors are weighted based upon their ability to
predict intake rates that could be inferred from biomonitoring data (<a href="https://doi.org/10.1016/j.envint.2017.06.004">Ring, 2017</a>; <a href="https://doi.org/10.1021/es503583j">Wambaugh, 2014</a>).<br />
The SEEM exposure forecasts are uncertain, and the upper boundary of the
95% credible interval is used here. Although a 95% credible interval is
calculated, this reflects uncertainty but not variability – the <a href="https://doi.org/10.1021/acs.est.8b04056">(Ring, 2018)</a> model
predicts population median exposure rates for the U.S. population.</p>
<p>There are three ways to access the SEEM predictions. If you can
access the journal article online, we can load the SEEM predictions from
<a href="https://pubs.acs.org/doi/suppl/10.1021/acs.est.8b04056/suppl_file/es8b04056_si_002.zip">Supplemental
Table 1</a> of the Supporting Information for <a href="https://doi.org/10.1021/acs.est.8b04056">Ring et al. (2018)</a>.
Don’t forget that you have to “unzip” a file that ends in “.zip” and
place the “.txt” file in your working directory with your other
files.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>SEEM <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;SupTable-all.chem.preds-2018-11-28.txt&quot;</span>,<span class="at">stringsAsFactors=</span>F)</span></code></pre></div>
<p>If you want, you can also download the predictions for specific
chemicals from the <a href="https://comptox.epa.gov/dashboard/">Comptox
Chemicals Dashboard</a>. Be sure to use Batch Search and select the
option for “NHANES/Predicted Exposure”. You can download the file in a
“comma separated values” or “.CSV” format, in which case you use
“read.csv”. Or you can download an Excel “.xls” file which requires load
the package <em>readXL</em>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>SEEM <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;CCD-Batch-Search_DATE.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Perhaps most easily we can grab SEEM predictions already in RData
format from <a href="https://github.com/HumanExposure/SEEM3RPackage/tree/main/SEEM3Predictor/data">GitHub</a>
Download the file Ring2018Preds.RData and load it:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;Ring2018Preds.RData&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>SEEM <span class="ot">&lt;-</span> Ring2018.preds</span></code></pre></div>
<p>Again we do not have the space to distribute all the SEEM predictions
within this R package, but we can give you our example chemicals:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>example.seem <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">subset</span>(SEEM, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                              dsstox_substance_id <span class="sc">%in%</span> toxcast.table<span class="sc">$</span>DTXSID))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">36</span>) </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  example.seem[,this.col] <span class="ot">&lt;-</span> <span class="fu">signif</span>(example.seem[,this.col],<span class="dv">4</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(example.seem,<span class="at">file=</span><span class="st">&quot;introtoivive-seem.Rdata&quot;</span>,<span class="at">version=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Merge the consensus model predictions with your table:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>example.seem <span class="ot">&lt;-</span> httk<span class="sc">::</span>example.seem</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>toxcast.table <span class="ot">&lt;-</span> <span class="fu">merge</span>(toxcast.table,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                       example.seem[,<span class="fu">c</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;dsstox_substance_id&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;seem3&quot;</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;seem3.l95&quot;</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;seem3.u95&quot;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;Pathway&quot;</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;AD&quot;</span>)],</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by.x=</span><span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by.y=</span><span class="st">&quot;dsstox_substance_id&quot;</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Now we can calculate a bioactivity:exposure ratio (BER), which is a
risk-like metric since it takes hazard, dose-response, and exposure into
account (<a href="https://doi.org/10.1093/toxsci/kfv171">Wetmore,
2015</a>):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>toxcast.table<span class="sc">$</span>BER <span class="ot">&lt;-</span> <span class="fu">signif</span>(toxcast.table<span class="sc">$</span>EquivDose<span class="sc">/</span>toxcast.table<span class="sc">$</span>seem3.u95, <span class="dv">3</span>)</span></code></pre></div>
<p>Reorder your table by BER:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>toxcast.table <span class="ot">&lt;-</span> toxcast.table[<span class="fu">order</span>(toxcast.table<span class="sc">$</span>BER),]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(toxcast.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;EquivDose&quot;</span>,<span class="st">&quot;seem3.u95&quot;</span>,<span class="st">&quot;Pathway&quot;</span>,<span class="st">&quot;BER&quot;</span>)], </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">caption =</span> <span class="st">&quot;Bioactivity:Exposure Ratios&quot;</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">floating.environment=</span><span class="st">&quot;sidewaystable&quot;</span>)  </span></code></pre></div>
<div id="make-a-ber-plot" class="section level2">
<h2>Make a BER plot</h2>
<p>Convert the chemical names into factors for plotting:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>toxcast.table<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="fu">factor</span>(toxcast.table<span class="sc">$</span>Compound,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels=</span>toxcast.table<span class="sc">$</span>Compound)</span></code></pre></div>
<p>Then we can create a plot where the BER for each chemical is shown by
the margin between putative hazard (in red) and estimated exposure (in
blue). The wider the margin, the lesser the risk. Chemicals are arranged
from left-to-right by increasing margin (that is, decreasing risk).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>BER.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>toxcast.table) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend=</span>Compound,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span>(<span class="dv">10</span><span class="sc">^</span>Q10.AC50)<span class="sc">/</span>Css,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend=</span>(<span class="dv">10</span><span class="sc">^</span>Q90.AC50)<span class="sc">/</span>Css),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend=</span>Compound,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span>seem3.l95,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend=</span>seem3.u95),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;blue&quot;</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span>   </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>(<span class="dv">10</span><span class="sc">^</span>Med.AC50)<span class="sc">/</span>Css),<span class="at">shape=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>seem3),<span class="at">shape=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>, </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">45</span>)) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Bioactive Dose &amp; Exposure</span><span class="sc">\n</span><span class="st">mg/kg BW/day&quot;</span>) <span class="sc">+</span> </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chemicals Ranked By BER&quot;</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BER.plot)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
