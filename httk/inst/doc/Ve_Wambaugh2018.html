<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John Wambaugh" />

<meta name="date" content="2025-01-13" />

<title>Wambaugh et al. (2018): Evaluating In Vitro-In Vivo Extrapolation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Wambaugh et al. (2018): Evaluating In
Vitro-In Vivo Extrapolation</h1>
<h4 class="author">John Wambaugh</h4>
<h4 class="date">2025-01-13</h4>



<p><em>Please send questions to <a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></em></p>
<p>This vignette provides the code used to generate the figures in
Wambaugh et al. (2018) “Evaluating In Vitro-In Vivo Extrapolation of
Toxicokinetics”</p>
<p>John F Wambaugh, Michael F Hughes, Caroline L Ring, Denise K
MacMillan, Jermaine Ford, Timothy R Fennell, Sherry R Black, Rodney W
Snyder, Nisha S Sipes, Barbara A Wetmore, Joost Westerhout, R Woodrow
Setzer, Robert G Pearce, Jane Ellen Simmons, Russell S Thomas</p>
<p>Toxicological Sciences, Volume 163, Issue 1, May 2018, Pages
152-169,</p>
<p><a href="https://doi.org/10.1093/toxsci/kfy020" class="uri">https://doi.org/10.1093/toxsci/kfy020</a></p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>Prioritizing the risk posed by thousands of chemicals potentially
present in the environment requires exposure, toxicity, and
toxicokinetic (TK) data, which are often unavailable. Relatively
high-throughput, in vitro TK (HTTK) assays and <em>in vitro-to-in
vivo</em> extrapolation (IVIVE) methods have been developed to predict
TK, but most of the in vivo TK data available to benchmark these methods
are from pharmaceuticals. Here we report on new, <em>in vivo</em> rat TK
experiments for 26 non-pharmaceutical chemicals with environmental
relevance. Both intravenous and oral dosing were used to calculate
bioavailability. These chemicals, and an additional 19 chemicals
(including some pharmaceuticals) from previously published in vivo rat
studies, were systematically analyzed to estimate in vivo TK parameters
(e.g., volume of distribution [Vd], elimination rate). For each of the
chemicals, rat-specific HTTK data were available and key TK predictions
were examined: oral bioavailability, clearance, Vd, and uncertainty. For
the non-pharmaceutical chemicals, predictions for bioavailability were
not effective. While no pharmaceutical was absorbed at less than 10%,
the fraction bioavailable for non-pharmaceutical chemicals was as low as
0.3%. Total clearance was generally more under-estimated for
nonpharmaceuticals and Vd methods calibrated to pharmaceuticals may not
be appropriate for other chemicals. However, the steady-state, peak, and
time-integrated plasma concentrations of non-pharmaceuticals were
predicted with reasonable accuracy. The plasma concentration predictions
improved when experimental measurements of bioavailability were
incorporated. In summary, HTTK and IVIVE methods are adequately robust
to be applied to high-throughput <em>in vitro</em> toxicity screening
data of environmentally relevant chemicals for prioritizing based on
human health risks.</p>
</div>
<div id="httk-version" class="section level2">
<h2>HTTK Version</h2>
<p>This vignette was created with <strong>httk</strong> v1.8. Although
we attempt to maintain backward compatibility, if you encounter issues
with the latest release of <strong>httk</strong> and cannot easily
address the changes, historical versions of httk are available from: <a href="https://cran.r-project.org/src/contrib/Archive/httk/" class="uri">https://cran.r-project.org/src/contrib/Archive/httk/</a></p>
</div>
<div id="prepare-for-session" class="section level2">
<h2>Prepare for session</h2>
<p>R package <strong>knitr</strong> generates html and PDF documents
from this RMarkdown file, Each bit of code that follows is known as a
“chunk”. We start by telling <strong>knitr</strong> how we want our
chunks to look.</p>
<div id="clear-the-memory" class="section level3">
<h3>Clear the memory</h3>
<p>It is a bad idea to let variables and other information from previous
R sessions float around, so we first remove everything in the R
memory.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="eval-execute.vignette" class="section level3">
<h3>eval = execute.vignette</h3>
<p>If you are using the RMarkdown version of this vignette (extension,
.RMD) you will be able to see that several chunks of code in this
vignette have the statement “eval = execute.vignette”. The next chunk of
code, by default, sets execute.vignette = FALSE. This means that the
code is included (and necessary) but was not run when the vignette was
built. We do this because some steps require extensive computing time
and the checks on CRAN limit how long we can spend building the package.
If you want this vignette to work, you must run all code, either by
cutting and pasting it into R. Or, if viewing the .RMD file, you can
either change execute.vignette to TRUE or press “play” (the green arrow)
on each chunk in RStudio.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set whether or not the following chunks will be executed (run):</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>execute.vignette <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<div id="load-the-relevant-libraries" class="section level3">
<h3>Load the relevant libraries</h3>
<p>To use the code in this vignette, you’ll first need to load a few
packages. If you get the message “Error in library(X) : there is no
package called ‘X’” then you will need to install that package:</p>
<p>From the R command prompt:</p>
<p>install.packages(“X”)</p>
<p>Or, if using RStudio, look for ‘Install Packages’ under ‘Tools’
tab.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httk)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span></code></pre></div>
<p>The data we analyze were originally generated with the <a href="https://github.com/USEPA/CompTox-ExpoCast-invivoPKfit">R package
invivoPKfit</a>, but all the outputs of that analysis are provided with
<strong>httk</strong> &gt;v1.8.</p>
</div>
</div>
<div id="plot-functions" class="section level1">
<h1>Plot functions</h1>
<p>These functions, which have been cobbled together from the internet,
are reused in multiple figure to make things look nice.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple plot function</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - cols:   Number of columns in layout</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - layout: A matrix specifying the layout. If present, &#39;cols&#39; is ignored.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># then plot 1 will go in the upper left, 2 will go in the upper right, and</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 will go all the way across the bottom.</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>multiplot <span class="ot">&lt;-</span> <span class="cf">function</span>(..., <span class="at">plotlist=</span><span class="cn">NULL</span>, file, <span class="at">cols=</span><span class="dv">1</span>, <span class="at">layout=</span><span class="cn">NULL</span>, <span class="at">widths=</span><span class="fu">unit</span>(<span class="fu">rep_len</span>(<span class="dv">1</span>, cols), <span class="st">&quot;null&quot;</span>)) {</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a list from the ... arguments and plotlist</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(...), plotlist)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  numPlots <span class="ot">=</span> <span class="fu">length</span>(plots)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If layout is NULL, then use &#39;cols&#39; to determine layout</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(layout)) {</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make the panel</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ncol: Number of columns of plots</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nrow: Number of rows needed, calculated from # of cols</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    layout <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>, cols <span class="sc">*</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>cols)),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> cols, <span class="at">nrow =</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>cols))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (numPlots<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plots[[<span class="dv">1</span>]])</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the page</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grid.newpage</span>()</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(<span class="fu">nrow</span>(layout), <span class="fu">ncol</span>(layout),<span class="at">widths=</span>widths)))</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make each plot, in the correct location</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlots) {</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the i,j matrix positions of the regions that contain this subplot</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      matchidx <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(layout <span class="sc">==</span> i, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(plots[[i]], <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> matchidx<span class="sc">$</span>row,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">layout.pos.col =</span> matchidx<span class="sc">$</span>col))</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                                                                </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                                  </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="fu">scientific_format</span>()(x))              </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">parse</span>(<span class="at">text=</span><span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>lm_R2 <span class="ot">&lt;-</span> <span class="cf">function</span>(m,<span class="at">prefix=</span><span class="cn">NULL</span>){</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">substitute</span>(<span class="st">&quot;MSE = &quot;</span><span class="sc">~</span>mse<span class="sc">*</span><span class="st">&quot;,&quot;</span><span class="sc">~</span><span class="er">~</span><span class="fu">italic</span>(R)<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span><span class="st">&quot;=&quot;</span><span class="sc">~</span>r2, </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">mse =</span> <span class="fu">signif</span>(<span class="fu">mean</span>(m<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>),<span class="dv">3</span>),</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">r2 =</span> <span class="fu">format</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared, <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(prefix,<span class="fu">as.character</span>(<span class="fu">as.expression</span>(out)))                 </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>heatmap<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rowv =</span> <span class="cn">TRUE</span>, <span class="at">Colv =</span> <span class="cf">if</span> (symm) <span class="st">&quot;Rowv&quot;</span> <span class="cf">else</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>                      <span class="at">distfun =</span> dist,</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hclustfun =</span> hclust,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dendrogram =</span> <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>,<span class="st">&quot;row&quot;</span>, <span class="st">&quot;column&quot;</span>, <span class="st">&quot;none&quot;</span>),</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">symm =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>,<span class="st">&quot;row&quot;</span>, <span class="st">&quot;column&quot;</span>),</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                      <span class="at">revC =</span> <span class="fu">identical</span>(Colv,<span class="st">&quot;Rowv&quot;</span>),</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>                      add.expr,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>                      breaks,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>                      <span class="at">symbreaks =</span> <span class="fu">max</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">||</span> scale <span class="sc">!=</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col =</span> <span class="st">&quot;heat.colors&quot;</span>,</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>                      colsep,</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>                      rowsep,</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sepcolor =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sepwidth =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>),</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                      cellnote,</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notecex =</span> <span class="dv">1</span>,</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notecol =</span> <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na.color =</span> <span class="fu">par</span>(<span class="st">&quot;bg&quot;</span>),</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trace =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;column&quot;</span>,<span class="st">&quot;row&quot;</span>, <span class="st">&quot;both&quot;</span>),</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tracecol =</span> <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hline =</span> <span class="fu">median</span>(breaks),</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>                      <span class="at">vline =</span> <span class="fu">median</span>(breaks),</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>                      <span class="at">linecol =</span> tracecol,</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>                      <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>),</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>                      ColSideColors,</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>                      RowSideColors,</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>                      <span class="at">side.height.fraction=</span><span class="fl">0.3</span>,</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cexRow =</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">log10</span>(nr),</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cexCol =</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">log10</span>(nc),</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labRow =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labCol =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>                      <span class="at">key =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>                      <span class="at">keysize =</span> <span class="fl">1.5</span>,</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>                      <span class="at">density.info =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;histogram&quot;</span>, <span class="st">&quot;density&quot;</span>),</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>                      <span class="at">denscol =</span> tracecol,</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>                      <span class="at">symkey =</span> <span class="fu">max</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">||</span> symbreaks,</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>                      <span class="at">densadj =</span> <span class="fl">0.25</span>,</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>                      <span class="at">main =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xlab =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ylab =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>                      <span class="at">lmat =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>                      <span class="at">lhei =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>                      <span class="at">lwid =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ColSideColorsSize =</span> <span class="dv">1</span>,</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RowSideColorsSize =</span> <span class="dv">1</span>,</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>                      <span class="at">KeyValueName=</span><span class="st">&quot;Value&quot;</span>,...){</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>    invalid <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">missing</span>(x) <span class="sc">||</span> <span class="fu">is.null</span>(x) <span class="sc">||</span> <span class="fu">length</span>(x) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.list</span>(x))</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="fu">all</span>(<span class="fu">sapply</span>(x, invalid)))</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.vector</span>(x))</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>    scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">low =</span> <span class="fu">min</span>(x), <span class="at">high =</span> <span class="fu">max</span>(x)) {</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> (x <span class="sc">-</span> low)<span class="sc">/</span>(high <span class="sc">-</span> low)</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>        x</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>    retval <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>    scale <span class="ot">&lt;-</span> <span class="cf">if</span> (symm <span class="sc">&amp;&amp;</span> <span class="fu">missing</span>(scale))</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;none&quot;</span></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">match.arg</span>(scale)</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>    dendrogram <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(dendrogram)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>    trace <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(trace)</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>    density.info <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(density.info)</span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(col) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">is.character</span>(col))</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>        col <span class="ot">&lt;-</span> <span class="fu">get</span>(col, <span class="at">mode =</span> <span class="st">&quot;function&quot;</span>)</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(breaks) <span class="sc">&amp;&amp;</span> (scale <span class="sc">!=</span> <span class="st">&quot;none&quot;</span>))</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;Using scale=</span><span class="sc">\&quot;</span><span class="st">row</span><span class="sc">\&quot;</span><span class="st"> or scale=</span><span class="sc">\&quot;</span><span class="st">column</span><span class="sc">\&quot;</span><span class="st"> when breaks are&quot;</span>,</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;specified can produce unpredictable results.&quot;</span>, <span class="st">&quot;Please consider using only one or the other.&quot;</span>)</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(Rowv) <span class="sc">||</span> <span class="fu">is.na</span>(Rowv))</span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>        Rowv <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(Colv) <span class="sc">||</span> <span class="fu">is.na</span>(Colv))</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>        Colv <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (Colv <span class="sc">==</span> <span class="st">&quot;Rowv&quot;</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">isTRUE</span>(Rowv))</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>        Colv <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(di <span class="ot">&lt;-</span> <span class="fu">dim</span>(x)) <span class="sc">!=</span> <span class="dv">2</span> <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(x))</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;`x&#39; must be a numeric matrix&quot;</span>)</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>    nr <span class="ot">&lt;-</span> di[<span class="dv">1</span>]</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>    nc <span class="ot">&lt;-</span> di[<span class="dv">2</span>]</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (nr <span class="sc">&lt;=</span> <span class="dv">1</span> <span class="sc">||</span> nc <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;`x&#39; must have at least 2 rows and 2 columns&quot;</span>)</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(margins) <span class="sc">||</span> <span class="fu">length</span>(margins) <span class="sc">!=</span> <span class="dv">2</span>)</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;`margins&#39; must be a numeric vector of length 2&quot;</span>)</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(cellnote))</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>        cellnote <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">&quot;&quot;</span>, <span class="at">ncol =</span> <span class="fu">ncol</span>(x), <span class="at">nrow =</span> <span class="fu">nrow</span>(x))</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(Rowv, <span class="st">&quot;dendrogram&quot;</span>)) {</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (((<span class="sc">!</span><span class="fu">isTRUE</span>(Rowv)) <span class="sc">||</span> (<span class="fu">is.null</span>(Rowv))) <span class="sc">&amp;&amp;</span> (dendrogram <span class="sc">%in%</span></span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;row&quot;</span>))) {</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">is.logical</span>(Colv) <span class="sc">&amp;&amp;</span> (Colv))</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>                dendrogram <span class="ot">&lt;-</span> <span class="st">&quot;column&quot;</span></span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> dedrogram <span class="ot">&lt;-</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(<span class="st">&quot;Discrepancy: Rowv is FALSE, while dendrogram is `&quot;</span>,</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>                dendrogram, <span class="st">&quot;&#39;. Omitting row dendogram.&quot;</span>)</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(Colv, <span class="st">&quot;dendrogram&quot;</span>)) {</span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (((<span class="sc">!</span><span class="fu">isTRUE</span>(Colv)) <span class="sc">||</span> (<span class="fu">is.null</span>(Colv))) <span class="sc">&amp;&amp;</span> (dendrogram <span class="sc">%in%</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;column&quot;</span>))) {</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">is.logical</span>(Rowv) <span class="sc">&amp;&amp;</span> (Rowv))</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>                dendrogram <span class="ot">&lt;-</span> <span class="st">&quot;row&quot;</span></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> dendrogram <span class="ot">&lt;-</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>            <span class="fu">warning</span>(<span class="st">&quot;Discrepancy: Colv is FALSE, while dendrogram is `&quot;</span>,</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>                dendrogram, <span class="st">&quot;&#39;. Omitting column dendogram.&quot;</span>)</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">inherits</span>(Rowv, <span class="st">&quot;dendrogram&quot;</span>)) {</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>        ddr <span class="ot">&lt;-</span> Rowv</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>        rowInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddr)</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.integer</span>(Rowv)) {</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>        hcr <span class="ot">&lt;-</span> <span class="fu">hclustfun</span>(<span class="fu">distfun</span>(x))</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>        ddr <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hcr)</span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>        ddr <span class="ot">&lt;-</span> <span class="fu">reorder</span>(ddr, Rowv)</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>        rowInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddr)</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (nr <span class="sc">!=</span> <span class="fu">length</span>(rowInd))</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;row dendrogram ordering gave index of wrong length&quot;</span>)</span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">isTRUE</span>(Rowv)) {</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>        Rowv <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>        hcr <span class="ot">&lt;-</span> <span class="fu">hclustfun</span>(<span class="fu">distfun</span>(x))</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>        ddr <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hcr)</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>        ddr <span class="ot">&lt;-</span> <span class="fu">reorder</span>(ddr, Rowv)</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>        rowInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddr)</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (nr <span class="sc">!=</span> <span class="fu">length</span>(rowInd))</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;row dendrogram ordering gave index of wrong length&quot;</span>)</span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>        rowInd <span class="ot">&lt;-</span> nr<span class="sc">:</span><span class="dv">1</span></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">inherits</span>(Colv, <span class="st">&quot;dendrogram&quot;</span>)) {</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>        ddc <span class="ot">&lt;-</span> Colv</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>        colInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddc)</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">identical</span>(Colv, <span class="st">&quot;Rowv&quot;</span>)) {</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (nr <span class="sc">!=</span> nc)</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;Colv = </span><span class="sc">\&quot;</span><span class="st">Rowv</span><span class="sc">\&quot;</span><span class="st"> but nrow(x) != ncol(x)&quot;</span>)</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;ddr&quot;</span>)) {</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>            ddc <span class="ot">&lt;-</span> ddr</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>            colInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddc)</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> colInd <span class="ot">&lt;-</span> rowInd</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.integer</span>(Colv)) {</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>        hcc <span class="ot">&lt;-</span> <span class="fu">hclustfun</span>(<span class="fu">distfun</span>(<span class="cf">if</span> (symm)</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>            x</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">t</span>(x)))</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>        ddc <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hcc)</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>        ddc <span class="ot">&lt;-</span> <span class="fu">reorder</span>(ddc, Colv)</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>        colInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddc)</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (nc <span class="sc">!=</span> <span class="fu">length</span>(colInd))</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;column dendrogram ordering gave index of wrong length&quot;</span>)</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">isTRUE</span>(Colv)) {</span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>        Colv <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>        hcc <span class="ot">&lt;-</span> <span class="fu">hclustfun</span>(<span class="fu">distfun</span>(<span class="cf">if</span> (symm)</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>            x</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">t</span>(x)))</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>        ddc <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hcc)</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>        ddc <span class="ot">&lt;-</span> <span class="fu">reorder</span>(ddc, Colv)</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>        colInd <span class="ot">&lt;-</span> <span class="fu">order.dendrogram</span>(ddc)</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (nc <span class="sc">!=</span> <span class="fu">length</span>(colInd))</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;column dendrogram ordering gave index of wrong length&quot;</span>)</span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>        colInd <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nc</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>rowInd <span class="ot">&lt;-</span> rowInd</span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>colInd <span class="ot">&lt;-</span> colInd</span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>call <span class="ot">&lt;-</span> <span class="fu">match.call</span>()</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[rowInd, colInd]</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>    x.unscaled <span class="ot">&lt;-</span> x</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>    cellnote <span class="ot">&lt;-</span> cellnote[rowInd, colInd]</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(labRow))</span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>        labRow <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(<span class="fu">rownames</span>(x)))</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span><span class="sc">:</span>nr)[rowInd]</span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">rownames</span>(x)</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> labRow <span class="ot">&lt;-</span> labRow[rowInd]</span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(labCol))</span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>        labCol <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(<span class="fu">colnames</span>(x)))</span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span><span class="sc">:</span>nc)[colInd]</span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">colnames</span>(x)</span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> labCol <span class="ot">&lt;-</span> labCol[colInd]</span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (scale <span class="sc">==</span> <span class="st">&quot;row&quot;</span>) {</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>rowMeans <span class="ot">&lt;-</span> rm <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">sweep</span>(x, <span class="dv">1</span>, rm)</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>rowSDs <span class="ot">&lt;-</span> sx <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">1</span>, sd, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">sweep</span>(x, <span class="dv">1</span>, sx, <span class="st">&quot;/&quot;</span>)</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (scale <span class="sc">==</span> <span class="st">&quot;column&quot;</span>) {</span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>colMeans <span class="ot">&lt;-</span> rm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">sweep</span>(x, <span class="dv">2</span>, rm)</span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>colSDs <span class="ot">&lt;-</span> sx <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, sd, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">sweep</span>(x, <span class="dv">2</span>, sx, <span class="st">&quot;/&quot;</span>)</span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(breaks) <span class="sc">||</span> <span class="fu">is.null</span>(breaks) <span class="sc">||</span> <span class="fu">length</span>(breaks) <span class="sc">&lt;</span> <span class="dv">1</span>) {</span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">missing</span>(col) <span class="sc">||</span> <span class="fu">is.function</span>(col))</span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>            breaks <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> breaks <span class="ot">&lt;-</span> <span class="fu">length</span>(col) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(breaks) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span>symbreaks)</span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>            breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x, <span class="at">na.rm =</span> na.rm), <span class="fu">max</span>(x, <span class="at">na.rm =</span> na.rm),</span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>                <span class="at">length =</span> breaks)</span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a>            extreme <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(x), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>            breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span>extreme, extreme, <span class="at">length =</span> breaks)</span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a>    nbr <span class="ot">&lt;-</span> <span class="fu">length</span>(breaks)</span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a>    ncol <span class="ot">&lt;-</span> <span class="fu">length</span>(breaks) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">class</span>(col) <span class="sc">==</span> <span class="st">&quot;function&quot;</span>)</span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a>        col <span class="ot">&lt;-</span> <span class="fu">col</span>(ncol)</span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>    min.breaks <span class="ot">&lt;-</span> <span class="fu">min</span>(breaks)</span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>    max.breaks <span class="ot">&lt;-</span> <span class="fu">max</span>(breaks)</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>    x[x <span class="sc">&lt;</span> min.breaks] <span class="ot">&lt;-</span> min.breaks</span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>    x[x <span class="sc">&gt;</span> max.breaks] <span class="ot">&lt;-</span> max.breaks</span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(lhei) <span class="sc">||</span> <span class="fu">is.null</span>(lhei))</span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>        lhei <span class="ot">&lt;-</span> <span class="fu">c</span>(keysize, <span class="dv">4</span>)</span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(lwid) <span class="sc">||</span> <span class="fu">is.null</span>(lwid))</span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a>        lwid <span class="ot">&lt;-</span> <span class="fu">c</span>(keysize, <span class="dv">4</span>)</span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(lmat) <span class="sc">||</span> <span class="fu">is.null</span>(lmat)) {</span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a>        lmat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(ColSideColors)) {</span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a>           <span class="co">#if (!is.matrix(ColSideColors))</span></span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>           <span class="co">#stop(&quot;&#39;ColSideColors&#39; must be a matrix&quot;)</span></span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.character</span>(ColSideColors) <span class="sc">||</span> <span class="fu">nrow</span>(ColSideColors) <span class="sc">!=</span> nc)</span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stop</span>(<span class="st">&quot;&#39;ColSideColors&#39; must be a matrix of nrow(x) rows&quot;</span>)</span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a>            lmat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(lmat[<span class="dv">1</span>, ] <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>), lmat[<span class="dv">2</span>, ] <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>            <span class="co">#lhei &lt;- c(lhei[1], 0.2, lhei[2])</span></span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>             lhei<span class="ot">=</span><span class="fu">c</span>(lhei[<span class="dv">1</span>], side.height.fraction<span class="sc">*</span>ColSideColorsSize<span class="sc">/</span><span class="dv">2</span>, lhei[<span class="dv">2</span>])</span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(RowSideColors)) {</span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a>            <span class="co">#if (!is.matrix(RowSideColors))</span></span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a>            <span class="co">#stop(&quot;&#39;RowSideColors&#39; must be a matrix&quot;)</span></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.character</span>(RowSideColors) <span class="sc">||</span> <span class="fu">ncol</span>(RowSideColors) <span class="sc">!=</span> nr)</span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>                <span class="fu">stop</span>(<span class="st">&quot;&#39;RowSideColors&#39; must be a matrix of ncol(x) columns&quot;</span>)</span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>            lmat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lmat[, <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(lmat) <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">1</span>), lmat[,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a>            <span class="co">#lwid &lt;- c(lwid[1], 0.2, lwid[2])</span></span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>            lwid <span class="ot">&lt;-</span> <span class="fu">c</span>(lwid[<span class="dv">1</span>], side.height.fraction<span class="sc">*</span>RowSideColorsSize<span class="sc">/</span><span class="dv">2</span>, lwid[<span class="dv">2</span>])</span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>        lmat[<span class="fu">is.na</span>(lmat)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(lhei) <span class="sc">!=</span> <span class="fu">nrow</span>(lmat))</span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;lhei must have length = nrow(lmat) = &quot;</span>, <span class="fu">nrow</span>(lmat))</span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(lwid) <span class="sc">!=</span> <span class="fu">ncol</span>(lmat))</span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;lwid must have length = ncol(lmat) =&quot;</span>, <span class="fu">ncol</span>(lmat))</span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true" tabindex="-1"></a>    op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on.exit</span>(<span class="fu">par</span>(op))</span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layout</span>(lmat, <span class="at">widths =</span> lwid, <span class="at">heights =</span> lhei, <span class="at">respect =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(RowSideColors)) {</span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.matrix</span>(RowSideColors)){</span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true" tabindex="-1"></a>                <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(margins[<span class="dv">1</span>], <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true" tabindex="-1"></a>                <span class="fu">image</span>(<span class="fu">rbind</span>(<span class="dv">1</span><span class="sc">:</span>nr), <span class="at">col =</span> RowSideColors[rowInd], <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-328"><a href="#cb4-328" aria-hidden="true" tabindex="-1"></a>            <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(margins[<span class="dv">1</span>], <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb4-329"><a href="#cb4-329" aria-hidden="true" tabindex="-1"></a>            rsc <span class="ot">=</span> <span class="fu">t</span>(RowSideColors[,rowInd, <span class="at">drop=</span><span class="cn">FALSE</span>])</span>
<span id="cb4-330"><a href="#cb4-330" aria-hidden="true" tabindex="-1"></a>            rsc.colors <span class="ot">=</span> <span class="fu">matrix</span>()</span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true" tabindex="-1"></a>            rsc.names <span class="ot">=</span> <span class="fu">names</span>(<span class="fu">table</span>(rsc))</span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true" tabindex="-1"></a>            rsc.i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (rsc.name <span class="cf">in</span> rsc.names) {</span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true" tabindex="-1"></a>                rsc.colors[rsc.i] <span class="ot">=</span> rsc.name</span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true" tabindex="-1"></a>                rsc[rsc <span class="sc">==</span> rsc.name] <span class="ot">=</span> rsc.i</span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true" tabindex="-1"></a>                rsc.i <span class="ot">=</span> rsc.i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>            rsc <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(rsc), <span class="at">nrow =</span> <span class="fu">dim</span>(rsc)[<span class="dv">1</span>])</span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>            <span class="fu">image</span>(<span class="fu">t</span>(rsc), <span class="at">col =</span> <span class="fu">as.vector</span>(rsc.colors), <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">rownames</span>(RowSideColors)) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>                <span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span>(<span class="fu">dim</span>(rsc)[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">max</span>(<span class="dv">1</span>,(<span class="fu">dim</span>(rsc)[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>)), <span class="fu">rownames</span>(RowSideColors), <span class="at">las =</span> <span class="dv">2</span>, <span class="at">tick =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(ColSideColors)) {</span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.matrix</span>(ColSideColors)){</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a>            <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, margins[<span class="dv">2</span>]))</span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a>            <span class="fu">image</span>(<span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span>nc), <span class="at">col =</span> ColSideColors[colInd], <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>            <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, margins[<span class="dv">2</span>]))</span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>            csc <span class="ot">=</span> ColSideColors[colInd, , drop<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a>            csc.colors <span class="ot">=</span> <span class="fu">matrix</span>()</span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>            csc.names <span class="ot">=</span> <span class="fu">names</span>(<span class="fu">table</span>(csc))</span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a>            csc.i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (csc.name <span class="cf">in</span> csc.names) {</span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a>                csc.colors[csc.i] <span class="ot">=</span> csc.name</span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a>                csc[csc <span class="sc">==</span> csc.name] <span class="ot">=</span> csc.i</span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a>                csc.i <span class="ot">=</span> csc.i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a>            csc <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(csc), <span class="at">nrow =</span> <span class="fu">dim</span>(csc)[<span class="dv">1</span>])</span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>            <span class="fu">image</span>(csc, <span class="at">col =</span> <span class="fu">as.vector</span>(csc.colors), <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">colnames</span>(ColSideColors)) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a>                <span class="fu">axis</span>(<span class="dv">2</span>, <span class="dv">0</span><span class="sc">:</span>(<span class="fu">dim</span>(csc)[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">max</span>(<span class="dv">1</span>,(<span class="fu">dim</span>(csc)[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>)), <span class="fu">colnames</span>(ColSideColors), <span class="at">las =</span> <span class="dv">2</span>, <span class="at">tick =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(margins[<span class="dv">1</span>], <span class="dv">0</span>, <span class="dv">0</span>, margins[<span class="dv">2</span>]))</span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">t</span>(x)</span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true" tabindex="-1"></a>    cellnote <span class="ot">&lt;-</span> <span class="fu">t</span>(cellnote)</span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (revC) {</span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true" tabindex="-1"></a>        iy <span class="ot">&lt;-</span> nr<span class="sc">:</span><span class="dv">1</span></span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;ddr&quot;</span>))</span>
<span id="cb4-376"><a href="#cb4-376" aria-hidden="true" tabindex="-1"></a>            ddr <span class="ot">&lt;-</span> <span class="fu">rev</span>(ddr)</span>
<span id="cb4-377"><a href="#cb4-377" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> x[, iy]</span>
<span id="cb4-378"><a href="#cb4-378" aria-hidden="true" tabindex="-1"></a>        cellnote <span class="ot">&lt;-</span> cellnote[, iy]</span>
<span id="cb4-379"><a href="#cb4-379" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-380"><a href="#cb4-380" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> iy <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nr</span>
<span id="cb4-381"><a href="#cb4-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">image</span>(<span class="dv">1</span><span class="sc">:</span>nc, <span class="dv">1</span><span class="sc">:</span>nr, x, <span class="at">xlim =</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, nc), <span class="at">ylim =</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, nr), <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> col, <span class="at">breaks =</span> breaks, ...)</span>
<span id="cb4-382"><a href="#cb4-382" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>carpet <span class="ot">&lt;-</span> x</span>
<span id="cb4-383"><a href="#cb4-383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;ddr&quot;</span>))</span>
<span id="cb4-384"><a href="#cb4-384" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>rowDendrogram <span class="ot">&lt;-</span> ddr</span>
<span id="cb4-385"><a href="#cb4-385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;ddc&quot;</span>))</span>
<span id="cb4-386"><a href="#cb4-386" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>colDendrogram <span class="ot">&lt;-</span> ddc</span>
<span id="cb4-387"><a href="#cb4-387" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>breaks <span class="ot">&lt;-</span> breaks</span>
<span id="cb4-388"><a href="#cb4-388" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>col <span class="ot">&lt;-</span> col</span>
<span id="cb4-389"><a href="#cb4-389" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">invalid</span>(na.color) <span class="sc">&amp;</span> <span class="fu">any</span>(<span class="fu">is.na</span>(x))) { <span class="co"># load library(gplots)</span></span>
<span id="cb4-390"><a href="#cb4-390" aria-hidden="true" tabindex="-1"></a>        mmat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb4-391"><a href="#cb4-391" aria-hidden="true" tabindex="-1"></a>        <span class="fu">image</span>(<span class="dv">1</span><span class="sc">:</span>nc, <span class="dv">1</span><span class="sc">:</span>nr, mmat, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb4-392"><a href="#cb4-392" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> na.color, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-393"><a href="#cb4-393" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-394"><a href="#cb4-394" aria-hidden="true" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span>nc, <span class="at">labels =</span> labCol, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">tick =</span> <span class="dv">0</span>,</span>
<span id="cb4-395"><a href="#cb4-395" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis =</span> cexCol)</span>
<span id="cb4-396"><a href="#cb4-396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(xlab))</span>
<span id="cb4-397"><a href="#cb4-397" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mtext</span>(xlab, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> margins[<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.25</span>)</span>
<span id="cb4-398"><a href="#cb4-398" aria-hidden="true" tabindex="-1"></a>    <span class="fu">axis</span>(<span class="dv">4</span>, iy, <span class="at">labels =</span> labRow, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">tick =</span> <span class="dv">0</span>,</span>
<span id="cb4-399"><a href="#cb4-399" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis =</span> cexRow)</span>
<span id="cb4-400"><a href="#cb4-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ylab))</span>
<span id="cb4-401"><a href="#cb4-401" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mtext</span>(ylab, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> margins[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.25</span>)</span>
<span id="cb4-402"><a href="#cb4-402" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(add.expr))</span>
<span id="cb4-403"><a href="#cb4-403" aria-hidden="true" tabindex="-1"></a>        <span class="fu">eval</span>(<span class="fu">substitute</span>(add.expr))</span>
<span id="cb4-404"><a href="#cb4-404" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(colsep))</span>
<span id="cb4-405"><a href="#cb4-405" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (csep <span class="cf">in</span> colsep) <span class="fu">rect</span>(<span class="at">xleft =</span> csep <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">ybottom =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(csep)), <span class="at">xright =</span> csep <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">+</span> sepwidth[<span class="dv">1</span>], <span class="at">ytop =</span> <span class="fu">rep</span>(<span class="fu">ncol</span>(x) <span class="sc">+</span> <span class="dv">1</span>, csep), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> sepcolor, <span class="at">border =</span> sepcolor)</span>
<span id="cb4-406"><a href="#cb4-406" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(rowsep))</span>
<span id="cb4-407"><a href="#cb4-407" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (rsep <span class="cf">in</span> rowsep) <span class="fu">rect</span>(<span class="at">xleft =</span> <span class="dv">0</span>, <span class="at">ybottom =</span> (<span class="fu">ncol</span>(x) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> rsep) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">xright =</span> <span class="fu">nrow</span>(x) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ytop =</span> (<span class="fu">ncol</span>(x) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> rsep) <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">-</span> sepwidth[<span class="dv">2</span>], <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> sepcolor, <span class="at">border =</span> sepcolor)</span>
<span id="cb4-408"><a href="#cb4-408" aria-hidden="true" tabindex="-1"></a>    min.scale <span class="ot">&lt;-</span> <span class="fu">min</span>(breaks)</span>
<span id="cb4-409"><a href="#cb4-409" aria-hidden="true" tabindex="-1"></a>    max.scale <span class="ot">&lt;-</span> <span class="fu">max</span>(breaks)</span>
<span id="cb4-410"><a href="#cb4-410" aria-hidden="true" tabindex="-1"></a>    x.scaled <span class="ot">&lt;-</span> <span class="fu">scale01</span>(<span class="fu">t</span>(x), min.scale, max.scale)</span>
<span id="cb4-411"><a href="#cb4-411" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (trace <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;column&quot;</span>)) {</span>
<span id="cb4-412"><a href="#cb4-412" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>vline <span class="ot">&lt;-</span> vline</span>
<span id="cb4-413"><a href="#cb4-413" aria-hidden="true" tabindex="-1"></a>        vline.vals <span class="ot">&lt;-</span> <span class="fu">scale01</span>(vline, min.scale, max.scale)</span>
<span id="cb4-414"><a href="#cb4-414" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> colInd) {</span>
<span id="cb4-415"><a href="#cb4-415" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(vline)) {</span>
<span id="cb4-416"><a href="#cb4-416" aria-hidden="true" tabindex="-1"></a>                <span class="fu">abline</span>(<span class="at">v =</span> i <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">+</span> vline.vals, <span class="at">col =</span> linecol,</span>
<span id="cb4-417"><a href="#cb4-417" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-418"><a href="#cb4-418" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-419"><a href="#cb4-419" aria-hidden="true" tabindex="-1"></a>            xv <span class="ot">&lt;-</span> <span class="fu">rep</span>(i, <span class="fu">nrow</span>(x.scaled)) <span class="sc">+</span> x.scaled[, i] <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb4-420"><a href="#cb4-420" aria-hidden="true" tabindex="-1"></a>            xv <span class="ot">&lt;-</span> <span class="fu">c</span>(xv[<span class="dv">1</span>], xv)</span>
<span id="cb4-421"><a href="#cb4-421" aria-hidden="true" tabindex="-1"></a>            yv <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xv) <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb4-422"><a href="#cb4-422" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lines</span>(<span class="at">x =</span> xv, <span class="at">y =</span> yv, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> tracecol, <span class="at">type =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb4-423"><a href="#cb4-423" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-424"><a href="#cb4-424" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-425"><a href="#cb4-425" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (trace <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;row&quot;</span>)) {</span>
<span id="cb4-426"><a href="#cb4-426" aria-hidden="true" tabindex="-1"></a>        retval<span class="sc">$</span>hline <span class="ot">&lt;-</span> hline</span>
<span id="cb4-427"><a href="#cb4-427" aria-hidden="true" tabindex="-1"></a>        hline.vals <span class="ot">&lt;-</span> <span class="fu">scale01</span>(hline, min.scale, max.scale)</span>
<span id="cb4-428"><a href="#cb4-428" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> rowInd) {</span>
<span id="cb4-429"><a href="#cb4-429" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(hline)) {</span>
<span id="cb4-430"><a href="#cb4-430" aria-hidden="true" tabindex="-1"></a>                <span class="fu">abline</span>(<span class="at">h =</span> i <span class="sc">+</span> hline, <span class="at">col =</span> linecol, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-431"><a href="#cb4-431" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb4-432"><a href="#cb4-432" aria-hidden="true" tabindex="-1"></a>            yv <span class="ot">&lt;-</span> <span class="fu">rep</span>(i, <span class="fu">ncol</span>(x.scaled)) <span class="sc">+</span> x.scaled[i, ] <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb4-433"><a href="#cb4-433" aria-hidden="true" tabindex="-1"></a>            yv <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">c</span>(yv[<span class="dv">1</span>], yv))</span>
<span id="cb4-434"><a href="#cb4-434" aria-hidden="true" tabindex="-1"></a>            xv <span class="ot">&lt;-</span> <span class="fu">length</span>(yv)<span class="sc">:</span><span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb4-435"><a href="#cb4-435" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lines</span>(<span class="at">x =</span> xv, <span class="at">y =</span> yv, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> tracecol, <span class="at">type =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb4-436"><a href="#cb4-436" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-437"><a href="#cb4-437" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-438"><a href="#cb4-438" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(cellnote))</span>
<span id="cb4-439"><a href="#cb4-439" aria-hidden="true" tabindex="-1"></a>        <span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">row</span>(cellnote)), <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">col</span>(cellnote)), <span class="at">labels =</span> <span class="fu">c</span>(cellnote),</span>
<span id="cb4-440"><a href="#cb4-440" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> notecol, <span class="at">cex =</span> notecex)</span>
<span id="cb4-441"><a href="#cb4-441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(margins[<span class="dv">1</span>], <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb4-442"><a href="#cb4-442" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dendrogram <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;row&quot;</span>)) {</span>
<span id="cb4-443"><a href="#cb4-443" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(ddr, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">leaflab =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb4-444"><a href="#cb4-444" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-445"><a href="#cb4-445" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">plot.new</span>()</span>
<span id="cb4-446"><a href="#cb4-446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(main)) <span class="dv">5</span> <span class="cf">else</span> <span class="dv">0</span>, margins[<span class="dv">2</span>]))</span>
<span id="cb4-447"><a href="#cb4-447" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dendrogram <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;both&quot;</span>, <span class="st">&quot;column&quot;</span>)) {</span>
<span id="cb4-448"><a href="#cb4-448" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(ddc, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">leaflab =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb4-449"><a href="#cb4-449" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-450"><a href="#cb4-450" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">plot.new</span>()</span>
<span id="cb4-451"><a href="#cb4-451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(main))</span>
<span id="cb4-452"><a href="#cb4-452" aria-hidden="true" tabindex="-1"></a>        <span class="fu">title</span>(main, <span class="at">cex.main =</span> <span class="fl">1.5</span> <span class="sc">*</span> op[[<span class="st">&quot;cex.main&quot;</span>]])</span>
<span id="cb4-453"><a href="#cb4-453" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (key) {</span>
<span id="cb4-454"><a href="#cb4-454" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">0.75</span>)</span>
<span id="cb4-455"><a href="#cb4-455" aria-hidden="true" tabindex="-1"></a>        tmpbreaks <span class="ot">&lt;-</span> breaks</span>
<span id="cb4-456"><a href="#cb4-456" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (symkey) {</span>
<span id="cb4-457"><a href="#cb4-457" aria-hidden="true" tabindex="-1"></a>            max.raw <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">c</span>(x, breaks)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-458"><a href="#cb4-458" aria-hidden="true" tabindex="-1"></a>            min.raw <span class="ot">&lt;-</span> <span class="sc">-</span>max.raw</span>
<span id="cb4-459"><a href="#cb4-459" aria-hidden="true" tabindex="-1"></a>            tmpbreaks[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">max</span>(<span class="fu">abs</span>(x), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-460"><a href="#cb4-460" aria-hidden="true" tabindex="-1"></a>            tmpbreaks[<span class="fu">length</span>(tmpbreaks)] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(x), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-461"><a href="#cb4-461" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-462"><a href="#cb4-462" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb4-463"><a href="#cb4-463" aria-hidden="true" tabindex="-1"></a>            min.raw <span class="ot">&lt;-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-464"><a href="#cb4-464" aria-hidden="true" tabindex="-1"></a>            max.raw <span class="ot">&lt;-</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-465"><a href="#cb4-465" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-466"><a href="#cb4-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-467"><a href="#cb4-467" aria-hidden="true" tabindex="-1"></a>        z <span class="ot">&lt;-</span> <span class="fu">seq</span>(min.raw, max.raw, <span class="at">length =</span> <span class="fu">length</span>(col))</span>
<span id="cb4-468"><a href="#cb4-468" aria-hidden="true" tabindex="-1"></a>        <span class="fu">image</span>(<span class="at">z =</span> <span class="fu">matrix</span>(z, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">col =</span> col, <span class="at">breaks =</span> tmpbreaks,</span>
<span id="cb4-469"><a href="#cb4-469" aria-hidden="true" tabindex="-1"></a>            <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb4-470"><a href="#cb4-470" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb4-471"><a href="#cb4-471" aria-hidden="true" tabindex="-1"></a>        lv <span class="ot">&lt;-</span> <span class="fu">pretty</span>(breaks)</span>
<span id="cb4-472"><a href="#cb4-472" aria-hidden="true" tabindex="-1"></a>        xv <span class="ot">&lt;-</span> <span class="fu">scale01</span>(<span class="fu">as.numeric</span>(lv), min.raw, max.raw)</span>
<span id="cb4-473"><a href="#cb4-473" aria-hidden="true" tabindex="-1"></a>        <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> xv, <span class="at">labels =</span> lv)</span>
<span id="cb4-474"><a href="#cb4-474" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (scale <span class="sc">==</span> <span class="st">&quot;row&quot;</span>)</span>
<span id="cb4-475"><a href="#cb4-475" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="st">&quot;Row Z-Score&quot;</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb4-476"><a href="#cb4-476" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (scale <span class="sc">==</span> <span class="st">&quot;column&quot;</span>)</span>
<span id="cb4-477"><a href="#cb4-477" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="st">&quot;Column Z-Score&quot;</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb4-478"><a href="#cb4-478" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, KeyValueName, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb4-479"><a href="#cb4-479" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (density.info <span class="sc">==</span> <span class="st">&quot;density&quot;</span>) {</span>
<span id="cb4-480"><a href="#cb4-480" aria-hidden="true" tabindex="-1"></a>            dens <span class="ot">&lt;-</span> <span class="fu">density</span>(x, <span class="at">adjust =</span> densadj, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-481"><a href="#cb4-481" aria-hidden="true" tabindex="-1"></a>            omit <span class="ot">&lt;-</span> dens<span class="sc">$</span>x <span class="sc">&lt;</span> <span class="fu">min</span>(breaks) <span class="sc">|</span> dens<span class="sc">$</span>x <span class="sc">&gt;</span> <span class="fu">max</span>(breaks)</span>
<span id="cb4-482"><a href="#cb4-482" aria-hidden="true" tabindex="-1"></a>            dens<span class="sc">$</span>x <span class="ot">&lt;-</span> dens<span class="sc">$</span>x[<span class="sc">-</span>omit]</span>
<span id="cb4-483"><a href="#cb4-483" aria-hidden="true" tabindex="-1"></a>            dens<span class="sc">$</span>y <span class="ot">&lt;-</span> dens<span class="sc">$</span>y[<span class="sc">-</span>omit]</span>
<span id="cb4-484"><a href="#cb4-484" aria-hidden="true" tabindex="-1"></a>            dens<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">scale01</span>(dens<span class="sc">$</span>x, min.raw, max.raw)</span>
<span id="cb4-485"><a href="#cb4-485" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lines</span>(dens<span class="sc">$</span>x, dens<span class="sc">$</span>y<span class="sc">/</span><span class="fu">max</span>(dens<span class="sc">$</span>y) <span class="sc">*</span> <span class="fl">0.95</span>, <span class="at">col =</span> denscol,</span>
<span id="cb4-486"><a href="#cb4-486" aria-hidden="true" tabindex="-1"></a>                <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb4-487"><a href="#cb4-487" aria-hidden="true" tabindex="-1"></a>            <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">pretty</span>(dens<span class="sc">$</span>y)<span class="sc">/</span><span class="fu">max</span>(dens<span class="sc">$</span>y) <span class="sc">*</span> <span class="fl">0.95</span>, <span class="fu">pretty</span>(dens<span class="sc">$</span>y))</span>
<span id="cb4-488"><a href="#cb4-488" aria-hidden="true" tabindex="-1"></a>            <span class="fu">title</span>(<span class="st">&quot;Color Key</span><span class="sc">\n</span><span class="st">and Density Plot&quot;</span>)</span>
<span id="cb4-489"><a href="#cb4-489" aria-hidden="true" tabindex="-1"></a>            <span class="fu">par</span>(<span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb4-490"><a href="#cb4-490" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb4-491"><a href="#cb4-491" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-492"><a href="#cb4-492" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (density.info <span class="sc">==</span> <span class="st">&quot;histogram&quot;</span>) {</span>
<span id="cb4-493"><a href="#cb4-493" aria-hidden="true" tabindex="-1"></a>            h <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> breaks)</span>
<span id="cb4-494"><a href="#cb4-494" aria-hidden="true" tabindex="-1"></a>            hx <span class="ot">&lt;-</span> <span class="fu">scale01</span>(breaks, min.raw, max.raw)</span>
<span id="cb4-495"><a href="#cb4-495" aria-hidden="true" tabindex="-1"></a>            hy <span class="ot">&lt;-</span> <span class="fu">c</span>(h<span class="sc">$</span>counts, h<span class="sc">$</span>counts[<span class="fu">length</span>(h<span class="sc">$</span>counts)])</span>
<span id="cb4-496"><a href="#cb4-496" aria-hidden="true" tabindex="-1"></a>            <span class="fu">lines</span>(hx, hy<span class="sc">/</span><span class="fu">max</span>(hy) <span class="sc">*</span> <span class="fl">0.95</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;s&quot;</span>,</span>
<span id="cb4-497"><a href="#cb4-497" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> denscol)</span>
<span id="cb4-498"><a href="#cb4-498" aria-hidden="true" tabindex="-1"></a>            <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">pretty</span>(hy)<span class="sc">/</span><span class="fu">max</span>(hy) <span class="sc">*</span> <span class="fl">0.95</span>, <span class="fu">pretty</span>(hy))</span>
<span id="cb4-499"><a href="#cb4-499" aria-hidden="true" tabindex="-1"></a>            <span class="fu">title</span>(<span class="st">&quot;Color Key</span><span class="sc">\n</span><span class="st">and Histogram&quot;</span>)</span>
<span id="cb4-500"><a href="#cb4-500" aria-hidden="true" tabindex="-1"></a>            <span class="fu">par</span>(<span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb4-501"><a href="#cb4-501" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="st">&quot;Count&quot;</span>, <span class="at">line =</span> <span class="dv">2</span>)</span>
<span id="cb4-502"><a href="#cb4-502" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-503"><a href="#cb4-503" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="fu">title</span>(<span class="st">&quot;Color Key&quot;</span>)</span>
<span id="cb4-504"><a href="#cb4-504" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-505"><a href="#cb4-505" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">plot.new</span>()</span>
<span id="cb4-506"><a href="#cb4-506" aria-hidden="true" tabindex="-1"></a>    retval<span class="sc">$</span>colorTable <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">low =</span> retval<span class="sc">$</span>breaks[<span class="sc">-</span><span class="fu">length</span>(retval<span class="sc">$</span>breaks)],</span>
<span id="cb4-507"><a href="#cb4-507" aria-hidden="true" tabindex="-1"></a>        <span class="at">high =</span> retval<span class="sc">$</span>breaks[<span class="sc">-</span><span class="dv">1</span>], <span class="at">color =</span> retval<span class="sc">$</span>col)</span>
<span id="cb4-508"><a href="#cb4-508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">invisible</span>(retval)</span>
<span id="cb4-509"><a href="#cb4-509" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-510"><a href="#cb4-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-511"><a href="#cb4-511" aria-hidden="true" tabindex="-1"></a>myclust <span class="ot">&lt;-</span> <span class="cf">function</span>(c)</span>
<span id="cb4-512"><a href="#cb4-512" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-513"><a href="#cb4-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hclust</span>(c,<span class="at">method=</span><span class="st">&quot;average&quot;</span>)</span>
<span id="cb4-514"><a href="#cb4-514" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-515"><a href="#cb4-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-516"><a href="#cb4-516" aria-hidden="true" tabindex="-1"></a>na.dist <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">method=</span><span class="st">&quot;euclidian&quot;</span>,...) </span>
<span id="cb4-517"><a href="#cb4-517" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-518"><a href="#cb4-518" aria-hidden="true" tabindex="-1"></a>  t.dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(x,...)</span>
<span id="cb4-519"><a href="#cb4-519" aria-hidden="true" tabindex="-1"></a>  t.dist <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(t.dist)</span>
<span id="cb4-520"><a href="#cb4-520" aria-hidden="true" tabindex="-1"></a>  t.limit <span class="ot">&lt;-</span> <span class="fl">1.1</span><span class="sc">*</span><span class="fu">max</span>(t.dist,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-521"><a href="#cb4-521" aria-hidden="true" tabindex="-1"></a>  t.dist[<span class="fu">is.na</span>(t.dist)] <span class="ot">&lt;-</span> t.limit</span>
<span id="cb4-522"><a href="#cb4-522" aria-hidden="true" tabindex="-1"></a>  t.dist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(t.dist)</span>
<span id="cb4-523"><a href="#cb4-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(t.dist)</span>
<span id="cb4-524"><a href="#cb4-524" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="figure-three" class="section level2">
<h2>Figure Three</h2>
<p>A “heatmap” of physico-chemical properties, in vitro TK parameters
(Wetmore, et al., 2013), and TK parameters estimated from in vivo plasma
concentration. Rows (chemicals) are clustered by Euclidean distance so
that adjacent rows are more similar to each other. Each column (chemical
properties) was scaled by the standard deviation of the column and the
mean value was subtracted, such that a value of 0 corresponds to the
mean and values of -1 or 1 correspond to values one standard deviation
above or below the chemicals, respectively. In some cases, TK parameters
could not be estimated (e.g., no oral data available for estimating Fbio
and kgutabs). Fraction of the compound that is neutral, positively, or
negatively ionized at pH 7.4 is indicated by “neutral ph74”, “positive
ph74” and “negative ph74”. The color bar at the left-hand side indicates
pharmaceuticals in grey and other chemicals in black.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>physprop.matrix <span class="ot">&lt;-</span> chem.invivo.PK.aggregate.data[,<span class="fu">c</span>(<span class="st">&quot;MW&quot;</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;logP&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;WaterSol&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Neutral.pH74&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Positive.pH74&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Negative.pH74&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Clint&quot;</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Fup&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Vdist&quot;</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;kelim&quot;</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;kgutabs&quot;</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;Fbio&quot;</span>)]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>rnames <span class="ot">&lt;-</span> chem.invivo.PK.aggregate.data<span class="sc">$</span>Compound</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>rnames[rnames<span class="sc">==</span><span class="st">&quot;Bensulide&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bensulide.Joint&quot;</span>,<span class="st">&quot;Bensulide.NHEERL&quot;</span>,<span class="st">&quot;Bensulide.RTI&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>rnames[rnames<span class="sc">==</span><span class="st">&quot;Propyzamide&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Propyzamide.Joint&quot;</span>,<span class="st">&quot;Propyzamide.NHEERL&quot;</span>,<span class="st">&quot;Propyzamide.RTI&quot;</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(physprop.matrix) <span class="ot">&lt;-</span> rnames</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>row.side.cols <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Black&quot;</span>,<span class="fu">dim</span>(physprop.matrix)[<span class="dv">1</span>])</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>row.side.cols[<span class="fu">sapply</span>(chem.invivo.PK.aggregate.data<span class="sc">$</span>CAS,is.pharma)] <span class="ot">&lt;-</span> <span class="st">&quot;Grey&quot;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(physprop.matrix,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">mean</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>),<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">12</span>))) physprop.matrix[,this.col] <span class="ot">&lt;-</span> <span class="fu">log10</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span><span class="sc">+</span>physprop.matrix[,this.col])</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>physprop.matrix <span class="ot">&lt;-</span> <span class="fu">apply</span>(physprop.matrix,<span class="dv">2</span>,<span class="cf">function</span>(x) (x<span class="sc">-</span><span class="fu">mean</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>))<span class="sc">/</span><span class="fu">sd</span>(x,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>main_title<span class="ot">=</span><span class="st">&quot;in vivo Toxicokinetic Parameters&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(physprop.matrix, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclustfun=</span>myclust,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">FALSE</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">distfun=</span>na.dist, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">na.rm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">RowSideColors=</span>row.side.cols,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>,<span class="st">&quot;Spectral&quot;</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">10</span>)) </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The following has to be adjusted manually:</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="fl">0.65</span>, <span class="fl">0.01</span>, <span class="fl">0.87</span>, <span class="fl">0.78</span>, <span class="at">border=</span><span class="st">&quot;blue&quot;</span>) </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.75</span>,<span class="fl">0.81</span>,<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Estimated from &quot;</span>,<span class="fu">italic</span>(<span class="st">&quot;In Vivo&quot;</span>),<span class="st">&quot; Data&quot;</span>)))</span></code></pre></div>
<p>The original scripts used a data.table called FitData that contains a
lot of stuff we don’t need to make these figures. We recreate it from
the httk object chem.invivo.PK.aggregate.data:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use joint analysis data from both labs:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>FitData <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.invivo.PK.aggregate.data,Compound<span class="sc">!=</span><span class="st">&quot;Bensulide&quot;</span><span class="sc">|</span>Source<span class="sc">==</span><span class="st">&quot;Wambaugh et al. (2018), NHEERL/RTI&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>FitData <span class="ot">&lt;-</span> <span class="fu">subset</span>(FitData,Compound<span class="sc">!=</span><span class="st">&quot;Propyzamide&quot;</span><span class="sc">|</span>Source<span class="sc">==</span><span class="st">&quot;Wambaugh et al. (2018), NHEERL/RTI&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename some columns to match original data files:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>Compound.abbrev <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Abbrev</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column indicating chemical type:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>Chemical <span class="ot">&lt;-</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>FitData[<span class="fu">sapply</span>(FitData<span class="sc">$</span>CAS,is.pharma),<span class="st">&quot;Chemical&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Pharmaceutical&quot;</span></span></code></pre></div>
</div>
<div id="figure-four" class="section level2">
<h2>Figure Four</h2>
<p>Comparison of measured volumes of distribution (Vd) with predictions
based upon in vitro data and in silico methods (Pearce, et al., 2017a;
Schmitt, 2008). The solid line in each panel indicates the identity line
(1:1, perfect predictions). Chemicals can be identified by their
chemical abbreviation given in Table 1.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of chemicals with Fup &lt; LOD:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>FitData.Fup <span class="ot">&lt;-</span> <span class="fu">subset</span>(FitData,<span class="sc">!</span>(CAS<span class="sc">%in%</span><span class="fu">subset</span>(chem.physical_and_invitro.data,Human.Funbound.plasma<span class="sc">==</span><span class="dv">0</span>)<span class="sc">$</span>CAS))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename some columns to match original data files:</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>SelectedVdist <span class="ot">&lt;-</span> FitData.Fup<span class="sc">$</span>Vdist</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>SelectedVdist.sd <span class="ot">&lt;-</span> FitData.Fup<span class="sc">$</span>Vdist.sd</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Predict volume of Distribution</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>Vdist<span class="fl">.1</span>comp.pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(FitData.Fup<span class="sc">$</span>CAS,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">suppressWarnings</span>(<span class="fu">calc_vdist</span>(<span class="at">chem.cas=</span>x,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">species=</span><span class="st">&quot;Rat&quot;</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">default.to.human =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>Vdist<span class="fl">.1</span>comp.pred.nocal <span class="ot">&lt;-</span> <span class="fu">sapply</span>(FitData.Fup<span class="sc">$</span>CAS,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">suppressWarnings</span>(<span class="fu">calc_vdist</span>(<span class="at">chem.cas=</span>x,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">regression=</span><span class="cn">FALSE</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">species=</span><span class="st">&quot;Rat&quot;</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">default.to.human =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)))</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>FigVdista.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedVdist)<span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdista.fit)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>FigVdista.fit.weighted <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedVdist)<span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)),<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedVdist.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdista.fit)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>FigVdista.fit.pharm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">!=</span><span class="st">&quot;Other&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdista.fit.pharm)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>FigVdista.fit.other <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdista.fit.other)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedVdist.sd)<span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))[<span class="dv">1</span>]</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>FigVdista <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred))) <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">color=</span><span class="st">&quot;Grey&quot;</span>,<span class="fu">aes</span>(<span class="at">x=</span>Vdist<span class="fl">.1</span>comp.pred,<span class="at">y=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">-</span>SelectedVdist.sd),<span class="at">xend=</span>Vdist<span class="fl">.1</span>comp.pred,<span class="at">yend=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">+</span>SelectedVdist.sd)))<span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;SelectedVdist&quot;</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;Vdist.1comp.pred&quot;</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>,<span class="at">size=</span><span class="dv">6</span>)  <span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated Volume of Distribution (L/kg)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Calibrated &quot;</span>,<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted &quot;</span>,V[d],<span class="st">&quot; (L/kg)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>FigVdistb.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred.nocal),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdistb.fit)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>FigVdistb.fit.weighted <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred.nocal),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)),<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedVdist.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdistb.fit)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>FigVdistb.fit.pharm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred.nocal),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">!=</span><span class="st">&quot;Other&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdistb.fit.pharm)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>FigVdistb.fit.other<span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">~</span><span class="fu">log</span>(Vdist<span class="fl">.1</span>comp.pred.nocal),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred)))</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigVdistb.fit.other)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>FigVdistb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred.nocal))) <span class="sc">+</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_segment</span>(<span class="at">color=</span><span class="st">&quot;Grey&quot;</span>,<span class="fu">aes</span>(<span class="at">x=</span>Vdist<span class="fl">.1</span>comp.pred.nocal,<span class="at">y=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">-</span>SelectedVdist.sd),<span class="at">xend=</span>Vdist<span class="fl">.1</span>comp.pred.nocal,<span class="at">yend=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedVdist)<span class="sc">+</span>SelectedVdist.sd)))<span class="sc">+</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;SelectedVdist&quot;</span>,</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;Vdist.1comp.pred.nocal&quot;</span>,</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>   <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated Volume of Distribution (L/kg)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Original &quot;</span>,<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted &quot;</span>,V[d],<span class="st">&quot; (L/kg)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(FigVdista,FigVdistb,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>Fig4a.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedVdist)<span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred))</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>Fig4a.MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">log</span>(Fig4a.data<span class="sc">$</span>Vdist<span class="fl">.1</span>comp.pred)<span class="sc">-</span><span class="fu">log</span>(Fig4a.data<span class="sc">$</span>SelectedVdist))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>Fig4b.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedVdist)<span class="sc">&amp;!</span><span class="fu">is.na</span>(Vdist<span class="fl">.1</span>comp.pred.nocal))</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>Fig4b.MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">log</span>(Fig4b.data<span class="sc">$</span>Vdist<span class="fl">.1</span>comp.pred.nocal)<span class="sc">-</span><span class="fu">log</span>(Fig4b.data<span class="sc">$</span>SelectedVdist))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="figure-five" class="section level2">
<h2>Figure Five</h2>
<p>Comparison of the TK clearance estimated from the in vivo data with
the clearance predictions made using HTTK data. The more likely
empirical TK model (either one or two-compartments, as in Figure 2) is
selected for each chemical using the AIC (Akaike, 1974). A
non-compartmental estimate of clearance is used if neither model is
selected. Estimated standard deviation is indicated by a vertical line,
and is often smaller than the plot point. The solid line indicates the
identity line (1:1, perfect predictions), while the dotted and dashed
lines indicate the linear regression (log-scale) trend-lines for
pharmaceuticals and other chemicals, respectively. Chemicals can be
identified by their chemical abbreviation given in Table 1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#FitData.Fup$CLtot.1comp &lt;- FitData.Fup$Vdist.1comp.meas*FitData.Fup$kelim.1comp.meas</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#FitData.Fup$CLtot.1comp.sd &lt;- (FitData.Fup$Vdist.1comp.meas.sd^2+FitData.Fup$kelim.1comp.meas.sd^2)^(1/2)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FitData.Fup[is.na(CLtot.1comp.sd)]$CLtot.1comp.sd &lt;- Inf</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#FitData.Fup[is.na(SelectedCLtot.sd)]$SelectedClearance.sd &lt;- Inf</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>SelectedCLtot <span class="ot">&lt;-</span> FitData.Fup<span class="sc">$</span>Vdist<span class="sc">*</span>FitData.Fup<span class="sc">$</span>kelim </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>SelectedCLtot.sd <span class="ot">&lt;-</span> (FitData.Fup<span class="sc">$</span>Vdist.sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  FitData.Fup<span class="sc">$</span>kelim.sd<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>FitData.Fup<span class="sc">$</span>CLtot<span class="fl">.1</span>comp.pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(FitData.Fup<span class="sc">$</span>CAS, </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">calc_total_clearance</span>(<span class="at">chem.cas=</span>x,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">species=</span><span class="st">&quot;Rat&quot;</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">default.to.human =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">~</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedCLtot.sd)))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig.SelectedClearance.fit)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance.fit.weighted <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">~</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="sc">!</span><span class="fu">is.na</span>(SelectedCLtot.sd)),<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedCLtot.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig.SelectedClearance.fit.weighted)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance.fit.pharma <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">~</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">!=</span><span class="st">&quot;Other&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(SelectedCLtot.sd)),<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedCLtot.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig.SelectedClearance.fit.pharma)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance.fit.other<span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">~</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(SelectedCLtot.sd)),<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedCLtot.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig.SelectedClearance.fit.other)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance.fit.pharma <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">~</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">!=</span><span class="st">&quot;Other&quot;</span>))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig.SelectedClearance.fit.pharma)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance.fit.other<span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">~</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span>))</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig.SelectedClearance.fit.other)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>Fig.SelectedClearance<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FitData.Fup,<span class="fu">aes</span>(<span class="at">y=</span>SelectedCLtot,<span class="at">x=</span>CLtot<span class="fl">.1</span>comp.pred)) <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data=</span><span class="fu">subset</span>(FitData.Fup,<span class="fu">is.finite</span>(SelectedCLtot.sd)),<span class="at">color=</span><span class="st">&quot;grey&quot;</span>,<span class="fu">aes</span>(<span class="at">x=</span>CLtot<span class="fl">.1</span>comp.pred,<span class="at">y=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">-</span>SelectedCLtot.sd),<span class="at">xend=</span>CLtot<span class="fl">.1</span>comp.pred,<span class="at">yend=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedCLtot)<span class="sc">+</span>SelectedCLtot.sd)))<span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;SelectedCLtot&quot;</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;CLtot.1comp.pred&quot;</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_point(data=twocomp.data,color=&quot;White&quot;,size=2,aes(shape=Source))+ </span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> CLtot<span class="fl">.1</span>comp.pred, <span class="at">y =</span> <span class="fu">exp</span>(Fig.SelectedClearance.fit.pharma<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>Fig.SelectedClearance.fit.pharma<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred))), <span class="at">colour =</span> <span class="st">&quot;darkturquoise&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> CLtot<span class="fl">.1</span>comp.pred, <span class="at">y =</span> <span class="fu">exp</span>(Fig.SelectedClearance.fit.other<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>Fig.SelectedClearance.fit.other<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(CLtot<span class="fl">.1</span>comp.pred))), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated clearance (mg/L/h)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted clearance (mg/L/h)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()   <span class="sc">+</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>,<span class="at">size=</span><span class="dv">4</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(Fig.SelectedClearance.fit.pharma,<span class="at">prefix=</span><span class="st">&quot;Pharmaceutical:&quot;</span>),<span class="at">parse=</span><span class="cn">TRUE</span>)<span class="sc">+</span> </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">3</span><span class="sc">*</span><span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>,<span class="at">size=</span><span class="dv">4</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(Fig.SelectedClearance.fit.other,<span class="at">prefix=</span><span class="st">&quot;Other:&quot;</span>),<span class="at">parse=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=6,height=6)</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Fig.SelectedClearance)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;with&quot;</span>,<span class="fu">with</span>(FitData.Fup,<span class="fu">sum</span>(SelectedCLtot<span class="sc">&lt;</span>CLtot<span class="fl">.1</span>comp.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),<span class="st">&quot;chemicals over-estimated and&quot;</span>,<span class="fu">with</span>(FitData.Fup,<span class="fu">sum</span>(SelectedCLtot<span class="sc">&gt;</span>CLtot<span class="fl">.1</span>comp.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),<span class="st">&quot;under-estimated&quot;</span>)</span></code></pre></div>
</div>
<div id="figure-six" class="section level2">
<h2>Figure Six</h2>
<p>Distribution of Gut Absorption Rate for Environmental and
Pharmaceutical Chemicals.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>Selectedkgutabs <span class="ot">&lt;-</span> FitData<span class="sc">$</span>kgutabs</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cutoff from optimizer is 1000:</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Figkgutabs <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(FitData,Selectedkgutabs<span class="sc">&lt;</span><span class="dv">999</span>), <span class="fu">aes</span>(Selectedkgutabs, <span class="at">fill =</span> Chemical)) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="st">&quot;Number of Chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="st">&quot;Absorption Rate from Gut (1/h)&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=6,height=6)</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Figkgutabs) </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">subset</span>(FitData,Selectedkgutabs<span class="sc">&lt;</span><span class="dv">999</span>)<span class="sc">$</span>Selectedkgutabs)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">subset</span>(FitData,Selectedkgutabs<span class="sc">&lt;</span><span class="dv">999</span>)<span class="sc">$</span>Selectedkgutabs)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">subset</span>(FitData,Selectedkgutabs<span class="sc">&lt;</span><span class="dv">999</span>)<span class="sc">$</span>Selectedkgutabs)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(<span class="fu">subset</span>(FitData,Selectedkgutabs<span class="sc">&lt;</span><span class="dv">999</span>)<span class="sc">$</span>Selectedkgutabs)</span></code></pre></div>
</div>
<div id="figure-seven" class="section level2">
<h2>Figure Seven</h2>
<p>In panel A, the observed fraction of oral dose absorbed from the gut
is compared with predictions made using Gastroplus (Simulations Plus,
2017). The solid line indicates the identity line (1:1, perfect
predictions). These fractions are distrusted from nearly zero to
effectively 100% (Panel B). Chemicals can be identified by their
chemical abbreviation given in Table 1.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>SelectedFbio <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Fbio</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>FigFbioa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FitData) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;SelectedFbio&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;Fbio.pred&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#    xlim(0, 1)+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    ylim(0, 1)+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">015</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">y =</span> <span class="fl">0.55</span>, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated Fraction Bioavailable&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In silico&quot;</span>),<span class="st">&quot; predicted &quot;</span>,F[bio]))) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) + </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>FigFbiob <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(FitData, <span class="fu">aes</span>(SelectedFbio, <span class="at">fill =</span> Chemical)) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">001</span>, <span class="at">y =</span> <span class="dv">18</span>, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of Chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated Fraction Bioavailable&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(FigFbioa,FigFbiob,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">log</span>(SelectedFbio)<span class="sc">~</span><span class="fu">log</span>(Fbio.pred),<span class="at">data=</span>FitData))</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;Fbio ranged from&quot;</span>,<span class="fu">signif</span>(<span class="fu">min</span>(FitData[FitData<span class="sc">$</span>Chemical<span class="sc">==</span><span class="st">&quot;Pharmaceutical&quot;</span>,<span class="st">&quot;SelectedFbio&quot;</span>],<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;to&quot;</span>,<span class="fu">signif</span>(<span class="fu">max</span>(FitData[FitData<span class="sc">$</span>Chemical<span class="sc">==</span><span class="st">&quot;Pharmaceutical&quot;</span>,<span class="st">&quot;SelectedFbio&quot;</span>],<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;for pharmaceutical compounds, but was observed to be as low as&quot;</span>, <span class="fu">signif</span>(<span class="fu">min</span>(FitData[FitData<span class="sc">$</span>Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span>,<span class="st">&quot;SelectedFbio&quot;</span>],<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">3</span>),<span class="st">&quot;for other compounds.&quot;</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(FitData<span class="sc">$</span>SelectedFbio,<span class="at">na.rm=</span><span class="cn">TRUE</span>)                       </span></code></pre></div>
</div>
<div id="figure-eight" class="section level2">
<h2>Figure Eight</h2>
<p>Rat in vivo data were collected for diverse environmental chemicals
to evaluate the predictive ability of HTTK, especially with respect to
predicting steady-state serum concentration (Css). Chemicals can be
identified by their chemical abbreviation given in Table 1. The
abbreviations are centered at the measured and predicted values. The
solid line indicates the identity line (1:1, perfect predictions). In
panel A, the one-compartment model is parameterized with a predicted
volume of distribution and clearance, based upon in vitro measured
parameters. Fbio is assumed to be 100%. In panel B, the in vivo measured
Fbio is used to reduce the amount of the oral dose absorbed in the
one-compartment model, to illustrate the improvement possible if Fbio
could be predicted accurately.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>SelectedFbio <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Fbio</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>SelectedCss <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Css</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>SelectedCss.sd <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Css.sd</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>Css<span class="fl">.1</span>comp.pred <span class="ot">&lt;-</span> <span class="fu">sapply</span>(FitData<span class="sc">$</span>CAS,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">calc_analytic_css</span>(<span class="at">chem.cas=</span>x,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">species=</span><span class="st">&quot;Rat&quot;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameterize.args =</span> <span class="fu">list</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">default.to.human=</span><span class="cn">TRUE</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjusted.Funbound.plasma=</span><span class="cn">TRUE</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">regression=</span><span class="cn">TRUE</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">minimum.Funbound.plasma=</span><span class="fl">1e-4</span>)))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCss.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css<span class="fl">.1</span>comp.pred),<span class="at">data=</span>FitData,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCss.fit.weighted <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css<span class="fl">.1</span>comp.pred),<span class="at">data=</span>FitData,<span class="at">na.rm=</span><span class="cn">TRUE</span>,<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedCss.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCss.fit.pharma <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData,Chemical<span class="sc">!=</span><span class="st">&quot;Other&quot;</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCss.fit.other <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css<span class="fl">.1</span>comp.pred),<span class="at">data=</span><span class="fu">subset</span>(FitData,Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig<span class="fl">.1</span>compCss.fit)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig<span class="fl">.1</span>compCss.fit.pharma)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Fig<span class="fl">.1</span>compCss.fit.other)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>textx <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>texty <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>Fig.Cssa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FitData) <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">color=</span><span class="st">&quot;grey&quot;</span>,<span class="fu">aes</span>(<span class="at">x=</span>Css<span class="fl">.1</span>comp.pred,<span class="at">y=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">-</span>SelectedCss.sd),<span class="at">xend=</span>Css<span class="fl">.1</span>comp.pred,<span class="at">yend=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">+</span>SelectedCss.sd)))<span class="sc">+</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">4</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;SelectedCss&quot;</span>, <span class="at">x=</span><span class="st">&quot;Css.1comp.pred&quot;</span>,<span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,<span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated &quot;</span>,C[ss],<span class="st">&quot; (mg/L)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a> <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted &quot;</span>,C[ss],<span class="st">&quot; (mg/L)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_brewer(palette=&quot;Set2&quot;) + </span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> textx<span class="sc">/</span><span class="dv">15</span>, <span class="at">y =</span> <span class="dv">5</span><span class="sc">*</span>texty, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> textx, <span class="at">y =</span> texty,<span class="at">size=</span><span class="dv">6</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(Fig<span class="fl">.1</span>compCss.fit),<span class="at">parse=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)) </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotate(&quot;text&quot;,x = textx/3, y = texty/3,size=4, label = lm_R2(Fig.1compCss.fit.weighted,prefix=&quot;Weighted:&quot;),parse=TRUE) </span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotate(&quot;text&quot;,x = textx, y = texty,size=4, label = lm_R2(Fig.1compCss.fit.pharma,prefix=&quot;Pharmaceutical:&quot;),parse=TRUE)</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotate(&quot;text&quot;,x = textx, y = texty/3,size=4, label = lm_R2(Fig.1compCss.fit.other,prefix=&quot;Other:&quot;),parse=TRUE) </span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>Css.Bio <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Css<span class="fl">.1</span>comp.pred<span class="sc">*</span>FitData<span class="sc">$</span>SelectedFbio</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCssb.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css.Bio),<span class="at">data=</span>FitData,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCssb.fit.weighted <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css.Bio),<span class="at">data=</span>FitData,<span class="at">na.rm=</span><span class="cn">TRUE</span>,<span class="at">weights=</span><span class="dv">1</span><span class="sc">/</span>SelectedCss.sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCssb.fit.pharma <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css.Bio),<span class="at">data=</span><span class="fu">subset</span>(FitData,Chemical<span class="sc">!=</span><span class="st">&quot;Other&quot;</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>Fig<span class="fl">.1</span>compCssb.fit.other <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">~</span><span class="fu">log</span>(Css.Bio),<span class="at">data=</span><span class="fu">subset</span>(FitData,Chemical<span class="sc">==</span><span class="st">&quot;Other&quot;</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>Fig.Cssb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FitData) <span class="sc">+</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">color=</span><span class="st">&quot;grey&quot;</span>,<span class="fu">aes</span>(<span class="at">x=</span>Css.Bio,<span class="at">y=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">-</span>SelectedCss.sd),<span class="at">xend=</span>Css.Bio,<span class="at">yend=</span><span class="fu">exp</span>(<span class="fu">log</span>(SelectedCss)<span class="sc">+</span>SelectedCss.sd)))<span class="sc">+</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">4</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;SelectedCss&quot;</span>, <span class="at">x=</span><span class="st">&quot;Css.Bio&quot;</span>,<span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,<span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated &quot;</span>,C[ss],<span class="st">&quot; (mg/L)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a> <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted &quot;</span>,C[ss],<span class="st">&quot; (mg/L) Using Measured &quot;</span>, F[bio]))) <span class="sc">+</span> </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_brewer(palette=&quot;Set2&quot;) + </span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> textx<span class="sc">/</span><span class="dv">15</span>, <span class="at">y =</span> <span class="dv">5</span><span class="sc">*</span>texty, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> textx, <span class="at">y =</span> texty,<span class="at">size=</span><span class="dv">6</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(Fig<span class="fl">.1</span>compCssb.fit),<span class="at">parse=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)) </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(Fig.Cssa,Fig.Cssb,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>                        </span></code></pre></div>
</div>
<div id="figure-nine" class="section level2">
<h2>Figure Nine</h2>
<p>Evaluation of Wambaugh et al. (2015) classification scheme for
predicting errors made when using HTTK data to predict in vivo steady
state plasma concentration (Css). Chemicals were placed into categories,
depending upon the size of the error. “On the Order” represented the
best case, where errors were within 3.2 times over or under the true
value. Some chemicals were determined to be problematic due to
limitations in the HTTK methods (e.g., plasma protein binding
estimation) or failure to come to steady state. Wherever the chemical
names overlap the vertical, gray bands, the observed errors are
consistent with predicted error. Chemicals can be identified by their
chemical abbreviation given in Table 1.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>TriageCat <span class="ot">&lt;-</span> FitData<span class="sc">$</span>Triage.Call</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>CssResidual <span class="ot">&lt;-</span> <span class="fu">log10</span>(FitData<span class="sc">$</span>Css<span class="fl">.1</span>comp.pred<span class="sc">/</span>FitData<span class="sc">$</span>Css)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>FitData[FitData<span class="sc">$</span>TriageCat<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Does Not Reach Steady State&quot;</span>,<span class="st">&quot;Plasma Binding Assay Failed&quot;</span>),<span class="st">&quot;TriageCat&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;Problem&quot;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>FitData<span class="sc">$</span>TriageCat <span class="ot">&lt;-</span> <span class="fu">factor</span>(FitData<span class="sc">$</span>TriageCat,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;&gt;10x Underestimated&quot;</span>,<span class="st">&quot;&gt;3.2x Underestimated&quot;</span>,<span class="st">&quot;On the Order&quot;</span>,<span class="st">&quot;&gt;3.2x Overestimated&quot;</span>,<span class="st">&quot;&gt;10x Overestimated&quot;</span>,<span class="st">&quot;Problem&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>Fig.Triage <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(FitData,<span class="sc">!</span><span class="fu">is.na</span>(TriageCat)<span class="sc">&amp;</span><span class="fu">is.finite</span>(CssResidual))) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">4</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;CssResidual&quot;</span>, <span class="at">x=</span><span class="st">&quot;TriageCat&quot;</span>,<span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,<span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="st">&quot;&gt;10x Underestimated&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">y =</span> <span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>), <span class="at">xend =</span> <span class="fu">factor</span>(<span class="st">&quot;&gt;10x Underestimated&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">yend =</span> <span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">30</span>)), <span class="at">size=</span><span class="dv">3</span>,<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_segment(aes(x = factor(&quot;&gt;3.2x Underestimated&quot;,levels=levels(FitData$TriageCat)), y = log10(1/10), xend = factor(&quot;&gt;3.2x Underestimated&quot;,levels=levels(FitData$TriageCat)), yend = log10(1/3.2)), size=3,colour = &quot;grey&quot;) +</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="st">&quot;On the Order&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">y =</span> <span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">3.2</span>), <span class="at">xend =</span> <span class="fu">factor</span>(<span class="st">&quot;On the Order&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">yend =</span> <span class="fu">log10</span>(<span class="fl">3.2</span>)), <span class="at">size=</span><span class="dv">3</span>,<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="st">&quot;&gt;3.2x Overestimated&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">y =</span> <span class="fu">log10</span>(<span class="fl">3.2</span>), <span class="at">xend =</span> <span class="fu">factor</span>(<span class="st">&quot;&gt;3.2x Overestimated&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">yend =</span> <span class="fu">log10</span>(<span class="dv">10</span>)), <span class="at">size=</span><span class="dv">3</span>,<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="st">&quot;&gt;10x Overestimated&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">y =</span> <span class="fu">log10</span>(<span class="dv">10</span>), <span class="at">xend =</span> <span class="fu">factor</span>(<span class="st">&quot;&gt;10x Overestimated&quot;</span>,<span class="at">levels=</span><span class="fu">levels</span>(FitData<span class="sc">$</span>TriageCat)), <span class="at">yend =</span> <span class="fu">log10</span>(<span class="dv">500</span>)), <span class="at">size=</span><span class="dv">3</span>,<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">3.2</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">log10</span>(<span class="fl">3.2</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">log10</span>(<span class="dv">10</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">4</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;CssResidual&quot;</span>, <span class="at">x=</span><span class="st">&quot;TriageCat&quot;</span>,<span class="at">label=</span><span class="st">&quot;Compound.abbrev&quot;</span>,<span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Actual error in &quot;</span>,C[ss],<span class="st">&quot; prediction&quot;</span>)),<span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>),<span class="fu">log10</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">3.2</span>),<span class="dv">0</span>,<span class="fu">log10</span>(<span class="fl">3.2</span>),<span class="dv">1</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;&gt;10x Under&quot;</span>,<span class="st">&quot;&gt;3.2x Under&quot;</span>,<span class="st">&quot;On the Order&quot;</span>,<span class="st">&quot;&gt;3.2x Over&quot;</span>,<span class="st">&quot;&gt;10x Over&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted Error&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=6,height=6)</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Fig.Triage)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                        </span></code></pre></div>
</div>
<div id="figure-ten" class="section level2">
<h2>Figure Ten</h2>
<p>Evaluation of the ability of in vitro HTTK data, coupled with a
one-compartment model, to predict important TK statistics like the
maximum plasma concentration (Cmax) for characterizing tissue exposure.
A single point is plotted for each combination of chemical, dose amount,
and dose route, either intravenous (iv) or per oral (po). In panel A,
the one-compartment model is parameterized with a predicted volume of
distribution and clearance, based upon in vitro measured parameters.
Fbio is assumed to be 100%. In panel B, the in vivo measured Fbio is
used to reduce the amount of the oral dose absorbed in the
one-compartment model, to illustrate the improvement possible if Fbio
could be predicted accurately.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>PKstats <span class="ot">&lt;-</span> chem.invivo.PK.summary.data</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column indicating chemical type:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>PKstats<span class="sc">$</span>Chemical <span class="ot">&lt;-</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>PKstats[<span class="fu">sapply</span>(PKstats<span class="sc">$</span>CAS,is.pharma),<span class="st">&quot;Chemical&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Pharmaceutical&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>FigCmaxa.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Cmax)<span class="sc">~</span><span class="fu">log</span>(Cmax.pred),<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(Cmax)))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigCmaxa.fit)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>FigCmaxa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(Cmax))) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;Cmax&quot;</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;Cmax.pred&quot;</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape=</span><span class="st">&quot;Route&quot;</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated &quot;</span>,C[max]))) <span class="sc">+</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted &quot;</span>,C[max]))) <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) +</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">300</span>, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(FigCmaxa.fit),<span class="at">parse=</span><span class="cn">TRUE</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>FigCmaxb.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Cmax)<span class="sc">~</span><span class="fu">log</span>(Cmax.pred.Fbio),<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(Cmax)))</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigCmaxb.fit)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>FigCmaxb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(Cmax))) <span class="sc">+</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;Cmax&quot;</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;Cmax.pred.Fbio&quot;</span>,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape=</span><span class="st">&quot;Route&quot;</span>,</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated &quot;</span>,C[max]))) <span class="sc">+</span> </span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted &quot;</span>, C[max], <span class="st">&quot; Using Measured &quot;</span>, F[bio ]))) <span class="sc">+</span> </span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">300</span>, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(FigCmaxb.fit),<span class="at">parse=</span><span class="cn">TRUE</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) + </span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(FigCmaxa,FigCmaxb,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>                        </span></code></pre></div>
</div>
<div id="figure-eleven" class="section level2">
<h2>Figure Eleven</h2>
<p>Evaluation of predictions for the time integrated plasma
concentration (i.e., area under the curve or AUC). A single point is
plotted for each combination of chemical, dose amount, and dose route,
either intravenous (iv) or per oral (po). In panel A, the
one-compartment model is parameterized with a predicted volume of
distribution and clearance, based upon in vitro measured parameters.
Fbio is assumed to be 100%. In panel B, the in vivo measured Fbio is
used to reduce the amount of the oral dose absorbed in the
one-compartment model, to illustrate the improvement possible if Fbio
could be predicted accurately. The solid line in each panel indicates
the identity line (1:1, perfect predictions).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>FigAUCa.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(AUC)<span class="sc">~</span><span class="fu">log</span>(AUC.pred),<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(<span class="fu">log</span>(AUC))))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>FigAUCb.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(AUC)<span class="sc">~</span><span class="fu">log</span>(AUC.pred.Fbio),<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(<span class="fu">log</span>(AUC))))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigAUCa.fit)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(FigAUCb.fit)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                              </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>FigAUCa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(<span class="fu">log</span>(AUC)))) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;AUC&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;AUC.pred&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape=</span><span class="st">&quot;Route&quot;</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated AUC (mg*h/L)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; predicted Area under the Curve (AUC, mg*h/L)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(FigAUCa.fit),<span class="at">parse=</span><span class="cn">TRUE</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>FigAUCb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(PKstats,<span class="fu">is.finite</span>(<span class="fu">log</span>(AUC)))) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="fu">aes_string</span>(<span class="at">y=</span><span class="st">&quot;AUC&quot;</span>,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x=</span><span class="st">&quot;AUC.pred.Fbio&quot;</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape=</span><span class="st">&quot;Route&quot;</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">&quot;Chemical&quot;</span>))<span class="sc">+</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_logticks</span>() <span class="sc">+</span> </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; estimated AUC (mg*h/L)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted AUC (mg*h/L) Using Measured &quot;</span>, F[bio]))) <span class="sc">+</span> </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(FigAUCb.fit),<span class="at">parse=</span><span class="cn">TRUE</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(FigAUCa,FigAUCb,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>                        </span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
