<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John F. Wambaugh" />

<meta name="date" content="2025-01-13" />

<title>Wambaugh et al. (2019): Uncertainty Monte Carlo</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Wambaugh et al. (2019): Uncertainty Monte
Carlo</h1>
<h4 class="author">John F. Wambaugh</h4>
<h4 class="date">2025-01-13</h4>



<p><em>Please send questions to <a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></em></p>
<p>This vignette provides the code used to generate the figures in
Wambaugh et al. (2019) “Assessing Toxicokinetic Uncertainty and
Variability in Risk Prioritization.”</p>
<p>John F Wambaugh, Barbara A Wetmore, Caroline L Ring, Chantel I
Nicolas, Robert G Pearce, Gregory S Honda, Roger Dinallo, Derek Angus,
Jon Gilbert, Teresa Sierra, Akshay Badrinarayanan, Bradley Snodgrass,
Adam Brockman, Chris Strock, R Woodrow Setzer, Russell S Thomas</p>
<p>Toxicological Sciences, Volume 172, Issue 2, December 2019, Pages
235-251</p>
<p><a href="https://doi.org/10.1093/toxsci/kfz205" class="uri">https://doi.org/10.1093/toxsci/kfz205</a></p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>High(er) throughput toxicokinetics (HTTK) encompasses in vitro
measures of key determinants of chemical toxicokinetics and reverse
dosimetry approaches for <em>in vitro-in vivo</em> extrapolation
(IVIVE). With HTTK, the bioactivity identified by any <em>in vitro</em>
assay can be converted to human equivalent doses and compared with
chemical intake estimates. Biological variability in HTTK has been
previously considered, but the relative impact of measurement
uncertainty has not. Bayesian methods were developed to provide
chemical-specific uncertainty estimates for 2 in vitro toxicokinetic
parameters: unbound fraction in plasma (<span class="math inline">\(f_{up}\)</span>) and intrinsic hepatic clearance
(<span class="math inline">\(Cl_{int}\)</span>). New experimental
measurements of <span class="math inline">\(f_{up}\)</span> and <span class="math inline">\(Cl_{int}\)</span> are reported for 418 and 467
chemicals, respectively. These data raise the HTTK chemical coverage of
the ToxCast Phase I and II libraries to 57%. Although the standard
protocol for <span class="math inline">\(Cl_{int}\)</span> was followed,
a revised protocol for <span class="math inline">\(f_{up}\)</span>
measured unbound chemical at 10%, 30%, and 100% of physiologic plasma
protein concentrations, allowing estimation of protein binding affinity.
This protocol reduced the occurrence of chemicals with fup too low to
measure from 44% to 9.1%. Uncertainty in <span class="math inline">\(f_{up}\)</span> was also reduced, with the median
coefficient of variation dropping from 0.4 to 0.1. Monte Carlo
simulation was used to propagate both measurement uncertainty and
biological variability into IVIVE. The uncertainty propagation
techniques used here also allow incorporation of other sources of
uncertainty such as <em>in silico</em> predictors of HTTK parameters.
These methods have the potential to inform risk-based prioritization
based on the relationship between in vitro bioactivities and
exposures.</p>
</div>
<div id="httk-version" class="section level2">
<h2>HTTK Version</h2>
<p>This vignette was created with <strong>httk</strong> v1.10. Although
we attempt to maintain backward compatibility, if you encounter issues
with the latest release of <strong>httk</strong> and cannot easily
address the changes, historical versions of httk are available from: <a href="https://cran.r-project.org/src/contrib/Archive/httk/" class="uri">https://cran.r-project.org/src/contrib/Archive/httk/</a></p>
</div>
<div id="prepare-for-session" class="section level2">
<h2>Prepare for session</h2>
<p>R package <strong>knitr</strong> generates html and PDF documents
from this RMarkdown file, Each bit of code that follows is known as a
“chunk”. We start by telling <strong>knitr</strong> how we want our
chunks to look.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">collapse =</span> <span class="cn">TRUE</span>, <span class="at">comment =</span> <span class="st">&#39;#&gt;&#39;</span>, <span class="at">fig.width=</span><span class="dv">5</span>, <span class="at">fig.height=</span><span class="dv">3</span>)</span></code></pre></div>
<div id="clear-the-memory" class="section level3">
<h3>Clear the memory</h3>
<p>It is a bad idea to let variables and other information from previous
R sessions float around, so we first remove everything in the R
memory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="eval-execute.vignette" class="section level3">
<h3>eval = execute.vignette</h3>
<p>If you are using the RMarkdown version of this vignette (extension,
.RMD) you will be able to see that several chunks of code in this
vignette have the statement “eval = execute.vignette”. The next chunk of
code, by default, sets execute.vignette = FALSE. This means that the
code is included (and necessary) but was not run when the vignette was
built. We do this because some steps require extensive computing time
and the checks on CRAN limit how long we can spend building the package.
If you want this vignette to work, you must run all code, either by
cutting and pasting it into R. Or, if viewing the .RMD file, you can
either change execute.vignette to TRUE or press “play” (the green arrow)
on each chunk in RStudio.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set whether or not the following chunks will be executed (run):</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>execute.vignette <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<div id="load-the-relevant-libraries" class="section level3">
<h3>Load the relevant libraries</h3>
<p>We use the command ‘library()’ to load various R packages for our
analysis. If you get the message “Error in library(X) : there is no
package called ‘X’” then you will need to install that package:</p>
<p>From the R command prompt:</p>
<p>install.packages(“X”)</p>
<p>Or, if using RStudio, look for ‘Install Packages’ under ‘Tools’</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httk)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span></code></pre></div>
</div>
</div>
<div id="define-some-needed-code" class="section level2">
<h2>Define some needed code:</h2>
<div id="rmse-and-r2" class="section level3">
<h3>RMSE and <span class="math inline">\(R^2\)</span></h3>
<p>This returns an expression with <a href="https://en.wikipedia.org/wiki/Root-mean-square_deviation">root
mean squared error</a> (RMSE) and <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">coefficient
of determination</a> <span class="math inline">\(R^2\)</span> for
plotting:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lm_R2 <span class="ot">&lt;-</span> <span class="cf">function</span>(m,<span class="at">prefix=</span><span class="cn">NULL</span>){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">substitute</span>(<span class="st">&quot;RMSE = &quot;</span><span class="sc">~</span>mse<span class="sc">*</span><span class="st">&quot;,&quot;</span><span class="sc">~</span><span class="er">~</span><span class="fu">italic</span>(R)<span class="sc">^</span><span class="dv">2</span><span class="sc">~</span><span class="st">&quot;=&quot;</span><span class="sc">~</span>r2, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">list</span>(<span class="at">mse =</span> <span class="fu">signif</span>(<span class="fu">mean</span>(m<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="dv">3</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">r2 =</span> <span class="fu">format</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>adj.r.squared, <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(prefix,<span class="fu">as.character</span>(<span class="fu">as.expression</span>(out)))                 </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="multiple-plot-function" class="section level3">
<h3>Multiple plot function</h3>
<p>From <a href="http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/" class="uri">http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/</a>
ggplot objects can be passed in …, or to plotlist (as a list of ggplot
objects) - cols: Number of columns in layout - layout: A matrix
specifying the layout. If present, ‘cols’ is ignored.</p>
<p>If the layout is something like matrix(c(1,2,3,3), nrow=2,
byrow=TRUE), then plot 1 will go in the upper left, 2 will go in the
upper right, and 3 will go all the way across the bottom.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>multiplot <span class="ot">&lt;-</span> <span class="cf">function</span>(..., <span class="at">plotlist=</span><span class="cn">NULL</span>, file, <span class="at">cols=</span><span class="dv">1</span>, <span class="at">layout=</span><span class="cn">NULL</span>, <span class="at">heights=</span><span class="cn">NULL</span>, <span class="at">widths=</span><span class="fu">unit</span>(<span class="fu">rep_len</span>(<span class="dv">1</span>, cols), <span class="st">&quot;null&quot;</span>)) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a list from the ... arguments and plotlist</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(...), plotlist)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  numPlots <span class="ot">=</span> <span class="fu">length</span>(plots)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If layout is NULL, then use &#39;cols&#39; to determine layout</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(layout)) {</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make the panel</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ncol: Number of columns of plots</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nrow: Number of rows needed, calculated from # of cols</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    layout <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>, cols <span class="sc">*</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>cols)),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> cols, <span class="at">nrow =</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>cols))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (numPlots<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plots[[<span class="dv">1</span>]])</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up the page</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grid.newpage</span>()</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(heights))</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(<span class="fu">nrow</span>(layout), <span class="fu">ncol</span>(layout),<span class="at">heights=</span>heights,<span class="at">widths=</span>widths)))</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(<span class="fu">nrow</span>(layout), <span class="fu">ncol</span>(layout),<span class="at">widths=</span>widths)))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make each plot, in the correct location</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlots) {</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the i,j matrix positions of the regions that contain this subplot</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      matchidx <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">which</span>(layout <span class="sc">==</span> i, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(plots[[i]], <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> matchidx<span class="sc">$</span>row,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">layout.pos.col =</span> matchidx<span class="sc">$</span>col))</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="function-to-format-scientific-notation" class="section level3">
<h3>Function to format scientific notation</h3>
<p>From <a href="https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales" class="uri">https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales</a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                                  </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="fu">scientific_format</span>()(x))              </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">parse</span>(<span class="at">text=</span><span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>}  </span></code></pre></div>
</div>
<div id="function-to-format-scientific-notation-1" class="section level3">
<h3>Function to format scientific notation</h3>
<p>This one leaves every other tickmark blank:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scientific_10_skip <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                                  </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="fu">scientific_format</span>()(x))              </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^-01&quot;</span>,<span class="cn">NA</span>,out)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">parse</span>(<span class="at">text=</span>out))                   </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
</div>
<div id="calculates-the-c_ss-using-uncertainty-only" class="section level3">
<h3>Calculates the <span class="math inline">\(C_{ss}\)</span> using
uncertainty only:</h3>
<p><span class="math inline">\(C_{ss}\)</span> is the steady-state
plasma concentration.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cssfun_u <span class="ot">&lt;-</span> <span class="cf">function</span>(chemcas, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                      MW, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                      hepatic.bioavailability, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Fgutabs=</span><span class="dv">1</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">probs=</span><span class="fl">0.95</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">minimum.Funbound.plasma=</span><span class="fl">0.0001</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data table with uncertainty only:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  pop_u_httk <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">parameterize_steadystate</span>(<span class="at">chem.cas=</span>chemcas,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">minimum.Funbound.plasma=</span><span class="dv">0</span>))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the physico-chemical properties:</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  params.schmitt <span class="ot">&lt;-</span><span class="fu">parameterize_schmitt</span>(<span class="at">chem.cas=</span>chemcas)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  psd <span class="ot">&lt;-</span> params.schmitt<span class="sc">$</span>pKa_Donor</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  psa <span class="ot">&lt;-</span> params.schmitt<span class="sc">$</span>pKa_Accept</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  params.schmitt <span class="ot">&lt;-</span> params.schmitt[<span class="fu">regexpr</span>(<span class="st">&quot;pKa&quot;</span>,<span class="fu">names</span>(params.schmitt))<span class="sc">==-</span><span class="dv">1</span>]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,<span class="fu">names</span>(params.schmitt)<span class="sc">:</span><span class="er">=</span>params.schmitt]</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,pKa_Donor <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(psd, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>)]</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,pKa_Accept <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(psa, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>)]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  pop_u_httk <span class="ot">&lt;-</span> pop_u_httk[<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>)]</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the distribution coefficient:</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  ions <span class="ot">&lt;-</span> <span class="fu">calc_ionization</span>(<span class="at">pH=</span><span class="fl">7.4</span>,<span class="at">parameters=</span>pop_u_httk)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,Dow74 <span class="sc">:</span><span class="er">=</span> Pow <span class="sc">*</span> (ions<span class="sc">$</span>fraction_neutral <span class="sc">+</span> </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.001</span> <span class="sc">*</span> ions<span class="sc">$</span>fraction_charged <span class="sc">+</span> ions<span class="sc">$</span>fraction_zwitter)]</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse the Funbound.plasma.dist into quantiles:</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  Funbound.plasma.dist <span class="ot">&lt;-</span> pop_u_httk[<span class="dv">1</span>,Funbound.plasma.dist]</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nchar</span>(Funbound.plasma.dist) <span class="sc">-</span> </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nchar</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Funbound.plasma.dist))<span class="sc">!=</span><span class="dv">2</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Funbound.plasma distribution should be three values (median,low95th,high95th) separated by commas.&quot;</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  ppb.median <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  ppb.low95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  ppb.high95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ppb.median<span class="sc">&gt;</span>minimum.Funbound.plasma)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use optim to estimate alpha and beta for fup such that the median and 95% </span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># credible interval approximate the estimate from MCMC:</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    ppb.fit <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">2</span>,(<span class="dv">1</span><span class="sc">-</span>ppb.median)<span class="sc">/</span>ppb.median<span class="sc">*</span><span class="dv">2</span>), </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) (<span class="fl">0.95</span><span class="sc">-</span><span class="fu">pbeta</span>(ppb.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="sc">+</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pbeta</span>(ppb.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>      (ppb.median<span class="sc">-</span><span class="fu">qbeta</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We are drawing new values for the unadjusted Fup:</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span><span class="fu">rbeta</span>(<span class="dv">1000</span>,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>      ppb.fit<span class="sc">$</span>par[<span class="dv">1</span>],</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>      ppb.fit<span class="sc">$</span>par[<span class="dv">2</span>])]</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ppb.high95<span class="sc">&gt;</span>minimum.Funbound.plasma)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assume that since the median is zero but the u95 is not, that there is </span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># an exponential distribution:</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 97.5% of clearance values will be below Funbound.plasma.u95:</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[,unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span><span class="fu">runif</span>(<span class="dv">1000</span>,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>      minimum.Funbound.plasma,</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(<span class="dv">1</span>,minimum.Funbound.plasma<span class="sc">+</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="sc">*</span>(ppb.high95<span class="sc">-</span>minimum.Funbound.plasma)))]</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[<span class="fu">as.logical</span>(<span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,.<span class="dv">95</span>)),</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>      unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span>minimum.Funbound.plasma] </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span>minimum.Funbound.plasma]</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co"># then we need to adjust for in vitro binding:</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,Flipid<span class="sc">:</span><span class="er">=</span><span class="fu">subset</span>(physiology.data,</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    Parameter<span class="sc">==</span><span class="st">&#39;Plasma Effective Neutral Lipid Volume Fraction&#39;</span>)[,</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">which</span>(<span class="fu">colnames</span>(physiology.data) <span class="sc">==</span> <span class="st">&#39;Human&#39;</span>)]]</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,Funbound.plasma.adjustment<span class="sc">:</span><span class="er">=</span><span class="dv">1</span> <span class="sc">/</span> (Dow74 <span class="sc">*</span> Flipid <span class="sc">+</span> </span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">/</span> unadjusted.Funbound.plasma)<span class="sc">/</span>unadjusted.Funbound.plasma]</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, </span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    Funbound.plasma<span class="sc">:</span><span class="er">=</span>unadjusted.Funbound.plasma<span class="sc">*</span>Funbound.plasma.adjustment]</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Enforce a minimum ppb:</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[Funbound.plasma<span class="sc">&lt;</span>minimum.Funbound.plasma,</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    Funbound.plasma<span class="sc">:</span><span class="er">=</span>minimum.Funbound.plasma]</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co"># If Fup varies, then Rb2p and hepatic bioavailability also vary:</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>  Rblood2plasma <span class="ot">&lt;-</span> <span class="fu">get_rblood2plasma</span>(<span class="at">chem.cas=</span>chemcas)</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Rblood2plasma)) </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, Rblood2plasma<span class="sc">:</span><span class="er">=</span><span class="fu">calc_rblood2plasma</span>(<span class="at">params=</span>pop_u_httk)]</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Right now we don&#39;t similate variability on a known blood:plasma ratio </span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> pop_u_httk[, Rblood2plasma<span class="sc">:</span><span class="er">=</span>Rblood2plasma] </span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse the clint.dist to retrieve the quantiles:</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>  Clint.dist <span class="ot">&lt;-</span> pop_u_httk[<span class="dv">1</span>,Clint.dist]</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nchar</span>(Clint.dist) <span class="sc">-</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nchar</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Clint.dist))<span class="sc">!=</span><span class="dv">3</span>) </span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Clint distribution should be four values (median,low95th,high95th,pValue) separated by commas.&quot;</span>)</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(Clint.dist,<span class="st">&quot;,&quot;</span>)</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>  Clint.median <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>  Clint.low95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>  Clint.high95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>  Clint.pvalue <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">4</span>])</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use optim to estimate mean and standard deviation of Clint such that the </span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># median and 95% credible interval approximate the estimate from MCMC:</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Clint.high95<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (Clint.median<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>      clint.fit <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="fu">log</span>(Clint.median),<span class="fl">0.3</span>), <span class="cf">function</span>(x) </span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">0.95</span><span class="sc">-</span><span class="fu">plnorm</span>(Clint.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">plnorm</span>(Clint.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>        (Clint.median<span class="sc">-</span><span class="fu">qlnorm</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>      pop_u_httk[,Clint<span class="sc">:</span><span class="er">=</span><span class="fu">rlnorm</span>(<span class="dv">1000</span>,clint.fit<span class="sc">$</span>par[<span class="dv">1</span>],clint.fit<span class="sc">$</span>par[<span class="dv">2</span>])]</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>      pop_u_httk[,Clint<span class="sc">:</span><span class="er">=</span><span class="fu">exp</span>(<span class="fu">runif</span>(<span class="dv">1000</span>,<span class="fu">log</span>(<span class="dv">1</span>),</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">log</span>(Clint.high95)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span>))<span class="sc">/</span><span class="fl">0.975</span>))]</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> pop_u_httk[,Clint<span class="sc">:</span><span class="er">=</span><span class="dv">0</span>]</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[<span class="fu">as.logical</span>(<span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,Clint.pvalue)),Clint<span class="sc">:</span><span class="er">=</span><span class="dv">0</span>] <span class="co"># the Bayesian &quot;p-value&quot; here reflects how often there is no clearance</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, CLh<span class="sc">:</span><span class="er">=</span><span class="fu">calc_hepatic_clearance</span>(<span class="at">chem.cas=</span>chemcas,</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>pop_u_httk,<span class="at">hepatic.model=</span><span class="st">&#39;unscaled&#39;</span>,<span class="at">suppress.messages=</span><span class="cn">TRUE</span>,<span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>)]</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, Qliver<span class="sc">:</span><span class="er">=</span>Qtotal.liverc<span class="sc">*</span>BW<span class="sc">^</span><span class="fl">0.75</span>]</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, hepatic.bioavailability<span class="sc">:</span><span class="er">=</span> Qliver <span class="sc">/</span> (Qliver <span class="sc">+</span> </span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>    Funbound.plasma <span class="sc">*</span> Clint <span class="sc">/</span> Rblood2plasma)]</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, (<span class="fu">setdiff</span>(<span class="fu">names</span>(pop_u_httk), </span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(httk<span class="sc">::</span><span class="fu">parameterize_steadystate</span>(<span class="at">chem.cas=</span>chemcas))))<span class="sc">:</span><span class="er">=</span><span class="cn">NULL</span>]</span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute Css for each individual</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calc_analytic_css is vectorized so that this will work.</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>  css <span class="ot">&lt;-</span> httk<span class="sc">::</span><span class="fu">calc_analytic_css</span>(<span class="at">parameters=</span>pop_u_httk,</span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>,</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.pop.cv=</span><span class="cn">NULL</span>,</span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fup.pop.cv=</span><span class="cn">NULL</span>,</span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">species=</span><span class="st">&quot;Human&quot;</span>,</span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)<span class="co">#,</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>                            <span class="co">#     recalc.blood2plasma=TRUE)</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get Css95</span></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>  cssquants <span class="ot">&lt;-</span> <span class="fu">quantile</span>(css, <span class="at">probs=</span>probs)</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cssquants)</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="this-calculates-the-half-life-using-uncertainty-only" class="section level3">
<h3>This calculates the half-life using uncertainty only:</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>hlfun_u <span class="ot">&lt;-</span> <span class="cf">function</span>(chemcas, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                      MW, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">probs=</span><span class="fl">0.95</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">minimum.Funbound.plasma=</span><span class="fl">0.0001</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data table with uncertainty only:</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chemcas)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  pop_u_httk <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">parameterize_steadystate</span>(<span class="at">chem.cas=</span>chemcas,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">minimum.Funbound.plasma=</span><span class="dv">0</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  params.schmitt <span class="ot">&lt;-</span><span class="fu">parameterize_schmitt</span>(<span class="at">chem.cas=</span>chemcas)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  psd <span class="ot">&lt;-</span> params.schmitt<span class="sc">$</span>pKa_Donor</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  psa <span class="ot">&lt;-</span> params.schmitt<span class="sc">$</span>pKa_Accept</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  params.schmitt <span class="ot">&lt;-</span> params.schmitt[<span class="fu">regexpr</span>(<span class="st">&quot;pKa&quot;</span>,<span class="fu">names</span>(params.schmitt))<span class="sc">==-</span><span class="dv">1</span>]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,<span class="fu">names</span>(params.schmitt)<span class="sc">:</span><span class="er">=</span>params.schmitt]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,pKa_Donor <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(psd, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>)]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,pKa_Accept <span class="sc">:</span><span class="er">=</span> <span class="fu">paste</span>(psa, <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>)]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  pop_u_httk <span class="ot">&lt;-</span> pop_u_httk[<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>)]</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  ions <span class="ot">&lt;-</span> <span class="fu">calc_ionization</span>(<span class="at">pH=</span><span class="fl">7.4</span>,<span class="at">parameters=</span>pop_u_httk)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,Dow74 <span class="sc">:</span><span class="er">=</span> Pow <span class="sc">*</span> (ions<span class="sc">$</span>fraction_neutral <span class="sc">+</span> <span class="fl">0.001</span> <span class="sc">*</span> ions<span class="sc">$</span>fraction_charged <span class="sc">+</span> ions<span class="sc">$</span>fraction_zwitter)]</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse the Funbound.plasma.dist into quantiles:</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  Funbound.plasma.dist <span class="ot">&lt;-</span> pop_u_httk[<span class="dv">1</span>,Funbound.plasma.dist]</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(chemcas,Funbound.plasma.dist))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nchar</span>(Funbound.plasma.dist) <span class="sc">-</span> </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nchar</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Funbound.plasma.dist))<span class="sc">!=</span><span class="dv">2</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Funbound.plasma distribution should be three values (median,low95th,high95th) separated by commas.&quot;</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  ppb.median <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  ppb.low95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  ppb.high95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ppb.median<span class="sc">&gt;</span>minimum.Funbound.plasma)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use optim to estimate alpha and beta for fup such that the median and 95% </span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># credible interval approximate the estimate from MCMC:</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    ppb.fit <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">2</span>,(<span class="dv">1</span><span class="sc">-</span>ppb.median)<span class="sc">/</span>ppb.median<span class="sc">*</span><span class="dv">2</span>), </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) (<span class="fl">0.95</span><span class="sc">-</span><span class="fu">pbeta</span>(ppb.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="sc">+</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pbeta</span>(ppb.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>      (ppb.median<span class="sc">-</span><span class="fu">qbeta</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We are drawing new values for the unadjusted Fup:</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span><span class="fu">rbeta</span>(<span class="dv">1000</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>      ppb.fit<span class="sc">$</span>par[<span class="dv">1</span>],</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>      ppb.fit<span class="sc">$</span>par[<span class="dv">2</span>])]</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ppb.high95<span class="sc">&gt;</span>minimum.Funbound.plasma)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assume that since the median is zero but the u95 is not, that there is </span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># an exponential distribution:</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 97.5% of clearance values will be below Funbound.plasma.u95:</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span><span class="fu">runif</span>(<span class="dv">1000</span>,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>      minimum.Funbound.plasma,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(<span class="dv">1</span>,(ppb.high95<span class="sc">-</span>minimum.Funbound.plasma)<span class="sc">/</span><span class="fl">0.975</span>))]</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[<span class="fu">as.logical</span>(<span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,.<span class="dv">975</span>)),</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>      unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span>minimum.Funbound.plasma]</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, unadjusted.Funbound.plasma<span class="sc">:</span><span class="er">=</span>minimum.Funbound.plasma]</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="co"># then we need to adjust for in vitro binding:</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,Flipid<span class="sc">:</span><span class="er">=</span><span class="fu">subset</span>(physiology.data,</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    Parameter<span class="sc">==</span><span class="st">&#39;Plasma Effective Neutral Lipid Volume Fraction&#39;</span>)[,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">which</span>(<span class="fu">colnames</span>(physiology.data) <span class="sc">==</span> <span class="st">&#39;Human&#39;</span>)]]</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,Funbound.plasma.adjustment<span class="sc">:</span><span class="er">=</span><span class="dv">1</span> <span class="sc">/</span> (Dow74 <span class="sc">*</span> Flipid <span class="sc">+</span> </span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">/</span> unadjusted.Funbound.plasma)<span class="sc">/</span>unadjusted.Funbound.plasma]</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>    Funbound.plasma<span class="sc">:</span><span class="er">=</span>unadjusted.Funbound.plasma<span class="sc">*</span>Funbound.plasma.adjustment]</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Enforce a minimum ppb:</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[Funbound.plasma<span class="sc">&lt;</span>minimum.Funbound.plasma,</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    Funbound.plasma<span class="sc">:</span><span class="er">=</span>minimum.Funbound.plasma]</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>  Rblood2plasma <span class="ot">&lt;-</span> <span class="fu">get_rblood2plasma</span>(<span class="at">chem.cas=</span>chemcas)</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Rblood2plasma)) </span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    pop_u_httk[, Rblood2plasma<span class="sc">:</span><span class="er">=</span><span class="fu">calc_rblood2plasma</span>(<span class="at">params=</span>pop_u_httk)]</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> pop_u_httk[, Rblood2plasma<span class="sc">:</span><span class="er">=</span>Rblood2plasma] <span class="co"># Right now we don&#39;t similate variability on a known blood:plasma ratio </span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parse the clint.dist to retrieve the quantiles:</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>  Clint.dist <span class="ot">&lt;-</span> pop_u_httk[<span class="dv">1</span>,Clint.dist]</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nchar</span>(Clint.dist) <span class="sc">-</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nchar</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Clint.dist))<span class="sc">!=</span><span class="dv">3</span>) </span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Clint distribution should be four values (median,low95th,high95th,pValue) separated by commas.&quot;</span>)</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(Clint.dist,<span class="st">&quot;,&quot;</span>)</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>  Clint.median <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>  Clint.low95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>  Clint.high95 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>  Clint.pvalue <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">4</span>])</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use optim to estimate mean and standard deviation of Clint such that the </span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># median and 95% credible interval approximate the estimate from MCMC:</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (Clint.high95<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (Clint.median<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>      clint.fit <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="fu">log</span>(Clint.median),<span class="fl">0.3</span>), <span class="cf">function</span>(x) </span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>        (<span class="fl">0.95</span><span class="sc">-</span><span class="fu">plnorm</span>(Clint.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="sc">+</span><span class="fu">plnorm</span>(Clint.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>        (Clint.median<span class="sc">-</span><span class="fu">qlnorm</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>      pop_u_httk[,Clint<span class="sc">:</span><span class="er">=</span><span class="fu">rlnorm</span>(<span class="dv">1000</span>,clint.fit<span class="sc">$</span>par[<span class="dv">1</span>],clint.fit<span class="sc">$</span>par[<span class="dv">2</span>])]</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>      pop_u_httk[,Clint<span class="sc">:</span><span class="er">=</span><span class="fu">exp</span>(<span class="fu">runif</span>(<span class="dv">1000</span>,<span class="fu">log</span>(<span class="dv">1</span>),</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">log</span>(Clint.high95)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span>))<span class="sc">/</span><span class="fl">0.975</span>))]</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> pop_u_httk[,Clint<span class="sc">:</span><span class="er">=</span><span class="dv">0</span>]</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[<span class="fu">as.logical</span>(<span class="fu">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,Clint.pvalue)),Clint<span class="sc">:</span><span class="er">=</span><span class="dv">0</span>] <span class="co"># the Bayesian &quot;p-value&quot; here reflects how often there is no clearance</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, CLh<span class="sc">:</span><span class="er">=</span><span class="fu">calc_hepatic_clearance</span>(<span class="at">chem.cas=</span>chemcas,<span class="at">parameters=</span>pop_u_httk,<span class="at">hepatic.model=</span><span class="st">&#39;unscaled&#39;</span>,<span class="at">suppress.messages=</span><span class="cn">TRUE</span>,<span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>)]</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, Qliver<span class="sc">:</span><span class="er">=</span>Qtotal.liverc<span class="sc">*</span>BW<span class="sc">^</span><span class="fl">0.75</span>]</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[, hepatic.bioavailability<span class="sc">:</span><span class="er">=</span> Qliver <span class="sc">/</span> (Qliver <span class="sc">+</span> Funbound.plasma <span class="sc">*</span> Clint <span class="sc">/</span> Rblood2plasma)]</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>  PC.names <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">predict_partitioning_schmitt</span>(<span class="at">chem.cas=</span><span class="st">&quot;80-05-7&quot;</span>))</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>  pop_u_httk<span class="ot">&lt;-</span><span class="fu">cbind</span>(pop_u_httk,<span class="fu">as.data.table</span>(<span class="fu">predict_partitioning_schmitt</span>(<span class="at">parameters=</span>pop_u_httk)))</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>  pop_u_httk[,hl<span class="sc">:</span><span class="er">=</span><span class="fu">calc_elimination_rate</span>(<span class="at">parameters=</span>pop_u_httk)]</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="fu">quantile</span>(<span class="fu">unlist</span>(pop_u_httk[,<span class="st">&quot;hl&quot;</span>,<span class="at">with=</span><span class="cn">FALSE</span>]),<span class="at">probs=</span>probs))</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="figure-1-histograms-depicting-the-measured-values" class="section level1">
<h1>Figure 1: Histograms depicting the measured values</h1>
<p>Histograms depicting the median measured values (<strong>a</strong>,
<strong>b</strong>) and 95% credible intervals (<strong>c</strong>,
<strong>d</strong>) for fraction unbound in plasma (<span class="math inline">\(f_{up}\)</span>, <strong>a</strong>,
<strong>c</strong>) and intrinsic hepatic clearance (<span class="math inline">\(Cl_{int}\)</span>, <strong>b</strong>,
<strong>d</strong>). In <strong>panel a</strong>, the distribution of
estimated <span class="math inline">\(f_{up}\)</span> for the single
protein concentration assay (solid line) is compared with the protein
titration (three concentrations) method (dotted) line. In <strong>panel
b</strong>, the median estimated <span class="math inline">\(Cl_{int}\)</span> is shown. In <strong>panel
c</strong>, the distribution with larger credible intervals corresponds
to the single protein concentration assay, with a median credible
interval is 0.1, corresponding to a precision of roughly +-0.05. When
data from the protein titration are jointly analyzed (smaller credible
intervals), the certainty is increased to a median credible interval of
0.029, or roughly +-0.015. The width of the credible interval is a
measure of the certainty in an estimate, that is, a smaller credible
interval indicates greater certainty. For the <span class="math inline">\(f_{up}\)</span> values, a credible interval
approaching 1 indicates that all possible values are consistent with the
data, that is, the data do not help identify fup since fup must be
between 0 and 1. In <strong>panel d</strong> the distribution of
credible intervals for <span class="math inline">\(Cl_{int}\)</span> is
shown.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Fig1.table <span class="ot">&lt;-</span> httk<span class="sc">::</span>wambaugh2019.raw</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Error1 <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>Base.Fup.High <span class="sc">-</span> Fig1.table<span class="sc">$</span>Base.Fup.Low</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Error2 <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>Affinity.Fup.High <span class="sc">-</span> Fig1.table<span class="sc">$</span>Affinity.Fup.Low</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Sigma1 <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>Error1<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Mean1 <span class="ot">&lt;-</span> (Fig1.table<span class="sc">$</span>Base.Fup.High <span class="sc">+</span> Fig1.table<span class="sc">$</span>Base.Fup.Low)<span class="sc">/</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>CV1 <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>Sigma1<span class="sc">/</span>Fig1.table<span class="sc">$</span>Mean1</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Sigma2 <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>Error2<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Mean2 <span class="ot">&lt;-</span> (Fig1.table<span class="sc">$</span>Base.Fup.High <span class="sc">+</span> Fig1.table<span class="sc">$</span>Base.Fup.Low)<span class="sc">/</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>CV2 <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>Sigma2<span class="sc">/</span>Fig1.table<span class="sc">$</span>Mean2</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>ErrorClint <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.High95th <span class="sc">-</span> Fig1.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Low95th</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>SigmaClint <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>ErrorClint<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>MeanClint <span class="ot">&lt;-</span> (Fig1.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.High95th <span class="sc">+</span> Fig1.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Low95th)<span class="sc">/</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>CVClint <span class="ot">&lt;-</span> Fig1.table<span class="sc">$</span>SigmaClint<span class="sc">/</span>Fig1.table<span class="sc">$</span>MeanClint</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>Fupmeasured <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig1.table,<span class="sc">!</span><span class="fu">is.na</span>(Affinity.Fup.Med))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>Fupmeasured <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupmeasured,<span class="sc">!</span><span class="fu">duplicated</span>(CAS))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>CLintmeasured <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig1.table,<span class="sc">!</span><span class="fu">is.na</span>(CLint<span class="fl">.1</span>uM.Median))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>CLintmeasured <span class="ot">&lt;-</span> <span class="fu">subset</span>(CLintmeasured,<span class="sc">!</span><span class="fu">duplicated</span>(CAS))</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;New HTTK experimental measurements were made for&quot;</span>,<span class="fu">length</span>(<span class="fu">unique</span>(Fig1.table<span class="sc">$</span>CAS)),<span class="st">&quot;chemicals from the ToxCast HTS library.&quot;</span>))</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Fup was successfully measured for&quot;</span>,<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">subset</span>(Fig1.table,<span class="sc">!</span><span class="fu">is.na</span>(Affinity.Fup.Med))<span class="sc">$</span>CAS)),<span class="st">&quot;chemicals from the ToxCast HTS library.&quot;</span>))</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;CLint was successfully measured for&quot;</span>,<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">subset</span>(Fig1.table,<span class="sc">!</span><span class="fu">is.na</span>(CLint<span class="fl">.1</span>uM.Median))<span class="sc">$</span>CAS)),<span class="st">&quot;chemicals from the ToxCast HTS library.&quot;</span>))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>Fig1a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Fig1.table)<span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">color=</span><span class="st">&quot;Red&quot;</span>,<span class="fu">aes</span>(Base.Fup.Med))<span class="sc">+</span> </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;Blue&quot;</span>,<span class="fu">aes</span>(Affinity.Fup.Med))<span class="sc">+</span> </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured &quot;</span>,F[up]))) <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>,<span class="fl">1.05</span>))<span class="sc">+</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">subset</span>(Fig1.table,<span class="sc">!</span><span class="fu">is.na</span>(Affinity.Fup.Med))<span class="sc">$</span>CAS)),<span class="st">&quot;Chemicals Measured&quot;</span>))<span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>,<span class="at">y=</span><span class="dv">80</span>,<span class="at">size=</span><span class="dv">8</span>,<span class="at">label=</span><span class="st">&quot;a&quot;</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Median 100%:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>Base.Fup.Med,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>)))</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Median Titration:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>Affinity.Fup.Med,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>)))</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>Fig1b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Fig1.table)<span class="sc">+</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.6</span>,<span class="at">fill=</span><span class="st">&quot;green&quot;</span>,<span class="fu">aes</span>(CLint<span class="fl">.1</span>uM.Median))<span class="sc">+</span>              </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured &quot;</span>,Cl[int],<span class="st">&quot; (uL/min/&quot;</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="st">&quot; hepatocytes)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">subset</span>(Fig1.table,<span class="sc">!</span><span class="fu">is.na</span>(CLint<span class="fl">.1</span>uM.Median))<span class="sc">$</span>CAS)),<span class="st">&quot;Chemicals Measured&quot;</span>))<span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="at">y=</span><span class="dv">80</span>,<span class="at">size=</span><span class="dv">8</span>,<span class="at">label=</span><span class="st">&quot;b&quot;</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(Fig1.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">==</span><span class="dv">0</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="st">&quot;Zero Measurments&quot;</span>))</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Median Non-Zero:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">3</span>)))</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>Fig1c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Fig1.table)<span class="sc">+</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="fu">aes</span>(Error1))<span class="sc">+</span> </span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">fill=</span><span class="st">&quot;Blue&quot;</span>,<span class="fu">aes</span>(Error2))<span class="sc">+</span> </span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Width of Credible Interval&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>,<span class="fl">1.05</span>))<span class="sc">+</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;CI:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>Error1,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CV1,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">1</span>),<span class="st">&quot;/ CI:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>Error2,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">1</span>),<span class="st">&quot;CV:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CV2,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">5</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>,<span class="at">y=</span><span class="dv">42</span>,<span class="at">size=</span><span class="dv">8</span>,<span class="at">label=</span><span class="st">&quot;c&quot;</span>)</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Median 100% CI:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>Error1,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CV1,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>)))    </span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Median Titr. CI:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>Error2,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CV2,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>)))</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>Fig1d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Fig1.table)<span class="sc">+</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>,<span class="at">alpha=</span><span class="fl">0.6</span>,<span class="at">fill=</span><span class="st">&quot;green&quot;</span>,<span class="fu">aes</span>(ErrorClint))<span class="sc">+</span> </span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Width of Credible Interval&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;Median CI:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>ErrorClint,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CVClint,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>)))<span class="sc">+</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="fl">1.5</span>,<span class="at">y=</span><span class="dv">25</span>,<span class="at">size=</span><span class="dv">8</span>,<span class="at">label=</span><span class="st">&quot;d&quot;</span>)</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Median CI:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>ErrorClint,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fig1.table<span class="sc">$</span>CVClint,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>)))</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(Fig1a,Fig1c,Fig1b,Fig1d,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span></code></pre></div>
</div>
<div id="figure-2-distribution-of-binding-affinities-employed-in-bayesian-f_up-estimations." class="section level1">
<h1>Figure 2: Distribution of Binding Affinities Employed in Bayesian
<span class="math inline">\(f_{up}\)</span> Estimations.</h1>
<p>Distribution of Binding Affinities Employed in Bayesian <span class="math inline">\(f_{up}\)</span> Estimations. To jointly analyze
the data from the RED assay conducted at three protein concentrations, a
model for binding to protein with an dissociation constant (that is,
binding affinity) must be assumed. Although the specific binding protein
(for example, hemoglobin) and the stoichiometry are unknown, this number
provides a rough estimate for each chemical of how much that chemical
would be expected to be impacted by the presence of plasma binding.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Fig2.table <span class="ot">&lt;-</span> httk<span class="sc">::</span>wambaugh2019.raw</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Fup.point)),<span class="st">&quot;total successful Fup estimates using point estimation.&quot;</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Base.Fup.Med)),<span class="st">&quot;total successful Fup estimates using BAyesian analysis of top protein concentration.&quot;</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Error1 <span class="ot">&lt;-</span> Fig2.table<span class="sc">$</span>Base.Fup.High <span class="sc">-</span> Fig2.table<span class="sc">$</span>Base.Fup.Low</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Error2 <span class="ot">&lt;-</span> Fig2.table<span class="sc">$</span>Affinity.Fup.High <span class="sc">-</span> Fig2.table<span class="sc">$</span>Affinity.Fup.Low</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Sigma1 <span class="ot">&lt;-</span> Fig2.table<span class="sc">$</span>Error1<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Mean1 <span class="ot">&lt;-</span> (Fig2.table<span class="sc">$</span>Base.Fup.High <span class="sc">+</span> Fig2.table<span class="sc">$</span>Base.Fup.Low)<span class="sc">/</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>CV1 <span class="ot">&lt;-</span> Fig2.table<span class="sc">$</span>Sigma1<span class="sc">/</span>Fig2.table<span class="sc">$</span>Mean1</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Sigma2 <span class="ot">&lt;-</span> Fig2.table<span class="sc">$</span>Error2<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Mean2 <span class="ot">&lt;-</span> (Fig2.table<span class="sc">$</span>Base.Fup.High <span class="sc">+</span> Fig2.table<span class="sc">$</span>Base.Fup.Low)<span class="sc">/</span>(<span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>CV2 <span class="ot">&lt;-</span> Fig2.table<span class="sc">$</span>Sigma2<span class="sc">/</span>Fig2.table<span class="sc">$</span>Mean2</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Point.Estimate <span class="ot">&lt;-</span> <span class="st">&quot;Good&quot;</span>                          </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>Fup.point<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Fup.point),<span class="st">&quot;Point.Estimate&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;&lt;0&quot;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>Fup.point<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Fup.point),<span class="st">&quot;Point.Estimate&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;&gt;1&quot;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Fup.point),<span class="st">&quot;Point.Estimate&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;No Value&quot;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>Point.Estimate<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;&lt;0&quot;</span>,<span class="st">&quot;No Value&quot;</span>),<span class="st">&quot;Fup.point&quot;</span>] <span class="ot">&lt;-</span>  Fig2.table[Fig2.table<span class="sc">$</span>Point.Estimate<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;&lt;0&quot;</span>,<span class="st">&quot;No Value&quot;</span>),<span class="st">&quot;Base.Fup.Med&quot;</span>]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Uncertain<span class="ot">&lt;-</span><span class="st">&quot;Yes&quot;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>CV1),<span class="st">&quot;CV1&quot;</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">999</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>CV1<span class="sc">&lt;</span><span class="fl">0.49</span>,<span class="st">&quot;Uncertain&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;No&quot;</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>CV1<span class="sc">==-</span><span class="dv">999</span>,<span class="st">&quot;CV1&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>Fig2a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Base.Fup.Med)),<span class="fu">aes</span>(<span class="at">x=</span>Fup.point,<span class="at">y=</span>Base.Fup.Med,<span class="at">shape=</span>Point.Estimate,<span class="at">alpha=</span>Uncertain,<span class="at">colour=</span>Point.Estimate)) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#         geom_errorbar(aes(ymax = Base.Fup.High, ymin=Base.Fup.Low))+</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(F[up],<span class="st">&quot; Bayesian Analysis (Single Conc.)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(F[up],<span class="st">&quot; Point Estimate (Traditional Analysis)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">colour=</span><span class="st">&quot;Blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_vline(xintercept = 1, size=2,linetype=&quot;dashed&quot;, colour=&quot;red&quot;)+</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.01</span>, <span class="at">size=</span><span class="dv">2</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.01</span>, <span class="at">size=</span><span class="dv">2</span>,<span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">name=</span><span class="st">&quot;Point Estimate&quot;</span>)<span class="sc">+</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_discrete</span>(<span class="at">name=</span><span class="st">&quot;Point Estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>     <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">6</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">label =</span> <span class="st">&quot;a&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">alpha=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Fig2a)</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(Fig2.table<span class="sc">$</span>Uncertain<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>),<span class="st">&quot;uncertain estimates using single conc.&quot;</span>))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(Fig2.table<span class="sc">$</span>Point.Estimate<span class="sc">==</span><span class="st">&quot;&lt;0&quot;</span>),<span class="st">&quot;chemicals with negative point estimates.&quot;</span>))</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(Fig2.table<span class="sc">$</span>Point.Estimate<span class="sc">==</span><span class="st">&quot;&gt;1&quot;</span>),<span class="st">&quot;chemicals with Fup &gt; 1.&quot;</span>))</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Fup.point)<span class="sc">&amp;</span>Fup.point<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;</span>Base.Fup.Med<span class="sc">&gt;</span><span class="dv">0</span>),<span class="fu">log</span>(Fup.point)<span class="sc">~</span><span class="fu">log</span>(Base.Fup.Med)))</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>Uncertain2<span class="ot">&lt;-</span><span class="st">&quot;Yes&quot;</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>CV2),<span class="st">&quot;CV2&quot;</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">999</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>CV2<span class="sc">&lt;</span><span class="fl">0.49</span>,<span class="st">&quot;Uncertain2&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;No&quot;</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>CV2<span class="sc">==-</span><span class="dv">999</span>,<span class="st">&quot;CV2&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>Fig2.table<span class="sc">$</span>TopFail <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="sc">!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Affinity.Fup.Med)<span class="sc">&amp;</span>Fig2.table<span class="sc">$</span>Uncertain2<span class="sc">==</span><span class="st">&quot;No&quot;</span>,<span class="st">&quot;TopFail&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;No&quot;</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>Fig2.table[Fig2.table<span class="sc">$</span>TopFail<span class="sc">==</span><span class="st">&quot;No&quot;</span><span class="sc">&amp;!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Base.Fup.Med)<span class="sc">&amp;</span>Fig2.table<span class="sc">$</span>Uncertain<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;TopFail&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;Single Conc. Only&quot;</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="sc">!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Affinity.Fup.Med)<span class="sc">&amp;</span>Fig2.table<span class="sc">$</span>Uncertain2<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;TopFail&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;Yes&quot;</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="sc">!</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Affinity.Fup.Med)<span class="sc">&amp;</span><span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Base.Fup.Med),<span class="st">&quot;TopFail&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Single Conc. Only&quot;</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>Fig2.table[<span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Base.Fup.Med),<span class="st">&quot;Base.Fup.Med&quot;</span>] <span class="ot">&lt;-</span>  Fig2.table[<span class="fu">is.na</span>(Fig2.table<span class="sc">$</span>Base.Fup.Med),<span class="st">&quot;Affinity.Fup.Med&quot;</span>]</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>Fig2b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Affinity.Fup.Med)),<span class="fu">aes</span>(<span class="at">x=</span>Base.Fup.Med,<span class="at">y=</span>Affinity.Fup.Med,<span class="at">shape=</span>TopFail,<span class="at">alpha=</span>TopFail,<span class="at">colour=</span>TopFail)) <span class="sc">+</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">subset</span>(Fig2.table,TopFail<span class="sc">==</span><span class="st">&quot;No&quot;</span>),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="co">#         geom_errorbar(aes(ymax = Fup.High.x, ymin=Fup.Low.x))+</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co">#         geom_errorbarh(aes(xmin=Fup.Low.y,xmax=Fup.High.y))+</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(F[up],<span class="st">&quot; Bayesian Analysis (Single Conc.)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(F[up],<span class="st">&quot; Bayesian Analysis (Three Conc.)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">colour=</span><span class="st">&quot;Blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">name=</span><span class="st">&quot;Uncertain&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name=</span><span class="st">&quot;Uncertain&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="co">#    annotate(&quot;text&quot;,size=8, x = 10^-4, y = 1, label = &quot;B&quot;)+</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_alpha_manual</span>(<span class="at">name=</span><span class="st">&quot;Uncertain&quot;</span>,<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.6</span>,<span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">label =</span> <span class="st">&quot;b&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">alpha=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>),<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Fig2b)</span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to reduce to unique chemicals.</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>Fupbaseworked <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Base.Fup.Med)<span class="sc">&amp;</span>Uncertain<span class="sc">==</span><span class="st">&quot;No&quot;</span>)</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>Fupbasenot <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Base.Fup.Med)<span class="sc">&amp;</span>Uncertain<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>)</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>Fupbaseworked <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupbaseworked,<span class="sc">!</span><span class="fu">duplicated</span>(CAS))</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>Fupbasenot <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupbasenot,<span class="sc">!</span><span class="fu">duplicated</span>(CAS))</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Also need to count a chemical as a success if it worked for either duplicate:</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>Fupbasenot <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupbasenot,<span class="sc">!</span>(CAS<span class="sc">%in%</span>Fupbaseworked<span class="sc">$</span>CAS))</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>Fupaffinityworked <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Affinity.Fup.Med)<span class="sc">&amp;</span>Uncertain2<span class="sc">==</span><span class="st">&quot;No&quot;</span>)</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>Fupaffinitynot <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Affinity.Fup.Med)<span class="sc">&amp;</span>Uncertain2<span class="sc">==</span><span class="st">&quot;Yes&quot;</span>)</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>Fupaffinityworked <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupaffinityworked,<span class="sc">!</span><span class="fu">duplicated</span>(CAS))</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>Fupaffinitynot <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupaffinitynot,<span class="sc">!</span><span class="fu">duplicated</span>(CAS))</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>Fupaffinitynot <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fupaffinitynot,<span class="sc">!</span>(CAS<span class="sc">%in%</span>Fupaffinityworked<span class="sc">$</span>CAS))</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">dim</span>(Fupbaseworked)[<span class="dv">1</span>],<span class="st">&quot;total successful Fup estimates using single conc.&quot;</span>))</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">signif</span>(<span class="fu">dim</span>(Fupbasenot)[<span class="dv">1</span>]<span class="sc">/</span>(<span class="fu">dim</span>(Fupbaseworked)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">dim</span>(Fupbasenot)[<span class="dv">1</span>])<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;percent failure rate using single conc.&quot;</span>))</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">dim</span>(Fupaffinityworked)[<span class="dv">1</span>],<span class="st">&quot;total successful Fup estimates using protein titration.&quot;</span>))</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">signif</span>(<span class="fu">dim</span>(Fupaffinitynot)[<span class="dv">1</span>]<span class="sc">/</span>(<span class="fu">dim</span>(Fupaffinityworked)[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">dim</span>(Fupaffinitynot)[<span class="dv">1</span>])<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;percent failure rate using protein titration.&quot;</span>))</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">dim</span>(Fupbasenot)[<span class="dv">1</span>],<span class="st">&quot;uncertain estimates using original protocol.&quot;</span>))</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">dim</span>(Fupaffinitynot)[<span class="dv">1</span>],<span class="st">&quot;uncertain estimates using protein titration.&quot;</span>))</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">dim</span>(Fupaffinityworked)[<span class="dv">1</span>]<span class="sc">-</span><span class="fu">dim</span>(Fupbaseworked)[<span class="dv">1</span>],<span class="st">&quot;chemicals that could not be measured at 100% plasma protein.&quot;</span>))</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>Wetmore.data <span class="ot">&lt;-</span> httk<span class="sc">:::</span>Wetmore.data</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>W2015 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Wetmore.data,Reference<span class="sc">==</span><span class="st">&quot;Wetmore 2015&quot;</span>)</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>W2012 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Wetmore.data,Reference<span class="sc">==</span><span class="st">&quot;Wetmore 2012&quot;</span>)</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The Fup assay failed for &quot;</span>,<span class="fu">signif</span>(<span class="fu">sum</span>(W2012<span class="sc">$</span>Fub<span class="sc">==</span><span class="fl">0.005</span>)<span class="sc">/</span><span class="fu">length</span>(W2012<span class="sc">$</span>Fub)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;% of chemicals in {Wetmore, 2012} and &quot;</span>,<span class="fu">signif</span>(<span class="fu">sum</span>(W2015<span class="sc">$</span>Fub<span class="sc">==</span><span class="dv">0</span>)<span class="sc">/</span><span class="fu">length</span>(W2015<span class="sc">$</span>Fub)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;% of chemicals in {Wetmore, 2015}.&quot;</span>))</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>Fuplod <span class="ot">&lt;-</span> <span class="fu">subset</span>(Fig2.table,TopFail<span class="sc">==</span><span class="st">&quot;Single Conc. Only&quot;</span>)</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Among the chemicals that were uncertain using the original protocol but could be measured using the new three concentration protocol, the median estimated Fup was &quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(Fuplod<span class="sc">$</span>Affinity.Fup.Med),<span class="dv">2</span>),<span class="st">&quot;with values as low as &quot;</span>,<span class="fu">signif</span>(<span class="fu">min</span>(Fuplod<span class="sc">$</span>Affinity.Fup.Med),<span class="dv">2</span>),<span class="st">&quot;and as high as&quot;</span>,<span class="fu">signif</span>(<span class="fu">max</span>(Fuplod<span class="sc">$</span>Affinity.Fup.Med),<span class="dv">2</span>),<span class="st">&quot;. Previously, a default of 0.005 has been assumed when Fup could not be measured {Rotroff, 2010}.}&quot;</span>))</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(Fig2.table,<span class="sc">!</span><span class="fu">is.na</span>(Base.Fup.Med)<span class="sc">&amp;</span>Affinity.Fup.Med<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;</span>Base.Fup.Med<span class="sc">&gt;</span><span class="dv">0</span>),<span class="fu">log</span>(Base.Fup.Med)<span class="sc">~</span><span class="fu">log</span>(Affinity.Fup.Med)))</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(Fig2a,Fig2b,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span></code></pre></div>
</div>
<div id="figure-3-comparison-of-bayesian-f_up-and-uncertainty-estimations-to-experimental-point" class="section level1">
<h1>Figure 3: Comparison of Bayesian <span class="math inline">\(f_{up}\)</span> and Uncertainty Estimations to
Experimental Point</h1>
<p>Estimates. Two separate Bayesian analyses were performed: one
including only those data collected at 100% PPP, and a second that used
a binding model to relate data collected at 10%, 30%, and 100% PPP. In
(<strong>A</strong>), <span class="math inline">\(f_{up}\)</span> point
estimates &lt;0 are plotted on the y-axis. These values are considered
“good” if they lie between 0 and 1. The Bayesian median fup values
(x-axis) derived from the 100% PPP data and the associated uncertainty
estimates (vertical lines) were correlated with point estimates.
Bayesian model estimates were constrained to be greater than zero and
less than 1;. The red dotted line (at 1%) represents a previously
assumed generic limit of quantification (<a href="https://doi.org/10.1093/toxsci/kfv171">Wetmore, 2015</a>; <a href="https://doi.org/10.1093/toxsci/kfr254">Wetmore, 2012</a>).<br />
In (<strong>B</strong>), the medians from the two Bayesian analyses are
compared. In both plots, the diagonal dashed line indicates the identity
line (“perfect predictions”). In both panels the Bayesian estimates are
“uncertain” (semi-solid) if the CV was larger than 0.5 and certain
(solid) otherwise.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Class <span class="ot">&lt;-</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Fig1.table[Fig1.table<span class="sc">$</span>DTXSID <span class="sc">%in%</span> pharma<span class="sc">$</span>DTXSID,<span class="st">&quot;Class&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;Pharmaceutical&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Fig1.table<span class="sc">$</span>Class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Fig1.table<span class="sc">$</span>Class)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  Fig3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Fig1.table,<span class="fu">aes</span>(Affinity.Kd.Med,<span class="at">fill=</span>Class))<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Binding Affinity (&quot;</span>, mu,<span class="st">&quot;M)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_discrete</span>(<span class="at">name=</span><span class="st">&quot;Chemical Class&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a> <span class="co"># dev.new()</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(Fig3)</span></code></pre></div>
</div>
<div id="figure-4-comparison-of-bayesian-cl_int-and-uncertainty-estimations-to-experimental-point-estimates." class="section level1">
<h1>Figure 4: Comparison of Bayesian <span class="math inline">\(Cl_{int}\)</span> and Uncertainty Estimations to
Experimental Point Estimates.</h1>
<p><span class="math inline">\(Cl_{int}\)</span> estimate for 1 uM
chemical concentration displayed, though 1 and 10 uM were fit jointly.
The size of the credible interval varies significantly from chemical to
chemical, especially for the lower clearance rates. Plots of individual
fits are provided as supplemental material
<!-- (https://doi.org/10.5061/dryad.nf40jb4) -->.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>clearance.table <span class="ot">&lt;-</span> <span class="fu">subset</span>(httk<span class="sc">::</span>wambaugh2019.raw,<span class="sc">!</span><span class="fu">is.na</span>(CLint<span class="fl">.1</span>uM.Median))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">==</span><span class="dv">0</span>),<span class="st">&quot;zero valued median Bayesian posteriors&quot;</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point<span class="sc">==</span><span class="dv">0</span><span class="sc">&amp;</span>clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="st">&quot;zero valued point estimates where median posterior&gt;0&quot;</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;</span>clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">==</span><span class="dv">0</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="st">&quot;zero valued median Bayesian posteriors where point estimate was non-zero&quot;</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point)<span class="sc">&amp;</span>clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">==</span><span class="dv">0</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="st">&quot;zero valued median Bayesian posteriors where point estimate was NA&quot;</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point)<span class="sc">&amp;</span>clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="st">&quot;non-zero valued median Bayesian posteriors where point estimate was NA&quot;</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>clearance.table<span class="sc">$</span>Fit <span class="ot">&lt;-</span> <span class="st">&quot;Decreasing&quot;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median <span class="sc">==</span> <span class="dv">0</span>,<span class="st">&quot;Fit&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Median Zero&quot;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#clearance.table[is.na(clearance.table$CLint.1uM.Point == 0),&quot;Fit&quot;] &lt;- &quot;Point Est. Missing&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(clearance.table)[<span class="dv">1</span>])</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(clearance.table[i,<span class="st">&quot;CLint.1uM.Point&quot;</span>]))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (clearance.table[i,<span class="st">&quot;CLint.1uM.Point&quot;</span>] <span class="sc">==</span> <span class="dv">0</span>) clearance.table[i,<span class="st">&quot;Fit&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Point Est. Zero&quot;</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> clearance.table[i,<span class="st">&quot;Fit&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Point Est. Failed&quot;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>clearance.table[<span class="fu">is.na</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point),<span class="st">&quot;CLint.1uM.Point&quot;</span>]<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point)),<span class="fl">0.1</span>,<span class="fl">0.2</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.Point&quot;</span>]<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="fu">sum</span>(clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Point<span class="sc">==</span><span class="dv">0</span>),<span class="fl">0.3</span>,<span class="fl">0.8</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Low95th<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.Low95th&quot;</span>]<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Median<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.Median&quot;</span>]<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.High95th<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.High95th&quot;</span>]<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.High95th<span class="sc">&gt;</span><span class="dv">1000</span>,<span class="st">&quot;CLint.1uM.High95th&quot;</span>]<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>clearance.table[clearance.table<span class="sc">$</span>CLint<span class="fl">.1</span>uM.Low95th<span class="sc">&lt;</span><span class="fl">0.1</span>,<span class="st">&quot;CLint.1uM.Low95th&quot;</span>]<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>clearance.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log10</span>(CLint<span class="fl">.1</span>uM.Median)<span class="sc">~</span><span class="fu">log10</span>(CLint<span class="fl">.1</span>uM.Point),<span class="at">data=</span><span class="fu">subset</span>(clearance.table,<span class="sc">!</span><span class="fu">is.na</span>(CLint<span class="fl">.1</span>uM.Point)<span class="sc">&amp;</span>CLint<span class="fl">.1</span>uM.Point<span class="sc">&gt;</span><span class="dv">1</span>))</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>Fig4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(clearance.table, <span class="fu">aes</span>(<span class="at">x=</span>CLint<span class="fl">.1</span>uM.Point,<span class="at">y=</span>CLint<span class="fl">.1</span>uM.Median,<span class="at">colour=</span>Fit)) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>CLint<span class="fl">.1</span>uM.Point,<span class="at">xend=</span>CLint<span class="fl">.1</span>uM.Point,<span class="at">y=</span>CLint<span class="fl">.1</span>uM.Low95th,<span class="at">yend=</span>CLint<span class="fl">.1</span>uM.High95th),<span class="at">size=</span><span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">1000</span>)) <span class="sc">+</span> </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10_skip,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(CL[int],<span class="st">&quot; (&quot;</span>,mu,<span class="st">&quot;L/min/&quot;</span>,<span class="dv">10</span><span class="sc">^</span>{<span class="dv">6</span>},<span class="st">&quot; Hep.) Point Estimate&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))<span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(CL[int],<span class="st">&quot; (&quot;</span>,mu,<span class="st">&quot;L/min/&quot;</span>,<span class="dv">10</span><span class="sc">^</span>{<span class="dv">6</span>},<span class="st">&quot; Hep.) Bayesian&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))<span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.25</span>, <span class="at">size=</span><span class="dv">2</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.9</span>, <span class="at">size=</span><span class="dv">2</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">name=</span><span class="st">&quot;Assay Result&quot;</span>)<span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>,<span class="at">size=</span><span class="dv">6</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(clearance.fit,<span class="at">prefix=</span><span class="st">&quot;&quot;</span>),<span class="at">parse=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new()</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Fig4)  </span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(clearance.fit)</span></code></pre></div>
</div>
<div id="figure-5-uncertainty-assessment-for-tk-quantities-half-life-and-c_ss." class="section level1">
<h1>Figure 5: Uncertainty Assessment for TK Quantities half-life and
<span class="math inline">\(C_{ss}\)</span>.</h1>
<p>The impact of uncertainty on estimated values for <span class="math inline">\(f_{up}\)</span> and <span class="math inline">\(Cl_{int}\)</span> could in turn affect additional
TK quantities, for example elimination half-life (<span class="math inline">\(t_{1/2}\)</span>, shown in <strong>panel
A</strong>) and steady-state serum concentration (<span class="math inline">\(C_{ss}\)</span>, shown in <strong>panel
B</strong>). In both plots, the x-axis indicates the value that would
have been estimated with previous methods, while the y-axis indicates
the median and 95% credible interval for values calculated with our
Bayesian method. Chemicals plotted with triangles are those that could
be estimated with the previous, point estimate methods, while chemicals
plotted with circles could not. The dashed line indicates the identity
(perfect predictor) line. Chemicals that had no point estimate are
plotted on the identity line.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section takes a long time because calc_vdist is not yet data.table compatible:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ceetox <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">subset</span>(httk<span class="sc">::</span>wambaugh2019,<span class="sc">!</span><span class="fu">is.na</span>(Human.Funbound.plasma)<span class="sc">&amp;!</span><span class="fu">is.na</span>(Human.Clint)<span class="sc">&amp;!</span><span class="fu">is.na</span>(logP)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>httk_cas <span class="ot">&lt;-</span> ceetox<span class="sc">$</span>CAS[ceetox<span class="sc">$</span>CAS <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>)]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># back up chem.physical_and_invtro.data:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>HTTK.data <span class="ot">&lt;-</span> chem.physical_and_invitro.data</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the point estimates:</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>chem.physical_and_invitro.data <span class="ot">&lt;-</span> <span class="fu">add_chemtable</span>(httk<span class="sc">::</span>wambaugh2019.raw,<span class="at">current.table=</span>chem.physical_and_invitro.data,<span class="at">data.list=</span><span class="fu">list</span>(<span class="at">Compound=</span><span class="st">&quot;Name&quot;</span>,<span class="at">CAS=</span><span class="st">&quot;CAS&quot;</span>,<span class="at">Clint=</span><span class="st">&quot;CLint.1uM.Point&quot;</span>,<span class="at">Funbound.plasma=</span><span class="st">&quot;Fup.point&quot;</span>),<span class="at">reference=</span><span class="st">&quot;Wambaugh 2019&quot;</span>,<span class="at">species=</span><span class="st">&quot;Human&quot;</span>,<span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>schmitt_cas <span class="ot">&lt;-</span> httk_cas[httk_cas <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&quot;schmitt&quot;</span>)]       </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>schmitt_cas,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>       hlpoint<span class="sc">:</span><span class="er">=</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span>httk<span class="sc">::</span><span class="fu">calc_elimination_rate</span>(<span class="at">chem.cas=</span>CAS),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>chem.physical_and_invitro.data <span class="ot">&lt;-</span> HTTK.data</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>schmitt_cas,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>       hl_975<span class="sc">:</span><span class="er">=</span><span class="fu">hlfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MW=</span>MW,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">probs=</span><span class="fl">0.975</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>schmitt_cas,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>       hl_med<span class="sc">:</span><span class="er">=</span><span class="fu">hlfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MW=</span>MW,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">probs=</span><span class="fl">0.5</span>),</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>schmitt_cas,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>       hl_25<span class="sc">:</span><span class="er">=</span><span class="fu">hlfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MW=</span>MW,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">probs=</span><span class="fl">0.025</span>),</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>ceetox[,hlpointEstimated<span class="sc">:</span><span class="er">=</span><span class="cn">TRUE</span>]</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>ceetox[<span class="fu">is.na</span>(hlpoint),hlpointEstimated<span class="sc">:</span><span class="er">=</span><span class="cn">FALSE</span>]</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>ceetox[<span class="fu">is.na</span>(hlpoint),hlpoint<span class="sc">:</span><span class="er">=</span>hl_med]</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>hlfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(ceetox,hlpointEstimated),<span class="fu">log10</span>(hlpoint)<span class="sc">~</span><span class="fu">log10</span>(hl_med))</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>Fig5a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(ceetox,hlpointEstimated),<span class="fu">aes</span>(<span class="at">x=</span>hlpoint,<span class="at">y=</span>hl_med)) <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> hl_975, <span class="at">ymin=</span>hl_25),<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;half-life (h) Point Estimate&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Bayesian half-life (h)&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">3</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>,<span class="at">size=</span><span class="dv">5</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(hlfit,<span class="at">prefix=</span><span class="st">&quot;&quot;</span>),<span class="at">parse=</span><span class="cn">TRUE</span>) </span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>cssfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>ceetox,<span class="fu">log10</span>(cssmed)<span class="sc">~</span><span class="fu">log10</span>(cssmed_u))</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>Fig5b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ceetox,<span class="fu">aes</span>(<span class="at">x=</span>cssmed,<span class="at">y=</span>cssmed_u)) <span class="sc">+</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>css25_u,<span class="at">ymax=</span>css975_u),<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(C[ss],<span class="st">&quot; Point Estimate (uM)&quot;</span>)))<span class="sc">+</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Bayesian &quot;</span>,C[ss],<span class="st">&quot; (uM)&quot;</span>)))<span class="sc">+</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>)) <span class="sc">+</span></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">5</span>, <span class="at">label =</span> <span class="fu">lm_R2</span>(cssfit,<span class="at">prefix=</span><span class="st">&quot;&quot;</span>),<span class="at">parse=</span><span class="cn">TRUE</span>)  </span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=8,height=5)</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(Fig5a,Fig5b,<span class="at">cols=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</span></code></pre></div>
</div>
<div id="figure-6-relative-contributions-of-uncertainty-and-variability" class="section level1">
<h1>Figure 6: Relative contributions of uncertainty and variability</h1>
<p>Here we examine the telative contributions of uncertainty and
variability to differences between the 95th percentile and median <span class="math inline">\(C_{ss}\)</span>. Monte Carlo analysis of both
variability (triangles) and uncertainty (circles) give distributions
that can be characterized by a 95th percentile <span class="math inline">\(C_{ss}\)</span> for which individuals achieve a
higher <span class="math inline">\(C_{ss}\)</span> for the same fixed
dose rate – these individuals can be considered more “sensitive” to
chemical exposure. Uncertainty and variability can be combined (squares)
to estimate a 95th percentile reflecting both factors. For most
chemicals, variability contributes more than uncertainty to the
difference between the <span class="math inline">\(C_{ss}\)</span>
predicted for the median <span class="math inline">\(Cl_{int}\)</span>
and <span class="math inline">\(f_{up}\)</span> values.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>       css95_uv<span class="sc">:</span><span class="er">=</span><span class="fu">calc_mc_css</span>(<span class="at">chem.cas=</span>CAS,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>, <span class="co">#Don&#39;t need to use p-values here (Bayesian)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">species=</span><span class="st">&quot;Human&quot;</span>),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas,    </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>       css95_v<span class="sc">:</span><span class="er">=</span><span class="fu">calc_mc_css</span>(<span class="at">chem.cas=</span>CAS,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>, <span class="co">#Don&#39;t need to use p-values here (Bayesian)</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.meas.cv=</span><span class="cn">NULL</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fup.meas.cv=</span><span class="cn">NULL</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.pop.cv=</span><span class="fl">0.3</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fup.pop.cv=</span><span class="fl">0.3</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">species=</span><span class="st">&quot;Human&quot;</span>),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas, </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>       css95_u<span class="sc">:</span><span class="er">=</span><span class="fu">cssfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MW=</span>MW),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas, </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>       cssmed_u<span class="sc">:</span><span class="er">=</span><span class="fu">cssfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MW=</span>MW,</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>                          <span class="at">probs=</span><span class="fl">0.5</span>),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)       </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas, </span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>       css25_u<span class="sc">:</span><span class="er">=</span><span class="fu">cssfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MW=</span>MW,</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>                          <span class="at">probs=</span><span class="fl">0.025</span>),</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)       </span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas, </span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>       css975_u<span class="sc">:</span><span class="er">=</span><span class="fu">cssfun_u</span>(<span class="at">chemcas=</span>CAS, </span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MW=</span>MW,</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">probs=</span><span class="fl">0.975</span>),</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>ceetox[CAS<span class="sc">%in%</span>httk_cas, </span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>       cssmed<span class="sc">:</span><span class="er">=</span>httk<span class="sc">::</span><span class="fu">calc_analytic_css</span>(<span class="at">chem.cas=</span>CAS,</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">clint.pvalue.threshold=</span><span class="dv">1</span>,</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">species=</span><span class="st">&quot;Human&quot;</span>,</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">suppress.messages=</span><span class="cn">TRUE</span>),</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>       by<span class="ot">=</span>.(CAS)]</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Go back to Bayes estimates:</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>chem.physical_and_invitro.data <span class="ot">&lt;-</span> HTTK.data</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>dt_melt <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">melt</span>(ceetox[, .(Compound, CAS, css95_u, css95_v, css95_uv, cssmed)],</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>                            <span class="at">id.vars=</span><span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>, <span class="st">&quot;cssmed&quot;</span>),</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>                            <span class="at">variable.name=</span><span class="st">&quot;type&quot;</span>,</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>                            <span class="at">value.name=</span><span class="st">&quot;css95&quot;</span>)</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>dt_melt[, type<span class="sc">:</span><span class="er">=</span><span class="fu">gsub</span>(<span class="at">x=</span>type, <span class="at">pattern=</span><span class="st">&quot;css95_uv&quot;</span>, <span class="at">replacement=</span><span class="st">&quot;Both&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)]</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>dt_melt[, type<span class="sc">:</span><span class="er">=</span><span class="fu">gsub</span>(<span class="at">x=</span>type, <span class="at">pattern=</span><span class="st">&quot;css95_u&quot;</span>, <span class="at">replacement=</span><span class="st">&quot;Uncertainty&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)]</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>dt_melt[, type<span class="sc">:</span><span class="er">=</span><span class="fu">gsub</span>(<span class="at">x=</span>type, <span class="at">pattern=</span><span class="st">&quot;css95_v&quot;</span>, <span class="at">replacement=</span><span class="st">&quot;Variability&quot;</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)]</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="co">#now set the factor levels explicitly</span></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>dt_melt[, type<span class="sc">:</span><span class="er">=</span><span class="fu">factor</span>(type,</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Uncertainty&quot;</span>, <span class="st">&quot;Variability&quot;</span>, <span class="st">&quot;Both&quot;</span>))]</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>dt_melt[, Norm<span class="sc">:</span><span class="er">=</span>css95<span class="sc">/</span>cssmed]</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a><span class="co">#now set the factor levels explicitly</span></span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>dt_melt[, Compound<span class="sc">:</span><span class="er">=</span><span class="fu">factor</span>(Compound,</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels=</span>dt_melt[type<span class="sc">==</span><span class="st">&quot;Both&quot;</span>,Compound][<span class="fu">order</span>(dt_melt[type<span class="sc">==</span><span class="st">&quot;Both&quot;</span>,Norm])])]</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>Fig6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>dt_melt) <span class="sc">+</span></span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">alpha=</span><span class="fl">0.7</span>,<span class="fu">aes</span>(<span class="at">x=</span>Compound,</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span>Norm,</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span>type,</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape=</span>type)) <span class="sc">+</span></span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Ratio of &quot;</span>,C[ss],<span class="st">&quot; &quot;</span>,<span class="dv">95</span><span class="sc">^</span>th,<span class="st">&quot; Percentile to Median Estimate&quot;</span>))) <span class="sc">+</span></span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">name=</span><span class="fu">expression</span>(<span class="fu">paste</span>(C[ss],<span class="st">&quot; Varied to Reflect&quot;</span>)))<span class="sc">+</span> </span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_discrete</span>(<span class="at">name=</span><span class="fu">expression</span>(<span class="fu">paste</span>(C[ss],<span class="st">&quot; Varied to Reflect&quot;</span>))) <span class="sc">+</span></span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="fu">levels</span>(dt_melt<span class="sc">$</span>Compound)[<span class="fu">length</span>(<span class="fu">unique</span>(dt_melt<span class="sc">$</span>Compound))<span class="sc">/</span><span class="dv">2</span>], <span class="at">y =</span> <span class="dv">400</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Median Ratio for Uncertainty:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(<span class="fu">subset</span>(dt_melt,type<span class="sc">==</span><span class="st">&quot;Uncertainty&quot;</span>)<span class="sc">$</span>Norm),<span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="fu">levels</span>(dt_melt<span class="sc">$</span>Compound)[<span class="fu">length</span>(<span class="fu">unique</span>(dt_melt<span class="sc">$</span>Compound))<span class="sc">/</span><span class="dv">2</span>], <span class="at">y =</span> <span class="dv">200</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Median Ratio for Variability:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(<span class="fu">subset</span>(dt_melt,type<span class="sc">==</span><span class="st">&quot;Variability&quot;</span>)<span class="sc">$</span>Norm),<span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="fu">levels</span>(dt_melt<span class="sc">$</span>Compound)[<span class="fu">length</span>(<span class="fu">unique</span>(dt_melt<span class="sc">$</span>Compound))<span class="sc">/</span><span class="dv">2</span>], <span class="at">y =</span> <span class="dv">100</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Median Ratio for Both:&quot;</span>,<span class="fu">signif</span>(<span class="fu">median</span>(<span class="fu">subset</span>(dt_melt,type<span class="sc">==</span><span class="st">&quot;Both&quot;</span>)<span class="sc">$</span>Norm),<span class="dv">3</span>)))</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)  </span></span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Fig6)</span></code></pre></div>
</div>
<div id="figure-7-high-throughput-risk-based-prioritization" class="section level1">
<h1>Figure 7: High throughput risk-based prioritization</h1>
<p>High throughput risk-based prioritization can be conducted by using
doses predicted to cause bioactivity identified by high-throughput
screening. High throughput exposure estimates have large uncertainty,
indicated by the triangles (median of distribution) and vertical bar
(upper 95th percentile range). There are many <em>in vitro</em>
activities identified for each chemical, the 80% interval of equivalent
dose rates is indicated by the vertical red bar, with a horizontal slash
indicating the median and the circle plot points indicating the 10th
percentile of the bioactive concentration. Anywhere the entire exposure
bar is below the bioactivity circle there is 95% probability that the
median exposure will not cause a dose sufficient to cause the 10th
percentile <em>in vitro</em> bioactivity. Chemicals are sorted from
left-to-right by the margin between the 10th percentile bioactivity
(small circle) and the upper 95th percentile limit on estimated median
intake rate. In <strong>panel A</strong>, all chemicals for which <span class="math inline">\(C_{ss}\)</span> could be calculated are shown
using only variability. In <strong>panel B</strong>, the shaded region
of <strong>panel A</strong> is shown, using both variability and
uncertainty to calculate the bioactive dose. Arrows in <strong>panel
B</strong> identify six chemicals where exposure and 10th percentile
bioactivity potentially overlap that would have been missed as priority
chemicals if uncertainty analysis was not performed. Two overlapping
bars are shown for each chemical’’s bioactive doses – the upper one is
for variability alone (as in <strong>Panel A</strong>), the lower is for
uncertainty and variability together.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Head to ftp://newftp.epa.gov/COMPTOX/High_Throughput_Screening_Data/Previous_Data/ToxCast_Data_Release_Oct_2015/ to get the ToxCast/Tox21 data:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the concentrations that caused activity in exess of the background (ACC) &quot;hits&quot;.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load the ACC table into an object Tox21.acc:</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tox21.acc &lt;- read.csv(&quot;INVITRODB_V2_LEVEL5/EXPORT_LVL5&amp;6_ASID7_TOX21_151020.csv&quot;,stringsAsFactors=FALSE)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Subset to the chemicals of interest:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tox21.acc &lt;- subset(Tox21.acc,casn%in%Fig1.table$CAS)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # We only need hits:</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tox21.acc &lt;- subset(Tox21.acc,hitc==1)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Pare this down to just the data we need:</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Tox21.acc &lt;- Tox21.acc[,c(&quot;code&quot;,&quot;chid&quot;,&quot;chnm&quot;,&quot;casn&quot;,&quot;aenm&quot;,&quot;modl_acc&quot;,&quot;flags&quot;)]</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # In this vignette we use the precalculated quantiles of the ACC&#39;s </span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # to help keep the HTTK package smaller:</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># wambaugh2019.tox21 &lt;- NULL</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for (this.chem in sort(unique(Tox21.acc$casn)))</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># {</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   this.subset &lt;- subset(Tox21.acc,casn==this.chem)</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   this.row &lt;- data.frame(casn=this.chem,</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     med.conc = </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">#       median(10^(this.subset$modl_acc)),</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     q10.conc = </span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">#       quantile(10^(this.subset$modl_acc),0.1),</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     low.conc = </span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">#       min(10^(this.subset$modl_acc)),</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     q90.conc = </span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       quantile(10^(this.subset$modl_acc),0.9),</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     high.conc = </span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       max(10^(this.subset$modl_acc)),</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     stringsAsFactors = F)</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   wambaugh2019.tox21  &lt;- rbind(wambaugh2019.tox21, this.row)</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>chem.preds <span class="ot">&lt;-</span> httk<span class="sc">::</span>wambaugh2019.seem3</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>directnhanes.preds <span class="ot">&lt;-</span> httk<span class="sc">::</span>wambaugh2019.nhanes</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>Tox21.acc.numeric <span class="ot">&lt;-</span> httk<span class="sc">::</span>wambaugh2019.tox21</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Subset to those chemicals with HTS hits:</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>human.hits <span class="ot">&lt;-</span> <span class="fu">subset</span>(ceetox,CAS<span class="sc">%in%</span>Tox21.acc.numeric<span class="sc">$</span>casn)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Now calculate the oral equivalent dose for each chemical:</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Must make sure that CSS is in units of uM!!</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> human.hits<span class="sc">$</span>CAS)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  med.conc <span class="ot">&lt;-</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    Tox21.acc.numeric[Tox21.acc.numeric<span class="sc">$</span>casn<span class="sc">==</span>this.chem,<span class="st">&quot;med.conc&quot;</span>] </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  q10.conc <span class="ot">&lt;-</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    Tox21.acc.numeric[Tox21.acc.numeric<span class="sc">$</span>casn<span class="sc">==</span>this.chem,<span class="st">&quot;q10.conc&quot;</span>]</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  low.conc <span class="ot">&lt;-</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    Tox21.acc.numeric[Tox21.acc.numeric<span class="sc">$</span>casn<span class="sc">==</span>this.chem,<span class="st">&quot;low.conc&quot;</span>]</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  q90.conc <span class="ot">&lt;-</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    Tox21.acc.numeric[Tox21.acc.numeric<span class="sc">$</span>casn<span class="sc">==</span>this.chem,<span class="st">&quot;q90.conc&quot;</span>]</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  high.conc <span class="ot">&lt;-</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    Tox21.acc.numeric[Tox21.acc.numeric<span class="sc">$</span>casn<span class="sc">==</span>this.chem,<span class="st">&quot;high.conc&quot;</span>] </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  css95.v <span class="ot">&lt;-</span> human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem][[<span class="st">&quot;css95_v&quot;</span>]]</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  css95.uv <span class="ot">&lt;-</span> human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem][[<span class="st">&quot;css95_uv&quot;</span>]]</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Median.ACC&quot;</span>] <span class="ot">&lt;-</span> med.conc</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Q10.ACC&quot;</span>] <span class="ot">&lt;-</span> q10.conc</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Q90.ACC&quot;</span>] <span class="ot">&lt;-</span> q90.conc</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Low.ACC&quot;</span>] <span class="ot">&lt;-</span> low.conc</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.High.ACC&quot;</span>] <span class="ot">&lt;-</span> high.conc</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Median.equivdose.v&quot;</span>] <span class="ot">&lt;-</span> med.conc<span class="sc">/</span>css95.v</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Q10.equivdose.v&quot;</span>] <span class="ot">&lt;-</span> q10.conc<span class="sc">/</span>css95.v</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Q90.equivdose.v&quot;</span>] <span class="ot">&lt;-</span> q90.conc<span class="sc">/</span>css95.v</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Low.equivdose.v&quot;</span>] <span class="ot">&lt;-</span> low.conc<span class="sc">/</span>css95.v</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.High.equivdose.v&quot;</span>] <span class="ot">&lt;-</span> high.conc<span class="sc">/</span>css95.v</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Median.equivdose.uv&quot;</span>] <span class="ot">&lt;-</span> med.conc<span class="sc">/</span>css95.uv</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Q10.equivdose.uv&quot;</span>] <span class="ot">&lt;-</span> q10.conc<span class="sc">/</span>css95.uv</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Q90.equivdose.uv&quot;</span>] <span class="ot">&lt;-</span> q90.conc<span class="sc">/</span>css95.uv</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.Low.equivdose.uv&quot;</span>] <span class="ot">&lt;-</span> low.conc<span class="sc">/</span>css95.uv</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>  human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;HTS.High.equivdose.uv&quot;</span>] <span class="ot">&lt;-</span> high.conc<span class="sc">/</span>css95.uv</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="co">#Add the exposure predictions:</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> human.hits<span class="sc">$</span>CAS)</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(this.chem)</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="co"># If we have direct inferrences from NHANES, use those exposures:</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.chem <span class="sc">%in%</span> directnhanes.preds<span class="sc">$</span>CASRN)</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>    human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;Exposure.median&quot;</span>] <span class="ot">&lt;-</span> directnhanes.preds[directnhanes.preds<span class="sc">$</span>CASRN<span class="sc">==</span>this.chem,<span class="st">&quot;lP&quot;</span>]</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;Exposure.high&quot;</span>] <span class="ot">&lt;-</span> directnhanes.preds[directnhanes.preds<span class="sc">$</span>CASRN<span class="sc">==</span>this.chem,<span class="st">&quot;lP.max&quot;</span>]</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Otherwise use the heuristics model (Wambaugh 2014):    </span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (this.chem <span class="sc">%in%</span> chem.preds<span class="sc">$</span>CAS) {</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>    human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;Exposure.median&quot;</span>] <span class="ot">&lt;-</span> chem.preds[chem.preds<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;seem3&quot;</span>]</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>    human.hits[human.hits<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;Exposure.high&quot;</span>] <span class="ot">&lt;-</span> chem.preds[chem.preds<span class="sc">$</span>CAS<span class="sc">==</span>this.chem,<span class="st">&quot;seem3.u95&quot;</span>]  </span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop chemicals without exposure predictions:</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>human.hits<span class="ot">&lt;-</span> <span class="fu">subset</span>(human.hits,<span class="sc">!</span><span class="fu">is.na</span>(Exposure.median))</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="co"># This code puts the chemicals into order by margin between exposure and activity:</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>chem.names <span class="ot">&lt;-</span> <span class="fu">unique</span>(human.hits<span class="sc">$</span>Compound)</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>potency <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">Inf</span>,<span class="at">times=</span><span class="fu">length</span>(chem.names))</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(potency) <span class="ot">&lt;-</span> chem.names</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>potency.u <span class="ot">&lt;-</span> potency</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> chem.names)</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>  this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(human.hits,Compound<span class="sc">==</span>this.chem)</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  potency[this.chem] <span class="ot">&lt;-</span> this.subset<span class="sc">$</span>HTS.Q10.equivdose.v<span class="sc">/</span>this.subset<span class="sc">$</span>Exposure.high</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>  potency.u[this.chem] <span class="ot">&lt;-</span> this.subset<span class="sc">$</span>HTS.Q10.equivdose.uv<span class="sc">/</span>this.subset<span class="sc">$</span>Exposure.high</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>potency <span class="ot">&lt;-</span> <span class="fu">sort</span>(potency)</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>human.hits<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="fu">factor</span>(human.hits<span class="sc">$</span>Compound, <span class="at">levels=</span><span class="fu">names</span>(potency))</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>potency.u <span class="ot">&lt;-</span> potency.u[<span class="fu">names</span>(potency.u)[potency.u<span class="sc">&lt;</span><span class="dv">1</span>]]</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>potency.u <span class="ot">&lt;-</span> potency.u[<span class="fu">names</span>(potency)[potency<span class="sc">&gt;</span><span class="dv">1</span>]]</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>new.overlaps <span class="ot">&lt;-</span> <span class="fu">names</span>(potency.u[<span class="sc">!</span><span class="fu">is.na</span>(potency.u)])</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>first.change <span class="ot">&lt;-</span> new.overlaps[<span class="dv">1</span>]</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>last.change <span class="ot">&lt;-</span> new.overlaps[<span class="fu">length</span>(new.overlaps)]</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>window.start <span class="ot">&lt;-</span> <span class="fu">names</span>(potency)[<span class="fu">which</span>(<span class="fu">names</span>(potency)<span class="sc">==</span>first.change)<span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>window.end <span class="ot">&lt;-</span> <span class="fu">names</span>(potency)[<span class="fu">which</span>(<span class="fu">names</span>(potency)<span class="sc">==</span>last.change)<span class="sc">+</span><span class="dv">5</span>]</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>window.names <span class="ot">&lt;-</span> <span class="fu">names</span>(potency)[(<span class="fu">which</span>(<span class="fu">names</span>(potency)<span class="sc">==</span>first.change)<span class="sc">-</span><span class="dv">5</span>)<span class="sc">:</span>(<span class="fu">which</span>(<span class="fu">names</span>(potency)<span class="sc">==</span>last.change)<span class="sc">+</span><span class="dv">5</span>)]</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a new plot:</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>Fig7a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>human.hits) <span class="sc">+</span></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span>HTS.Q10.equivdose.v,<span class="at">yend=</span>HTS.Q90.equivdose.v),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;white&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">xmin=</span>window.start,<span class="at">xmax=</span>window.end,<span class="at">ymin=</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">9</span>,<span class="at">ymax=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>),<span class="at">color=</span><span class="st">&quot;grey&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span>HTS.Q10.equivdose.v,<span class="at">yend=</span>HTS.Q90.equivdose.v),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>HTS.Median.equivdose.v),<span class="at">shape=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>HTS.Q10.equivdose.v)) <span class="sc">+</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span>Exposure.high,<span class="at">yend=</span>Exposure.median),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>Exposure.median),<span class="at">shape=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Bioactive Dose &amp; Exposure</span><span class="sc">\n</span><span class="st">mg/kg BW/day</span><span class="sc">\n</span><span class="st">(Variability Only)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chemicals Ranked By Ratio Between Bioactive Dose and Exposure&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> <span class="fu">names</span>(potency)[<span class="dv">10</span>], <span class="at">y =</span> <span class="dv">100</span>, <span class="at">label =</span> <span class="st">&quot;a&quot;</span>)</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a new plot:</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>Fig7c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>human.hits,<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span>HTS.Q10.equivdose.v,<span class="at">yend=</span>HTS.Q90.equivdose.v),<span class="at">size=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>human.hits,<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span>HTS.Q10.equivdose.uv,<span class="at">yend=</span>HTS.Q90.equivdose.uv),<span class="at">size=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>human.hits,<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>HTS.Median.equivdose.uv),<span class="at">shape=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>human.hits,<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>HTS.Q10.equivdose.uv),<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="dv">1</span>,<span class="at">size=</span><span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span> </span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(window.names) <span class="sc">+</span></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>,<span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>human.hits,<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span>Exposure.high,<span class="at">yend=</span>Exposure.median),<span class="at">size=</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span><span class="fu">subset</span>(human.hits,Compound<span class="sc">%in%</span><span class="fu">names</span>(potency.u)),<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">xend=</span>Compound,<span class="at">y=</span><span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span>,<span class="at">yend=</span>Exposure.median<span class="sc">/</span><span class="fl">1.5</span>),<span class="at">size=</span><span class="dv">2</span>,<span class="at">arrow=</span><span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;cm&quot;</span>)))<span class="sc">+</span></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>human.hits,<span class="fu">aes</span>(<span class="at">x=</span>Compound,<span class="at">y=</span>Exposure.median),<span class="at">shape=</span><span class="dv">2</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Bioactive Dose &amp; Exposure</span><span class="sc">\n</span><span class="st">mg/kg BW/day</span><span class="sc">\n</span><span class="st">(Uncertainty and Variability)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">size=</span><span class="dv">8</span>,<span class="at">x =</span> window.names[<span class="dv">1</span>], <span class="at">y =</span> <span class="dv">100</span>, <span class="at">label =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Fig10b)</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new(width=10,height=6)</span></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(Fig7a,Fig7c,<span class="at">cols=</span><span class="dv">1</span>,<span class="at">heights=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">subset</span>(human.hits,Exposure.high<span class="sc">&gt;</span>HTS.Q10.equivdose.uv)[,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DSSTox_Substance_Id&quot;</span>,<span class="st">&quot;Human.Clint&quot;</span>,<span class="st">&quot;Human.Funbound.plasma&quot;</span>,<span class="st">&quot;HTS.Q10.ACC&quot;</span>,<span class="st">&quot;HTS.Q10.equivdose.v&quot;</span>,<span class="st">&quot;HTS.Q10.equivdose.uv&quot;</span>,<span class="st">&quot;Exposure.high&quot;</span>)],<span class="at">file=</span><span class="fu">paste</span>(<span class="st">&quot;SupTable5-&quot;</span>,<span class="fu">Sys.Date</span>(),<span class="st">&quot;.txt&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="final-statistics" class="section level1">
<h1>Final statistics:</h1>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Wetmore.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,<span class="fu">regexpr</span>(<span class="st">&quot;Wetmore&quot;</span>,Human.Clint.Reference)<span class="sc">!=-</span><span class="dv">1</span>)[,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Formula&quot;</span>)]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Wetmore.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(Wetmore.chems,CAS<span class="sc">%in%</span><span class="fu">get_cheminfo</span>())</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> Wetmore.chems<span class="sc">$</span>CAS)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  Wetmore.chems[Wetmore.chems<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Css.Lit&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">get_lit_css</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  Wetmore.chems[Wetmore.chems<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Css.v192&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">calc_mc_css</span>(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fup.meas.cv=</span><span class="cn">NULL</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">clint.meas.cv=</span><span class="cn">NULL</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fup.censored.dist=</span><span class="cn">TRUE</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  Wetmore.chems[Wetmore.chems<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Css.v110&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">calc_mc_css</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(Wetmore.chems<span class="sc">$</span>Css.v110<span class="sc">/</span>Wetmore.chems<span class="sc">$</span>Css.Lit,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>ceetox<span class="sc">$</span>Human.Clint2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ceetox<span class="sc">$</span>Human.Clint,<span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>ceetox<span class="sc">$</span>Human.Fup2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ceetox<span class="sc">$</span>Human.Funbound.plasma,<span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ceetox[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">15</span>,<span class="dv">31</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">18</span><span class="sc">:</span><span class="dv">28</span>)],<span class="at">row.names=</span><span class="cn">FALSE</span>,<span class="at">file=</span><span class="fu">paste</span>(<span class="st">&quot;Supplemental-Table4-&quot;</span>,<span class="fu">Sys.Date</span>(),<span class="st">&quot;.txt&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Complete HTTK data on&quot;</span>,<span class="fu">sum</span>(<span class="fu">get_cheminfo</span>()<span class="sc">%in%</span>ceetox<span class="sc">$</span>CAS),<span class="st">&quot;new chemicals.&quot;</span>))</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
