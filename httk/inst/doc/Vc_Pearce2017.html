<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Robert Pearce" />

<meta name="date" content="2023-04-30" />

<title>Pearce et al. (2017): Evaluation of Tissue Partitioning</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Pearce et al. (2017): Evaluation of Tissue
Partitioning</h1>
<h4 class="author">Robert Pearce</h4>
<h4 class="date">April 30, 2023</h4>



<p><em>Please send questions to <a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></em></p>
<p>from “Evaluation and calibration of high-throughput predictions of
chemical distribution to tissues”</p>
<p>Robert G. Pearce, R. Woodrow Setzer, Jimena L. Davis,and John F.
Wambaugh</p>
<p>Journal of Pharmacokinetics and Pharmacodynamics volume 44,
pages549–565 (2017)</p>
<p><a href="https://doi.org/10.1007/s10928-017-9548-7" class="uri">https://doi.org/10.1007/s10928-017-9548-7</a></p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>Toxicokinetics (TK) provides critical information for integrating
chemical toxicity and exposure assessments in order to determine
potential chemical risk (i.e., the margin between toxic doses and
plausible exposures). For thousands of chemicals that are present in our
environment, in vivo TK data are lacking. The publicly available R
package “httk” (version 1.8, named for “high throughput TK”) draws from
a database of in vitro data and physico-chemical properties in order to
run physiologically-based TK (PBTK) models for 553 compounds. The PBTK
model parameters include tissue:plasma partition coefficients (Kp) which
the httk software predicts using the model of Schmitt (Toxicol In Vitro
22 (2):457–467, 2008). In this paper we evaluated and modified httk
predictions, and quantified confidence using in vivo literature data. We
used 964 rat Kp measured by in vivo experiments for 143 compounds.
Initially, predicted Kp were significantly larger than measured Kp for
many lipophilic compounds (log10 octanol:water partition coefficient
&gt; 3). Hence the approach for predicting Kp was revised to account for
possible deficiencies in the in vitro protein binding assay, and the
method for predicting membrane affinity was revised. These changes
yielded improvements ranging from a factor of 10 to nearly a factor of
10,000 for 83 Kp across 23 compounds with only 3 Kp worsening by more
than a factor of 10. The vast majority (92%) of Kp were predicted within
a factor of 10 of the measured value (overall root mean squared error of
0.59 on log10-transformed scale). After applying the adjustments,
regressions were performed to calibrate and evaluate the predictions for
12 tissues. Predictions for some tissues (e.g., spleen, bone, gut, lung)
were observed to be better than predictions for other tissues (e.g.,
skin, brain, fat), indicating that confidence in the application of in
silico tools to predict chemical partitioning varies depending upon the
tissues involved. Our calibrated model was then evaluated using a second
data set of human in vivo measurements of volume of distribution (Vss)
for 498 compounds reviewed by Obach et al. (Drug Metab Dispos
36(7):1385–1405, 2008). We found that calibration of the model improved
performance: a regression of the measured values as a function of the
predictions has a slope of 1.03, intercept of − 0.04, and R2 of 0.43.
Through careful evaluation of predictive methods for chemical
partitioning into tissues, we have improved and calibrated these methods
and quantified confidence for TK predictions in humans and rats.</p>
</div>
<div id="httk-version" class="section level2">
<h2>HTTK Version</h2>
<p>This vignette was created with <strong>httk</strong> v1.6. It was
updated to httk v2.2.3 in April of 2023. Although we attempt to maintain
backward compatibility, if you encounter issues with the latest release
of <strong>httk</strong> and cannot easily address the changes,
historical versions of httk are available from: <a href="https://cran.r-project.org/src/contrib/Archive/httk/" class="uri">https://cran.r-project.org/src/contrib/Archive/httk/</a></p>
</div>
<div id="prepare-for-session" class="section level2">
<h2>Prepare for session</h2>
<p>R package <strong>knitr</strong> generates html and PDF documents
from this RMarkdown file, Each bit of code that follows is known as a
“chunk”. We start by telling <strong>knitr</strong> how we want our
chunks to look.</p>
<div id="clear-the-memory" class="section level3">
<h3>Clear the memory</h3>
<p>It is a bad idea to let variables and other information from previous
R sessions float around, so we first remove everything in the R
memory.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="eval-execute.vignette" class="section level3">
<h3>eval = execute.vignette</h3>
<p>If you are using the RMarkdown version of this vignette (extension,
.RMD) you will be able to see that several chunks of code in this
vignette have the statement “eval = execute.vignette”. The next chunk of
code, by default, sets execute.vignette = FALSE. This means that the
code is included (and necessary) but was not run when the vignette was
built. We do this because some steps require extensive computing time
and the checks on CRAN limit how long we can spend building the package.
If you want this vignette to work, you must run all code, either by
cutting and pasting it into R. Or, if viewing the .RMD file, you can
either change execute.vignette to TRUE or press “play” (the green arrow)
on each chunk in RStudio.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set whether or not the following chunks will be executed (run):</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>execute.vignette <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<div id="load-the-relevant-libraries" class="section level3">
<h3>Load the relevant libraries</h3>
<p>We use the command ‘library()’ to load various R packages for our
analysis. If you get the message “Error in library(X) : there is no
package called ‘X’” then you will need to install that package:</p>
<p>From the R command prompt:</p>
<p>install.packages(“X”)</p>
<p>Or, if using RStudio, look for ‘Install Packages’ under ‘Tools’
tab.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httk)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gdata)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
</div>
<div id="function-to-format-scientific-notation" class="section level3">
<h3>Function to format scientific notation</h3>
<p>From <a href="https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales" class="uri">https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales</a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                                  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="fu">scientific_format</span>()(x))              </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">parse</span>(<span class="at">text=</span><span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}  </span></code></pre></div>
<p>We first filter the measured rat Kp data, pc.data. Then the old and
new Kp predictions are made, along with error and improvement measures,
and these are all consolidated into a table for analysis and plotting.
Note that the final table contains log10-transformed values and error
and improvements derived from subtracting these values. Only relevant
rat values are used. Compounds with Funbound.plasma and partition
coefficients of zero are removed as well as compounds with approximated
Funbound.plasma values.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pc.table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pc.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(pc.data,fu <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> Exp_PC <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> Tissue <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Adipose&quot;</span>,<span class="st">&quot;Bone&quot;</span>,<span class="st">&quot;Brain&quot;</span>,<span class="st">&quot;Gut&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Heart&quot;</span>,<span class="st">&quot;Kidney&quot;</span>,<span class="st">&quot;Liver&quot;</span>,<span class="st">&quot;Lung&quot;</span>,<span class="st">&quot;Muscle&quot;</span>,<span class="st">&quot;Skin&quot;</span>,<span class="st">&quot;Spleen&quot;</span>,<span class="st">&quot;Blood Cells&quot;</span>) <span class="sc">&amp;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tolower</span>(Species) <span class="sc">==</span> <span class="st">&#39;rat&#39;</span> <span class="sc">&amp;</span> <span class="sc">!</span>CAS <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;10457-90-6&#39;</span>,<span class="st">&#39;5786-21-0&#39;</span>,<span class="st">&#39;17617-23-1&#39;</span>,<span class="st">&#39;69-23-8&#39;</span>,<span class="st">&#39;2898-12-6&#39;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;57562-99-9&#39;</span>,<span class="st">&#39;59-99-4&#39;</span>,<span class="st">&#39;2955-38-6&#39;</span>,<span class="st">&#39;155-97-5&#39;</span>,<span class="st">&#39;41903-57-5&#39;</span>,<span class="st">&#39;58-55-9&#39;</span>,<span class="st">&#39;77-32-7&#39;</span>,<span class="st">&#39;59-05-2&#39;</span>,<span class="st">&#39;60-54-8&#39;</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>cas.list <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&#39;schmitt&#39;</span>,<span class="at">species=</span><span class="st">&#39;rat&#39;</span>,<span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>cas.list <span class="ot">&lt;-</span>  cas.list[cas.list <span class="sc">%in%</span> pc.data[,<span class="st">&#39;CAS&#39;</span>]]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ma.data.list <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,<span class="sc">!</span><span class="fu">is.na</span>(logMA))[,<span class="st">&#39;CAS&#39;</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(this.cas <span class="cf">in</span> cas.list){</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">parameterize_schmitt</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">species=</span><span class="st">&#39;rat&#39;</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  init.parameters <span class="ot">&lt;-</span> parameters</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  charge <span class="ot">&lt;-</span> <span class="fu">calc_ionization</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">pH=</span><span class="fl">7.4</span>)<span class="sc">$</span>fraction_charged</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>this.cas <span class="sc">%in%</span> ma.data.list){</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    init.parameters<span class="sc">$</span>MA <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.999831</span> <span class="sc">-</span> <span class="fl">0.016578</span><span class="sc">*</span><span class="fl">38.7</span> <span class="sc">+</span> <span class="fl">0.881721</span> <span class="sc">*</span> <span class="fu">log10</span>(parameters<span class="sc">$</span>Pow))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>parameters,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">species=</span><span class="st">&#39;rat&#39;</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">regression=</span><span class="cn">FALSE</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  init.pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>init.parameters,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">species=</span><span class="st">&#39;rat&#39;</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">regression=</span><span class="cn">FALSE</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(this.tissue <span class="cf">in</span> <span class="fu">subset</span>(pc.data,CAS<span class="sc">==</span>this.cas)[,<span class="st">&#39;Tissue&#39;</span>]){</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this.tissue <span class="sc">==</span> <span class="st">&#39;Blood Cells&#39;</span>) this.pc <span class="ot">&lt;-</span> <span class="st">&#39;rbc&#39;</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> this.pc <span class="ot">&lt;-</span> this.tissue</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        pc.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pc.table,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">cbind</span>(</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(this.cas),</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(this.tissue),</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                          init.pcs[[<span class="fu">which</span>(<span class="fu">substr</span>(<span class="fu">names</span>(init.pcs),</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span>,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">nchar</span>(<span class="fu">names</span>(init.pcs))<span class="sc">-</span><span class="dv">3</span>) <span class="sc">==</span> </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">tolower</span>(this.pc))]] <span class="sc">*</span> </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                          init.parameters<span class="sc">$</span>Funbound.plasma)),</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                          pcs[[<span class="fu">which</span>(<span class="fu">substr</span>(<span class="fu">names</span>(pcs),</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span>,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">nchar</span>(<span class="fu">names</span>(pcs))<span class="sc">-</span><span class="dv">3</span>) <span class="sc">==</span> </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">tolower</span>(this.pc))]] <span class="sc">*</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>                          parameters<span class="sc">$</span>unadjusted.Funbound.plasma)),</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                          init.pcs[[<span class="fu">which</span>(<span class="fu">substr</span>(<span class="fu">names</span>(init.pcs),</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span>,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">nchar</span>(<span class="fu">names</span>(init.pcs))<span class="sc">-</span><span class="dv">3</span>) <span class="sc">==</span> </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">tolower</span>(this.pc))]] <span class="sc">*</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>                          init.parameters<span class="sc">$</span>unadjusted.Funbound.plasma)),</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>                          pcs[[<span class="fu">which</span>(<span class="fu">substr</span>(<span class="fu">names</span>(pcs),</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span>,</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">nchar</span>(<span class="fu">names</span>(pcs))<span class="sc">-</span><span class="dv">3</span>) <span class="sc">==</span> <span class="fu">tolower</span>(this.pc))]] <span class="sc">*</span> </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>                            parameters<span class="sc">$</span>Funbound.plasma)),</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">subset</span>(pc.data,</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                            CAS<span class="sc">==</span>this.cas <span class="sc">&amp;</span> Tissue<span class="sc">==</span>this.tissue)[,<span class="st">&#39;Exp_PC&#39;</span>])),</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">subset</span>(pc.data,</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>                          CAS<span class="sc">==</span>this.cas <span class="sc">&amp;</span> Tissue<span class="sc">==</span>this.tissue)[,<span class="st">&#39;LogP&#39;</span>]),</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(charge),</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">as.character</span>(<span class="fu">subset</span>(pc.data,</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>                          CAS <span class="sc">==</span> this.cas)[<span class="dv">1</span>,<span class="st">&#39;A.B.N&#39;</span>])),</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(<span class="fu">subset</span>(pc.data, </span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>                          CAS <span class="sc">==</span> this.cas)[<span class="dv">1</span>,<span class="st">&#39;fu&#39;</span>])))</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pc.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;CAS&#39;</span>,<span class="st">&#39;Tissue&#39;</span>,</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;fup.correction&#39;</span>,</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;ma.correction&#39;</span>,</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;init.Predicted&#39;</span>,</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;Predicted&#39;</span>,</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;Experimental&#39;</span>,</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;logP&#39;</span>,</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;charge&#39;</span>,</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;type&#39;</span>,</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;fup&#39;</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>init.error <span class="ot">&lt;-</span> pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> pc.table[,<span class="st">&#39;init.Predicted&#39;</span>]</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>fup.error <span class="ot">&lt;-</span> pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> pc.table[,<span class="st">&#39;fup.correction&#39;</span>]</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>ma.error <span class="ot">&lt;-</span> pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> pc.table[,<span class="st">&#39;ma.correction&#39;</span>]</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>final.error <span class="ot">&lt;-</span> pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> pc.table[,<span class="st">&#39;Predicted&#39;</span>]</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>fup.improvement <span class="ot">&lt;-</span> <span class="fu">abs</span>(init.error) <span class="sc">-</span> <span class="fu">abs</span>(fup.error)</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>ma.improvement <span class="ot">&lt;-</span> <span class="fu">abs</span>(init.error) <span class="sc">-</span> <span class="fu">abs</span>(ma.error)</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>final.improvement <span class="ot">&lt;-</span> <span class="fu">abs</span>(init.error) <span class="sc">-</span> <span class="fu">abs</span>(final.error)</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>pc.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pc.table,fup.improvement,ma.improvement, final.improvement,</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>                  final.error,init.error,ma.error,fup.error)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>init.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>pc.table,<span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(init.Predicted),<span class="dv">10</span><span class="sc">^</span>(Experimental))) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p]))) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(init.plot)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>init.stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Experimental <span class="sc">~</span> init.Predicted, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data=</span>pc.table))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>final.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>pc.table,<span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(Predicted),<span class="dv">10</span><span class="sc">^</span>(Experimental))) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p]))) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final.plot)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>final.stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Experimental <span class="sc">~</span> Predicted, </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data=</span>pc.table))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>fup.change.plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>pc.table[<span class="fu">order</span>(pc.table[,<span class="st">&#39;fup.improvement&#39;</span>],<span class="at">decreasing=</span>F),],</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(fup.correction),<span class="dv">10</span><span class="sc">^</span>(Experimental),<span class="at">color=</span>fup.improvement)) <span class="sc">+</span> </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p])),<span class="at">color=</span><span class="st">&#39;Improvement&#39;</span>) <span class="sc">+</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">option=</span><span class="st">&#39;inferno&#39;</span>)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fup.change.plot)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>fup.stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Experimental <span class="sc">~</span> fup.correction, </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>pc.table))</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>ma.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(pc.table,<span class="sc">!</span>CAS <span class="sc">%in%</span> ma.data.list)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>ma.change.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>ma.subset[<span class="fu">order</span>(ma.subset[,<span class="st">&#39;ma.improvement&#39;</span>]</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      ,<span class="at">decreasing=</span>F),], </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(ma.correction),<span class="dv">10</span><span class="sc">^</span>(Experimental),<span class="at">color=</span>ma.improvement)) <span class="sc">+</span> </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])),</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p])),<span class="at">color=</span><span class="st">&#39;Improvement&#39;</span>) <span class="sc">+</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="sc">^</span><span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis</span>(<span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">option=</span><span class="st">&#39;inferno&#39;</span>)</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ma.change.plot)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>ma.stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Experimental <span class="sc">~</span> ma.correction, </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>ma.subset))</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>fup.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Test=</span><span class="fu">c</span>(<span class="st">&quot;Initial Tissue PC Accuracy&quot;</span>,<span class="st">&quot;Fup Lipid Correction&quot;</span>,<span class="st">&quot;Membrane Affinity&quot;</span>,<span class="st">&quot;Final&quot;</span>),</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RSquared =</span> <span class="fu">signif</span>(<span class="fu">c</span>(init.stats<span class="sc">$</span>adj.r.squared,</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>                                         fup.stats<span class="sc">$</span>adj.r.squared,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>                                         ma.stats<span class="sc">$</span>adj.r.squared,</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>                                         final.stats<span class="sc">$</span>adj.r.squared),<span class="dv">3</span>),</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>                           <span class="at">RMSLE =</span> <span class="fu">signif</span>(<span class="fu">c</span>(<span class="fu">mean</span>(init.stats<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">mean</span>(fup.stats<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">mean</span>(ma.stats<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">mean</span>(final.stats<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)),<span class="dv">3</span>)</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(fup.table)</span></code></pre></div>
<p>Now we calculate and plot the regressions for all tissues, together
with their 95% confidence intervals.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>regressions <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(tissue <span class="cf">in</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(pc.table[,<span class="st">&#39;Tissue&#39;</span>]))){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Experimental <span class="sc">~</span> Predicted ,<span class="at">data=</span><span class="fu">subset</span>(pc.table,Tissue<span class="sc">==</span>tissue))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  smry <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">estimable</span>(fit, <span class="at">cm=</span><span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">beta0=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">joint.test=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  regressions <span class="ot">&lt;-</span> <span class="fu">rbind</span>(regressions,<span class="fu">cbind</span>(tissue,<span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[[<span class="st">&#39;(Intercept)&#39;</span>]]),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[[<span class="st">&#39;Predicted&#39;</span>]]),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>coefficients[[<span class="st">&#39;Predicted&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]]),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>sigma),<span class="fu">as.data.frame</span>(smry<span class="sc">$</span>r.squared),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(smry[[<span class="dv">11</span>]][<span class="dv">1</span>,<span class="dv">1</span>]),<span class="fu">as.data.frame</span>(smry[[<span class="dv">11</span>]][<span class="dv">2</span>,<span class="dv">2</span>]),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(smry[[<span class="dv">11</span>]][<span class="dv">1</span>,<span class="dv">2</span>]),<span class="fu">as.data.frame</span>(smry<span class="sc">$</span>df[<span class="dv">2</span>]),<span class="fu">as.data.frame</span>(est[[<span class="dv">3</span>]])))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(regressions) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Tissue&#39;</span>,<span class="st">&#39;Intercept&#39;</span>,<span class="st">&#39;Slope&#39;</span>,<span class="st">&#39;P-value&#39;</span>,<span class="st">&#39;SE&#39;</span>,<span class="st">&#39;R-squared&#39;</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&#39;Int Var&#39;</span>,<span class="st">&#39;Slp Var&#39;</span>,<span class="st">&#39;Cov&#39;</span>,<span class="st">&#39;df&#39;</span>,<span class="st">&#39;estimable&#39;</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) regressions[,this.col] <span class="ot">&lt;-</span> <span class="fu">signif</span>(regressions[,this.col], <span class="dv">3</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>regressions <span class="ot">&lt;-</span> regressions[<span class="fu">order</span>(regressions[,<span class="dv">1</span>]),]</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(regressions, <span class="at">caption =</span> <span class="st">&quot;Table 1: The regressions for each tissue, after fup and membrane affinity adjustments, of the log10-transformed measured Kp regressed on</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="st">predicted Kp&quot;</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(regressions,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="fu">paste0</span>(<span class="st">&quot;Pearce2017PCCalibration=&quot;</span>,<span class="fu">Sys.Date</span>(),<span class="st">&quot;.txt&quot;</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep=</span><span class="st">&quot;/t&quot;</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x.cf <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">3.5</span>,.<span class="dv">01</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(tissue <span class="cf">in</span>  <span class="fu">as.character</span>(<span class="fu">unique</span>(pc.table[,<span class="st">&#39;Tissue&#39;</span>])))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  conf <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span><span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;df&#39;</span>]]<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;SE&#39;</span>]] <span class="sc">*</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>(<span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;Int Var&#39;</span>]] <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      x.cf<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;Slp Var&#39;</span>]] <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span> <span class="sc">*</span> x.cf <span class="sc">*</span> <span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;Cov&#39;</span>]] <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  line <span class="ot">&lt;-</span> <span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;Intercept&#39;</span>]] <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      x.cf <span class="sc">*</span> <span class="fu">subset</span>(regressions,Tissue<span class="sc">==</span>tissue)[[<span class="st">&#39;Slope&#39;</span>]]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  y.cf <span class="ot">&lt;-</span> line <span class="sc">+</span> conf</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  y.ncf <span class="ot">&lt;-</span> line <span class="sc">-</span> conf</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  cf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(x.cf),<span class="fu">as.data.frame</span>(y.cf),<span class="fu">as.data.frame</span>(y.ncf))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(tissue <span class="sc">==</span> <span class="st">&#39;Blood Cells&#39;</span>){</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span> <span class="fu">paste</span>(<span class="st">&#39;Blood &lt;- ggplot() + </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_abline(linetype = &quot;dashed&quot;) +</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_point(data=subset(pc.table,Tissue == </span><span class="sc">\&#39;</span><span class="st">&#39;</span>,tissue,<span class="st">&#39;</span><span class="sc">\&#39;</span><span class="st">),aes(10^(Predicted),</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">                               10^(Experimental)))  +  theme(axis.text=element_text(size=14),</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">                               axis.title=element_text(size=14),plot.title=element_text(size=14)) +</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">                               scale_x_log10(label=scientific_10,limits=c(0.01,1000)) + </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">                               scale_y_log10(label=scientific_10,limits=c(0.01,1000)) +</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">                               ylab(ifelse(tissue==&quot;Brain&quot;,expression(paste(&quot;Inferred &quot;,K[p])),&quot;&quot;)) +</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">                               xlab(ifelse(tissue==&quot;Skin&quot;, expression(paste(&quot;Predicted &quot;,K[p])),&quot;&quot;)) +</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.cf))) +</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.ncf))) +</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_abline(intercept=subset(regressions,Tissue==tissue)[[</span><span class="sc">\&#39;</span><span class="st">Intercept</span><span class="sc">\&#39;</span><span class="st">]],</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">                               slope=subset(regressions,Tissue==tissue)[[</span><span class="sc">\&#39;</span><span class="st">Slope</span><span class="sc">\&#39;</span><span class="st">]]) +</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">                               ggtitle(</span><span class="sc">\&#39;</span><span class="st">Red Blood Cells</span><span class="sc">\&#39;</span><span class="st">)&#39;</span>,<span class="at">sep=</span><span class="st">&#39;&#39;</span>)))</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span> <span class="fu">paste</span>(tissue,<span class="st">&#39; &lt;- ggplot() + labs(y=expression(paste(&quot;Measured &quot;,K[p]))</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">                               ,x=expression(paste(&quot;Predicted &quot;,K[p]))) + geom_abline(linetype = &quot;dashed&quot;) +</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_point(data=subset(pc.table,Tissue == </span><span class="sc">\&#39;</span><span class="st">&#39;</span>,tissue,<span class="st">&#39;</span><span class="sc">\&#39;</span><span class="st">),</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="st">                               aes(10^(Predicted),10^(Experimental))) + theme(axis.text=element_text(size=14),</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st">                               axis.title=element_text(size=14),plot.title=element_text(size=14)) +</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="st">                               scale_x_log10(label=scientific_10,limits=c(0.01,1000)) + </span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">                               scale_y_log10(label=scientific_10,limits=c(0.01,1000)) +</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="st">                               ylab(ifelse(tissue==&quot;Brain&quot;,expression(paste(&quot;Inferred &quot;,K[p])),&quot;&quot;)) +</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">                               xlab(ifelse(tissue==&quot;Skin&quot;, expression(paste(&quot;Predicted &quot;,K[p])),&quot;&quot;)) + </span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.cf))) +</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.ncf))) +</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="st">                               geom_abline(intercept=subset(regressions,Tissue==tissue)[[</span><span class="sc">\&#39;</span><span class="st">Intercept</span><span class="sc">\&#39;</span><span class="st">]],</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="st">                               slope=subset(regressions,Tissue==tissue)[[</span><span class="sc">\&#39;</span><span class="st">Slope</span><span class="sc">\&#39;</span><span class="st">]]) +</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="st">                               ggtitle(</span><span class="sc">\&#39;</span><span class="st">&#39;</span>,tissue,<span class="st">&#39;</span><span class="sc">\&#39;</span><span class="st">)&#39;</span>,<span class="at">sep=</span><span class="st">&#39;&#39;</span>)))</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(Adipose, Blood, Bone, Brain, Gut, Heart, Kidney, Liver, Lung, Muscle, Skin, Spleen, <span class="at">nrow=</span><span class="dv">4</span>)</span></code></pre></div>
<p>In vivo volume of distribution data are compared with the
predictions, and errors are calculated. Regressions and improvements are
calculated and plotted.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>obach <span class="ot">&lt;-</span> <span class="fu">subset</span>(Obach2008,CAS <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&#39;schmitt&#39;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>vd.table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(this.cas <span class="cf">in</span> obach[,<span class="st">&#39;CAS&#39;</span>]){</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">parameterize_schmitt</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  init.parameters <span class="ot">&lt;-</span> parameters</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>this.cas <span class="sc">%in%</span> ma.data.list){</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    init.parameters<span class="sc">$</span>MA <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.999831</span> <span class="sc">-</span> <span class="fl">0.016578</span><span class="sc">*</span><span class="dv">37</span> <span class="sc">+</span> <span class="fl">0.881721</span> <span class="sc">*</span> <span class="fu">log10</span>(parameters<span class="sc">$</span>Pow))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>parameters,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">regression=</span><span class="cn">FALSE</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  init.pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>init.parameters,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">regression=</span><span class="cn">FALSE</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  reg.pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>parameters,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">regression=</span><span class="cn">TRUE</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  vdist <span class="ot">&lt;-</span> <span class="fu">calc_vdist</span>(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span><span class="fu">c</span>(pcs,<span class="at">Funbound.plasma=</span>parameters<span class="sc">$</span>Funbound.plasma),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  init.vdist <span class="ot">&lt;-</span> <span class="fu">calc_vdist</span>(</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span><span class="fu">c</span>(</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>      init.pcs,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">Funbound.plasma=</span>parameters<span class="sc">$</span>unadjusted.Funbound.plasma),</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  reg.vdist <span class="ot">&lt;-</span> <span class="fu">calc_vdist</span>(</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span><span class="fu">c</span>(reg.pcs,<span class="at">Funbound.plasma=</span>parameters<span class="sc">$</span>Funbound.plasma),</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  vd.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    vd.table,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(this.cas),<span class="fu">as.data.frame</span>(<span class="fu">log10</span>(init.vdist)),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(vdist)),<span class="fu">as.data.frame</span>(<span class="fu">log10</span>(reg.vdist)),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(<span class="fu">log10</span>(<span class="fu">subset</span>(obach,CAS<span class="sc">==</span>this.cas)[[<span class="st">&#39;VDss (L/kg)&#39;</span>]]))))</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(vd.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;CAS&#39;</span>,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;init.vdist&#39;</span>,</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;corrected.vdist&#39;</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;calibrated.vdist&#39;</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Experimental&#39;</span>)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>init.error <span class="ot">&lt;-</span> vd.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> vd.table[,<span class="st">&#39;init.vdist&#39;</span>]</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>correction.error <span class="ot">&lt;-</span> vd.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> vd.table[,<span class="st">&#39;corrected.vdist&#39;</span>]</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>calibration.error <span class="ot">&lt;-</span> vd.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="sc">-</span> vd.table[,<span class="st">&#39;calibrated.vdist&#39;</span>]</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>correction.improvement <span class="ot">&lt;-</span> <span class="fu">abs</span>(init.error) <span class="sc">-</span> <span class="fu">abs</span>(correction.error)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>calibration.improvement <span class="ot">&lt;-</span> <span class="fu">abs</span>(correction.error) <span class="sc">-</span> <span class="fu">abs</span>(calibration.error)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>vd.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(vd.table,correction.improvement,calibration.improvement,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                  init.error,correction.error,calibration.error)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Experimental <span class="sc">~</span> calibrated.vdist,<span class="at">data=</span>vd.table)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>smry <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>calibrated.reg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[<span class="st">&#39;(Intercept)&#39;</span>]),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[<span class="st">&#39;calibrated.vdist&#39;</span>]),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>coefficients[<span class="st">&#39;calibrated.vdist&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>sigma),<span class="fu">as.data.frame</span>(smry<span class="sc">$</span>r.squared))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Experimental <span class="sc">~</span> init.vdist,<span class="at">data=</span>vd.table)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>smry <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>init.reg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[<span class="st">&#39;(Intercept)&#39;</span>]),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[<span class="st">&#39;init.vdist&#39;</span>]),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>coefficients[<span class="st">&#39;init.vdist&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>sigma),<span class="fu">as.data.frame</span>(smry<span class="sc">$</span>r.squared))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Experimental <span class="sc">~</span> corrected.vdist,<span class="at">data=</span>vd.table)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>smry <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>corrected.reg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[<span class="st">&#39;(Intercept)&#39;</span>]),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.data.frame</span>(fit<span class="sc">$</span>coefficients[<span class="st">&#39;corrected.vdist&#39;</span>]),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>coefficients[<span class="st">&#39;corrected.vdist&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.data.frame</span>(smry<span class="sc">$</span>sigma),<span class="fu">as.data.frame</span>(smry<span class="sc">$</span>r.squared))</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(init.reg) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(corrected.reg) <span class="ot">&lt;-</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(calibrated.reg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Intercept&#39;</span>,<span class="st">&#39;Slope&#39;</span>,<span class="st">&#39;P-value&#39;</span>,<span class="st">&#39;Std Err&#39;</span>,<span class="st">&#39;R-squared&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>init.vd.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vd.table,<span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(init.vdist),<span class="dv">10</span><span class="sc">^</span>(Experimental))) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> init.reg[[<span class="st">&#39;Intercept&#39;</span>]], <span class="at">slope =</span> init.reg[[<span class="st">&quot;Slope&quot;</span>]]) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Predicted Volume of Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Measured Volume of Distribution&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="fl">8.5</span>))) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="fl">8.5</span>))) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(init.vd.plot)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>correction.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>vd.table[<span class="fu">order</span>(vd.table[,<span class="st">&#39;correction.improvement&#39;</span>],<span class="at">decreasing=</span>F),],</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(corrected.vdist),<span class="dv">10</span><span class="sc">^</span>(Experimental),<span class="at">color=</span>correction.improvement)) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> corrected.reg[[<span class="st">&#39;Intercept&#39;</span>]],<span class="at">slope =</span> corrected.reg[[<span class="st">&quot;Slope&quot;</span>]]) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Predicted Volume of Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Measured Volume of Distribution&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),<span class="at">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="dv">3</span>))) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&#39;(B)&#39;</span>) <span class="sc">+</span> <span class="fu">scale_color_viridis</span>(<span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">option=</span><span class="st">&#39;inferno&#39;</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correction.plot)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>calibration.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>vd.table[<span class="fu">order</span>(vd.table[,<span class="st">&#39;calibration.improvement&#39;</span>],<span class="at">decreasing=</span>F),],</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="dv">10</span><span class="sc">^</span>(calibrated.vdist),<span class="dv">10</span><span class="sc">^</span>(Experimental),<span class="at">color=</span>calibration.improvement)) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> calibrated.reg[[<span class="st">&#39;Intercept&#39;</span>]],<span class="at">slope =</span> calibrated.reg[[<span class="st">&quot;Slope&quot;</span>]]) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Predicted Volume of Distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Measured Volume of Distribution&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),<span class="at">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="dv">3</span>))) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="sc">^</span>(<span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&#39;(C)&#39;</span>) <span class="sc">+</span> <span class="fu">scale_color_viridis</span>(<span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">option=</span><span class="st">&#39;inferno&#39;</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calibration.plot)</span></code></pre></div>
<p>Now we pull in the in vivo blood to plasma ratios, use these to
calculate the inferred red blood cell to plasma ratios, and then make
predictions for these values. A censored regressions is performed, and
predictions are plotted against errors.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>rb2p.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,<span class="sc">!</span><span class="fu">is.na</span>(Human.Rblood2plasma))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>measured.rb2p <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>measured.krbc <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>predicted.rb2p <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>predicted.krbc <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>cas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>charge <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>fup <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>logP <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>pka_donor <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>pka_accept <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(this.cas <span class="cf">in</span> rb2p.data[rb2p.data[,<span class="st">&#39;CAS&#39;</span>] <span class="sc">%in%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&#39;schmitt&#39;</span>, <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>),<span class="st">&#39;CAS&#39;</span>])</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  rb2p <span class="ot">&lt;-</span> <span class="fu">get_rblood2plasma</span>(<span class="at">chem.cas=</span>this.cas)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  krbc <span class="ot">&lt;-</span> (rb2p <span class="sc">+</span> .<span class="dv">44</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fl">0.44</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  measured.rb2p <span class="ot">&lt;-</span> <span class="fu">c</span>(measured.rb2p,rb2p)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  measured.krbc <span class="ot">&lt;-</span> <span class="fu">c</span>(measured.krbc,krbc)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  parameters <span class="ot">&lt;-</span> <span class="fu">parameterize_schmitt</span>(</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters=</span>parameters,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  predicted.krbc <span class="ot">&lt;-</span> <span class="fu">c</span>(predicted.krbc,pcs[[<span class="st">&#39;Krbc2pu&#39;</span>]] <span class="sc">*</span> parameters<span class="sc">$</span>Funbound.plasma)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  cas <span class="ot">&lt;-</span> <span class="fu">c</span>(cas,this.cas)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  charge <span class="ot">&lt;-</span> <span class="fu">c</span>(charge,<span class="fu">calc_ionization</span>(<span class="at">chem.cas=</span>this.cas,<span class="at">pH=</span><span class="fl">7.4</span>)<span class="sc">$</span>fraction_charged)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  fup <span class="ot">&lt;-</span> <span class="fu">c</span>(fup,parameters<span class="sc">$</span>unadjusted.Funbound.plasma)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  logP <span class="ot">&lt;-</span>  <span class="fu">c</span>(logP,<span class="fu">log10</span>(parameters<span class="sc">$</span>Pow))</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  pka_donor <span class="ot">&lt;-</span> <span class="fu">c</span>(pka_donor,<span class="fu">paste</span>(parameters<span class="sc">$</span>pKa_Donor,<span class="at">collapse=</span><span class="st">&#39;,&#39;</span>))</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  pka_accept <span class="ot">&lt;-</span> <span class="fu">c</span>(pka_accept,<span class="fu">paste</span>(parameters<span class="sc">$</span>pKa_Accept,<span class="at">collapse=</span><span class="st">&#39;,&#39;</span>))</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>predicted.rb2p <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.44</span> <span class="sc">+</span> <span class="fl">0.44</span> <span class="sc">*</span> predicted.krbc</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>rb2p.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(cas),<span class="fu">as.data.frame</span>(predicted.rb2p),<span class="fu">as.data.frame</span>(measured.rb2p))</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rb2p.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;cas&#39;</span>,<span class="st">&#39;predicted.rb2p&#39;</span>,<span class="st">&#39;measured.rb2p&#39;</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">log10</span>(rb2p.table[,<span class="st">&#39;measured.rb2p&#39;</span>]) <span class="sc">-</span> <span class="fu">log10</span>(rb2p.table[,<span class="st">&#39;predicted.rb2p&#39;</span>])</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>rb2p.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rb2p.table,error,charge,fup,logP)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">log10</span>(measured.krbc) <span class="sc">-</span>  <span class="fu">log10</span>(predicted.krbc)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>krbc.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(cas),<span class="fu">as.data.frame</span>(predicted.krbc),<span class="fu">as.data.frame</span>(measured.krbc),</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">as.data.frame</span>(error),charge,fup,logP,pka_donor,pka_accept)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pdta <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> predicted.krbc,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> measured.krbc)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pdta<span class="sc">$</span>y[pdta<span class="sc">$</span>y <span class="sc">&lt;=</span> <span class="fl">0.1</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>pdta<span class="sc">$</span>Censoring <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;Not Censored&quot;</span>,<span class="st">&quot;Censored&quot;</span>)[<span class="fu">as.numeric</span>(pdta<span class="sc">$</span>y <span class="sc">&lt;=</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> measured.krbc</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(y)),<span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(predicted.krbc))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Predicted&quot;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(y <span class="sc">&lt;=</span> <span class="fl">0.1</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>y[y <span class="sc">&lt;</span> <span class="fl">0.1</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(y)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">censReg</span>(y<span class="sc">~</span>x, <span class="at">data =</span> pdta, <span class="at">left=</span><span class="fl">0.1</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>betas <span class="ot">&lt;-</span> out<span class="sc">$</span>estimate</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>censored.regression <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>pdta,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y, <span class="at">color=</span>Censoring)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(.<span class="dv">0009</span>,<span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(.<span class="dv">1</span>,<span class="dv">4</span>),<span class="at">breaks=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,<span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Inferred &quot;</span>,K[p])),<span class="at">x=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p]))) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust=</span><span class="fl">0.5</span>),<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.11</span>, .<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span>out<span class="sc">$</span>betas[<span class="dv">2</span>],<span class="at">intercept=</span><span class="sc">-</span>out<span class="sc">$</span>betas[<span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&#39;(B)&#39;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(censored.regression)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>rb2p.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rb2p.table,<span class="fu">aes</span>(predicted.rb2p,measured.rb2p)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()  <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">lim=</span><span class="fu">c</span>(.<span class="dv">52</span>,<span class="dv">18</span>)) <span class="sc">+</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">lim=</span><span class="fu">c</span>(.<span class="dv">52</span>,<span class="fl">2.5</span>),<span class="at">breaks=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Measured Whole Blood &quot;</span>,K[p])),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Predicted Whole Blood &quot;</span>,K[p]))) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>,<span class="at">hjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rb2p.plot)</span></code></pre></div>
<p>Lastly, we make the heatmap.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>heatmap.table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(this.cas <span class="cf">in</span> <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&#39;schmitt&#39;</span>)){</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    parms <span class="ot">&lt;-</span> <span class="fu">parameterize_schmitt</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameters=</span>parms, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    heatmap.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(heatmap.table,<span class="fu">log10</span>(<span class="fu">unlist</span>(pcs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>]<span class="sc">*</span>parms<span class="sc">$</span>Funbound.plasma))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(heatmap.table) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&#39;Adipose&#39;</span>,<span class="st">&#39;Bone&#39;</span>,<span class="st">&#39;Brain&#39;</span>,<span class="st">&#39;Gut&#39;</span>,<span class="st">&#39;Heart&#39;</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Kidney&#39;</span>,<span class="st">&#39;Liver&#39;</span>,<span class="st">&#39;Lung&#39;</span>,<span class="st">&#39;Muscle&#39;</span>,<span class="st">&#39;Skin&#39;</span>,<span class="st">&#39;Spleen&#39;</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(heatmap.table) <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="fu">dim</span>(heatmap.table)[<span class="dv">2</span>])</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="cf">function</span> (n, <span class="at">h =</span> <span class="fu">c</span>(<span class="dv">260</span>, <span class="sc">-</span><span class="dv">328</span>), <span class="at">c =</span> <span class="dv">80</span>, <span class="at">l =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">100</span>), <span class="at">power =</span> <span class="fl">1.5</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixup =</span> <span class="cn">TRUE</span>, <span class="at">gamma =</span> <span class="cn">NULL</span>, <span class="at">alpha =</span> <span class="dv">1</span>, ...)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(gamma))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;&#39;gamma&#39; is deprecated and has no effect&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n <span class="sc">&lt;</span> 1L)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">character</span>(0L))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>   h <span class="ot">&lt;-</span> <span class="fu">rep</span>(h, <span class="at">length.out =</span> 2L)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> c[1L]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="fu">rep</span>(l, <span class="at">length.out =</span> 2L)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    power <span class="ot">&lt;-</span> <span class="fu">rep</span>(power, <span class="at">length.out =</span> 2L)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    rval <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> n)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    rval <span class="ot">&lt;-</span> <span class="fu">hex</span>(<span class="fu">polarLUV</span>(<span class="at">L =</span> l[2L] <span class="sc">-</span> <span class="fu">diff</span>(l) <span class="sc">*</span> <span class="fu">abs</span>(rval)<span class="sc">^</span>power[2L],</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">C =</span> c <span class="sc">*</span> <span class="fu">abs</span>(rval)<span class="sc">^</span>power[1L], <span class="at">H =</span> <span class="fu">ifelse</span>(rval <span class="sc">&gt;</span> <span class="dv">0</span>, h[1L],</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>            h[2L])), <span class="at">fixup =</span> fixup, ...)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">missing</span>(alpha)) {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fu">pmin</span>(alpha, <span class="dv">1</span>), <span class="dv">0</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">as.hexmode</span>(<span class="fu">round</span>(alpha <span class="sc">*</span> <span class="dv">255</span> <span class="sc">+</span> <span class="fl">1e-04</span>)),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">width =</span> 2L, <span class="at">upper.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        rval <span class="ot">&lt;-</span> <span class="fu">paste</span>(rval, alpha, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(rval)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>hclust.ave <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">hclust</span>(x, <span class="at">method=</span><span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(heatmap.table,<span class="at">col=</span>pal,<span class="at">trace=</span><span class="st">&quot;none&quot;</span>, <span class="at">hclustfun=</span>hclust.ave,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">key.xlab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;log10 &quot;</span>,K[p],<span class="st">&quot; Value&quot;</span>)),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">key.ylab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of &quot;</span>,K[p])),</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">key.title=</span><span class="st">&quot;Partition Coefficient&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Chemicals&quot;</span>,<span class="at">cex.lab=</span><span class="dv">2</span>,<span class="at">margins=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
