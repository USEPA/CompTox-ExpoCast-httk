<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dustin F. Kapraun, Mark Sfeir, Robert Pearce, Sarah Davidson, Annie Lumen, Andre Dallmann, Richard Judson, and John F. Wambaugh" />

<meta name="date" content="2025-01-13" />

<title>Kapraun et al. (2022): Generic Human Gestational Model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Kapraun et al. (2022): Generic Human
Gestational Model</h1>
<h4 class="author">Dustin F. Kapraun, Mark Sfeir, Robert Pearce, Sarah
Davidson, Annie Lumen, Andre Dallmann, Richard Judson, and John F.
Wambaugh</h4>
<h4 class="date">2025-01-13</h4>



<p><em>Please send questions to <a href="mailto:wambaugh.john@epa.gov" class="email">wambaugh.john@epa.gov</a></em></p>
<p>from “Evaluation of a Rapid, Generic Human Gestational Dose
Model”</p>
<p>Dustin F.Kapraun, Mark Sfeir, Robert Pearce, Sarah Davidson, Annie
Lumen, Andre Dallmann, Richard Judson, John F.Wambaugh</p>
<p>Reproductive Toxicology, 2022</p>
<p><a href="https://doi.org/10.1016/j.reprotox.2022.09.004" class="uri">https://doi.org/10.1016/j.reprotox.2022.09.004</a></p>
<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>Chemical risk assessment considers potentially susceptible
populations including pregnant women and developing fetuses. Humans
encounter thousands of chemicals in their environments, few of which
have been fully characterized in terms of internal human dosimetry and
mode-of-action. Toxicokinetic (TK) information is needed to relate
chemical exposure to potentially bioactive tissue concentrations.
Observational data describing human gestational exposures are
unavailable for most chemicals, but physiologically based TK (PBTK)
models estimate such exposures. However, development of
chemical-specific PBTK models themselves requires considerable time and
resources. As an alternative, generic PBTK approaches describe a
standardized physiology and characterize chemicals with a set of
standard physical and TK descriptors – primarily plasma protein binding
and hepatic clearance. Here we report and evaluate a generic PBTK model
of a human mother and developing fetus. We used a previously published
set of formulas describing the major anatomical and physiological
changes that occur during pregnancy to augment the High-Throughput
Toxicokinetics (httk) software package. We performed simulations to
estimate the ratio of concentrations in maternal and fetal plasma and
compared these estimatesto literature in vivo measurements. We evaluated
the model with literature in vivo time-course measurements of maternal
plasma concentrations in pregnant and non-pregnant women. Finally, we
demonstrated conceptual prioritization of chemicals measured in maternal
serum based on predicted fetal brain concentrations. This new generic
model can be used for TK simulations of any of the 856 chemicals with
existing human-specific in vitro data that were found to be within the
domain of the model, as well as any new chemicals for which such data
become available. With sufficient evaluation, this gestational model may
allow for in vitro to in vivo extrapolation of point of departure doses
relevant to reproductive and developmental toxicity.</p>
</div>
<div id="httk-version" class="section level2">
<h2>HTTK Version</h2>
<p>This vignette was created with <strong>httk</strong> v2.1.0. Although
we attempt to maintain backward compatibility, if you encounter issues
with the latest release of <strong>httk</strong> and cannot easily
address the changes, historical versions of httk are available from: <a href="https://cran.r-project.org/src/contrib/Archive/httk/" class="uri">https://cran.r-project.org/src/contrib/Archive/httk/</a></p>
</div>
<div id="prepare-for-session" class="section level2">
<h2>Prepare for session</h2>
<p>R package <strong>knitr</strong> generates html and PDF documents
from this RMarkdown file, Each bit of code that follows is known as a
“chunk”. We start by telling <strong>knitr</strong> how we want our
chunks to look.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">collapse =</span> <span class="cn">TRUE</span>, <span class="at">comment =</span> <span class="st">&#39;#&gt;&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">rmarkdown.html_vignette.check_title =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="clear-the-memory" class="section level3">
<h3>Clear the memory</h3>
<p>It is a bad idea to let variables and other information from previous
R sessions float around, so we first remove everything in the R
memory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) </span></code></pre></div>
</div>
<div id="eval-execute.vignette" class="section level3">
<h3>eval = execute.vignette</h3>
<p>If you are using the RMarkdown version of this vignette (extension,
.RMD) you will be able to see that several chunks of code in this
vignette have the statement “eval = execute.vignette”. The next chunk of
code, by default, sets execute.vignette = FALSE. This means that the
code is included (and necessary) but was not run when the vignette was
built. We do this because some steps require extensive computing time
and the checks on CRAN limit how long we can spend building the package.
If you want this vignette to work, you must run all code, either by
cutting and pasting it into R. Or, if viewing the .RMD file, you can
either change execute.vignette to TRUE or press “play” (the green arrow)
on each chunk in RStudio.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set whether or not the following chunks will be executed (run):</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>execute.vignette <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<div id="load-the-relevant-libraries" class="section level3">
<h3>Load the relevant libraries</h3>
<p>We use the command ‘library()’ to load various R packages for our
analysis. If you get the message “Error in library(X) : there is no
package called ‘X’” then you will need to install that package:</p>
<p>From the R command prompt:</p>
<p>install.packages(“X”)</p>
<p>Or, if using RStudio, look for ‘Install Packages’ under ‘Tools’
tab.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#library(readxl)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httk)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
</div>
<div id="prepare-custom-functions" class="section level3">
<h3>Prepare custom functions</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                                  </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="fu">scientific_format</span>()(x))              </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">parse</span>(<span class="at">text=</span><span class="fu">gsub</span>(<span class="st">&quot;10</span><span class="sc">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="number-of-chemicals" class="section level1">
<h1>Number of chemicals</h1>
<p>The number of chemicals with in vitro TK data (<span class="math inline">\(Cl_{int}\)</span> and <span class="math inline">\(f_{up}\)</span>) that are also non-volatile and
non-PFAS can be found using:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,<span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<p>Data sets were curated from the literature to allow evaluation of the
gestational PBTK model. In all cases chemical identities from the
original publications were mapped onto DTXSID’s from the CompTox
Chemicals Dashboard (<a href="https://comptox.epa.gov/dashboard" class="uri">https://comptox.epa.gov/dashboard</a>) [Williams et al.,
2017] (<a href="https://doi.org/10.1186/s13321-017-0247-6" class="uri">https://doi.org/10.1186/s13321-017-0247-6</a>). Statistical
testing for correlation between predictions and observations was
performed using R function “lm” and p-values were calculated according
to an F-distribution.</p>
</div>
<div id="aylward-cord-blood-data" class="section level1">
<h1>Aylward cord-blood data</h1>
<p><a href="http://dx.doi.org/10.1080/10937404.2014.884956">Aylward et
al., 2014</a> compiled measurements of the ratio of maternal to fetal
cord blood chemical concentrations at birth for a range of chemicals
with environmental routes of exposure, including bromodiphenyl ethers,
fluorinated compounds, organochlorine pesticides, polyaromatic
hydrocarbons, tobacco smoke components, and vitamins. The PBTK model
does not have an explicit cord blood compartment, so the ratio between
maternal and fetal venous plasma concentrations was used as a surrogate
when making comparisons of model predictions to these data.. For each
chemical three daily oral doses (every eight hours) total 1 mg/kg/day
were simulated starting from the 13th week of gestation until full term
(40 weeks). Simulations were made both with and without the correction
to <span class="math inline">\(f_{up}^f\)</span>.</p>
<div id="loadformat-the-data" class="section level2">
<h2>Load/format the data</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MFdata &lt;- read_excel(&quot;Aylward-MatFet.xlsx&quot;)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>MFdata <span class="ot">&lt;-</span> httk<span class="sc">::</span>aylward2014</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;summarized data from over 100 studies covering &quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">unique</span>(MFdata<span class="sc">$</span>DTXSID)[<span class="sc">!</span>(<span class="fu">unique</span>(MFdata<span class="sc">$</span>DTXSID)<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;-&quot;</span>))]),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; unique chemicals structures</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We don&#39;t want to exclude the volatiles and PFAS at this point:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>MFdata.httk <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata,DTXSID <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>Chemical.Category<span class="sc">==</span><span class="st">&quot;bromodiphenylethers&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Chemical.Category&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Bromodiphenylethers&quot;</span>  </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>Chemical.Category<span class="sc">==</span><span class="st">&quot;organochlorine Pesticides&quot;</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Chemical.Category&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Organochlorine Pesticides&quot;</span>  </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>Chemical.Category<span class="sc">==</span><span class="st">&quot;polyaromatic hydrocarbons&quot;</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Chemical.Category&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>  </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MFdata.httk)[<span class="fu">colnames</span>(MFdata.httk) <span class="sc">==</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;infant.maternal.conc...Central.tendency..calculate.j.k..or.report.paired.result.&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;MFratio&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MFdata.httk)[<span class="fu">colnames</span>(MFdata.httk) <span class="sc">==</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;PREFERRED_NAME&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Chemical&quot;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MFdata.httk)[<span class="fu">colnames</span>(MFdata.httk) <span class="sc">==</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;details.on.matrix.comparison...e.g...cord.blood.lipid..maternal.serum.lipid..or.cord.blood.wet.weight..maternal.whole.blood.wet.weight&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Matrix&quot;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the columns:</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>MFratio <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(MFdata.httk<span class="sc">$</span>MFratio)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>Chemical <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(MFdata.httk<span class="sc">$</span>Chemical)  </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>Matrix <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(MFdata.httk<span class="sc">$</span>Chemical)  </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>Chemical.Category <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(MFdata.httk<span class="sc">$</span>Chemical.Category)  </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MFdata.httk)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">&quot;infant&quot;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MFdata.httk)[<span class="dv">16</span>] <span class="ot">&lt;-</span> <span class="st">&quot;maternal&quot;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(MFdata.httk)[<span class="dv">17</span>] <span class="ot">&lt;-</span> <span class="st">&quot;obs.units&quot;</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>infant <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(MFdata.httk<span class="sc">$</span>infant))</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>maternal <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(MFdata.httk<span class="sc">$</span>maternal))</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>MFdata.httk<span class="sc">$</span>AVERAGE_MASS <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(MFdata.httk<span class="sc">$</span>AVERAGE_MASS)</span></code></pre></div>
</div>
<div id="convert-the-units" class="section level2">
<h2>Convert the units:</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>convert1.units <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ng/ml&quot;</span>,<span class="st">&quot;ng/mL&quot;</span>,<span class="st">&quot;ug/L&quot;</span>,<span class="st">&quot;ug/l&quot;</span>,<span class="st">&quot;ng/mL serum&quot;</span>,<span class="st">&quot;ng/g&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ng/g wet wt.&quot;</span>,<span class="st">&quot;ppb&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;infant&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;infant&quot;</span>] <span class="sc">/</span> <span class="co"># ng/ml = ug/L</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;maternal&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;maternal&quot;</span>] <span class="sc">/</span> <span class="co"># ng/ml = ug/L</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert1.units,<span class="st">&quot;obs.units&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;uM&quot;</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>convert2.units <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mg/L&quot;</span>,<span class="st">&quot;ppm&quot;</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;infant&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;infant&quot;</span>] <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="co"># mg/L = ug/L</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;maternal&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;maternal&quot;</span>]<span class="sc">*</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="co"># mg/L = ug/L</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;AVERAGE_MASS&quot;</span>]  <span class="co"># ug/L -&gt; uM</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>MFdata.httk[MFdata.httk<span class="sc">$</span>obs.units<span class="sc">%in%</span>convert2.units,<span class="st">&quot;obs.units&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;uM&quot;</span> </span></code></pre></div>
</div>
<div id="compare-httk-predictions-with-maternalfetal-observations-from-aylward-2014" class="section level2">
<h2>Compare HTTK predictions with maternal:fetal observations from
Aylward 2014</h2>
<p>Note that we can’t do an absolute scale comparison (for example,
fetal:fetal or maternal:maternal) because we don’t know the dose for the
Aylward data but we assume that the maternal:fetal ratio is independent
of dose and so we use the plasma ratio at full term (40 weeks) resulting
from a 1 mg/kg/day exposure rate starting in week 13.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate starting from the 13th week of gestation until full term (40 weeks):</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">13</span> <span class="sc">*</span> <span class="dv">7</span>, <span class="dv">40</span> <span class="sc">*</span> <span class="dv">7</span>, <span class="fl">0.25</span>),<span class="fu">seq</span>(<span class="dv">278</span>,<span class="dv">280</span>,.<span class="dv">1</span>))))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For each chemical with maternal-fetal ratio data and HTTK in vitro data:  </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(MFdata.httk<span class="sc">$</span>DTXSID))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(this.id)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">parameterize_steadystate</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># skip chemicals where Fup is 0:  </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p<span class="sc">$</span>Funbound.plasma<span class="sc">&gt;</span><span class="fl">1e-4</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the chemical-specifc paramaters:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">fetal_fup_adjustment =</span><span class="cn">TRUE</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skip chemicals where the 95% credible interval for Fup spans more than 0.1 to</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0.9 (that is, Fup is effectively unknown):</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(p<span class="sc">$</span>Funbound.plasma.dist))</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(p<span class="sc">$</span>Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fl">0.9</span> <span class="sc">&amp;</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(p<span class="sc">$</span>Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="sc">&lt;</span><span class="fl">0.11</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>skip)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Solve the PBTK equations for the full simulation time assuming 1 total daily</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># dose of 1 mg/kg/day spread out over three evenly spaces exposures:</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      out <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameters=</span>p,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">dose=</span><span class="dv">0</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">times=</span>times,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">doses.per.day=</span><span class="dv">3</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">output.units =</span> <span class="st">&quot;uM&quot;</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Identify the concentrations from the final (279th) day:</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>      last.row <span class="ot">&lt;-</span> <span class="fu">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="sc">&gt;</span><span class="dv">279</span>)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      last.row <span class="ot">&lt;-</span> last.row[<span class="sc">!</span><span class="fu">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Average over the final day:</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      MFdata.httk[MFdata.httk<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Mat.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>      MFdata.httk[MFdata.httk<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Fet.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>      MFdata.httk[MFdata.httk<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;MFratio.pred&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="sc">/</span><span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Repeat the analysis without the adjustment to fetal Fup:</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">fetal_fup_adjustment =</span><span class="cn">FALSE</span>,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>      out <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameters=</span>p,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">dose=</span><span class="dv">0</span>,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">times=</span>times,</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">doses.per.day=</span><span class="dv">3</span>,</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">output.units =</span> <span class="st">&quot;uM&quot;</span>,</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxsteps=</span><span class="fl">1e7</span>,</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>      last.row <span class="ot">&lt;-</span> <span class="fu">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="sc">&gt;</span><span class="dv">279</span>) <span class="co"># The whole final day</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>      last.row <span class="ot">&lt;-</span> last.row[<span class="sc">!</span><span class="fu">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>      MFdata.httk[MFdata.httk<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Mat.pred.nofup&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>      MFdata.httk[MFdata.httk<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Fet.pred.nofup&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>      MFdata.httk[MFdata.httk<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;MFratio.pred.nofup&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="sc">/</span><span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Something is wrong with cotinine:</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>MFdata.httk <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata.httk,Chemical<span class="sc">!=</span><span class="st">&quot;Cotinine&quot;</span>)</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>max.chem <span class="ot">&lt;-</span> MFdata.httk[<span class="fu">which</span>(MFdata.httk<span class="sc">$</span>MFratio<span class="sc">==</span><span class="fu">max</span>(MFdata.httk<span class="sc">$</span>MFratio)),]</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>min.chem <span class="ot">&lt;-</span> MFdata.httk[<span class="fu">which</span>(MFdata.httk<span class="sc">$</span>MFratio<span class="sc">==</span><span class="fu">min</span>(MFdata.httk<span class="sc">$</span>MFratio)),]</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;The minimum observed ratio was &quot;</span>,</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(min.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>  min.chem[,<span class="st">&quot;Chemical&quot;</span>],</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; and the maximum was &quot;</span>,</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(max.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>  max.chem[,<span class="st">&quot;Chemical&quot;</span>],</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
</div>
<div id="aylward-ratio-figures" class="section level2">
<h2>Aylward Ratio figures:</h2>
<div id="clean-up-repeated-observations" class="section level3">
<h3>Clean up repeated observations:</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MFdata.main <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>MFdata.outliers <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(MFdata.httk<span class="sc">$</span>DTXSID))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata.httk,DTXSID<span class="sc">==</span>this.id)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> this.subset[<span class="dv">1</span>,]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  this.row<span class="sc">$</span>N.obs <span class="ot">&lt;-</span> <span class="fu">dim</span>(this.subset)[<span class="dv">1</span>]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  this.row<span class="sc">$</span>MFratio <span class="ot">&lt;-</span> <span class="fu">median</span>(this.subset<span class="sc">$</span>MFratio)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  this.row<span class="sc">$</span>MFratio.Q25 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(this.subset<span class="sc">$</span>MFratio,<span class="fl">0.25</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  this.row<span class="sc">$</span>MFratio.Q75 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(this.subset<span class="sc">$</span>MFratio,<span class="fl">0.75</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  MFdata.main <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MFdata.main,this.row)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.subset,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    MFratio<span class="sc">&lt;</span>this.row<span class="sc">$</span>MFratio.Q25 <span class="sc">|</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    MFratio<span class="sc">&gt;</span>this.row<span class="sc">$</span>MFratio.Q75)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  MFdata.outliers <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MFdata.outliers,this.subset) </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="cord-blood-ratio-predictions-without-fup-adjustement" class="section level3">
<h3>Cord Blood Ratio Predictions without Fup Adjustement:</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>FigCa  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>MFdata.main) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">color=</span><span class="st">&quot;grey&quot;</span>,<span class="fu">aes</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MFratio.pred.nofup,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>MFratio.Q25,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend=</span>MFratio.pred.nofup,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend=</span>MFratio.Q75))<span class="sc">+</span>    </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MFratio.pred.nofup,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>MFratio,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Chemical.Category,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Chemical.Category),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">4</span>)   <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>,<span class="dv">2</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">5</span>, <span class="dv">6</span>))<span class="sc">+</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>MFdata.outliers,<span class="fu">aes</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MFratio.pred.nofup,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>MFratio,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Chemical.Category,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Chemical.Category),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">2</span>)   <span class="sc">+</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_text(aes(x=AUC,y=Critical.concentration,label=Compound.abbrev,color=Chemical)) +</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_log10(label=scientific_10) +</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#,limits=c(10^-7,100)) +</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(label=scientific_10) +</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   ,limits=c(10^-7,100)) +</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#    annotation_logticks() + </span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_abline(slope=1, intercept=1,linetype=&quot;dashed&quot;) + </span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_abline(slope=1, intercept=-1,linetype=&quot;dashed&quot;) + </span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; Mat:Fet Plasma Ratio&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Generic PBTK Predicted Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) + </span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))<span class="sc">+</span> </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Class&quot;</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))<span class="sc">+</span> </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Class&quot;</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigCa)</span></code></pre></div>
</div>
<div id="generate-text-for-results-section" class="section level3">
<h3>Generate text for results section:</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;In Figure 4 we compare predictions made with our high-throughput \</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">human gestational PBTK model with experimental observations on a per chemical \</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">basis wherever we had both in vitro HTTK data and in vivo observations (&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(MFdata.main<span class="sc">$</span>DTXSID)),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot; chemicals).</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>repeats <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata.main,N.obs<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;Multiple observations were available for &quot;</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(repeats)[<span class="dv">1</span>],</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; of the chemicals,</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>max.chem <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(repeats[<span class="fu">which</span>(repeats<span class="sc">$</span>MFratio<span class="sc">==</span><span class="fu">max</span>(repeats<span class="sc">$</span>MFratio)),])</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>min.chem <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(repeats[<span class="fu">which</span>(repeats<span class="sc">$</span>MFratio<span class="sc">==</span><span class="fu">min</span>(repeats<span class="sc">$</span>MFratio)),])</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;However, among the chemicals with repeated observations, the median \</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="st">observations only ranged from &quot;</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(min.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  min.chem[,<span class="st">&quot;Chemical&quot;</span>],</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; to &quot;</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(max.chem[,<span class="st">&quot;MFratio&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  max.chem[,<span class="st">&quot;Chemical&quot;</span>],</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>max.chem <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(MFdata.main[<span class="fu">which</span>(MFdata.main<span class="sc">$</span>MFratio.pred<span class="sc">==</span><span class="fu">max</span>(MFdata.main<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),])</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>min.chem <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(MFdata.main[<span class="fu">which</span>(MFdata.main<span class="sc">$</span>MFratio.pred<span class="sc">==</span><span class="fu">min</span>(MFdata.main<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),])</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;The predictions for all chemicals ranged from &quot;</span>,</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(min.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  min.chem[,<span class="st">&quot;Chemical&quot;</span>],</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; to &quot;</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(max.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  max.chem[,<span class="st">&quot;Chemical&quot;</span>],</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>MFdata.main,MFratio<span class="sc">~</span>MFratio.pred.nofup)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fit1)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>fit1sub <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(MFdata.main,</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  MFratio<span class="sc">~</span>MFratio.pred.nofup)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1sub)</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fit1sub)</span></code></pre></div>
</div>
<div id="cord-blood-ratio-predictions-with-fup-adjustement" class="section level3">
<h3>Cord Blood Ratio Predictions with Fup Adjustement:</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>FigCb  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>MFdata.main) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">color=</span><span class="st">&quot;grey&quot;</span>,<span class="fu">aes</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MFratio.pred,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>MFratio.Q25,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend=</span>MFratio.pred,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend=</span>MFratio.Q75))<span class="sc">+</span>    </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MFratio.pred,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>MFratio,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Chemical.Category,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Chemical.Category),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">3</span>)   <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>,<span class="dv">2</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">5</span>, <span class="dv">6</span>))<span class="sc">+</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>MFdata.outliers,<span class="fu">aes</span>(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>MFratio.pred,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>MFratio,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Chemical.Category,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Chemical.Category),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">1</span>)   <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_text(aes(x=AUC,y=Critical.concentration,label=Compound.abbrev,color=Chemical)) +</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_log10(label=scientific_10) +</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#,limits=c(10^-7,100)) +</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_log10(label=scientific_10) +</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   ,limits=c(10^-7,100)) +</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#    annotation_logticks() + </span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_abline(slope=1, intercept=1,linetype=&quot;dashed&quot;) + </span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#    geom_abline(slope=1, intercept=-1,linetype=&quot;dashed&quot;) + </span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vivo&quot;</span>),<span class="st">&quot; Mat:Fet Plasma Ratio&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; Predicted Ratio&quot;</span>))) <span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#    scale_color_brewer(palette=&quot;Set2&quot;) + </span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))<span class="sc">+</span> </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Class&quot;</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))<span class="sc">+</span> </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Class&quot;</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigCb)</span></code></pre></div>
</div>
<div id="examine-performance-when-excluding-certain-chemical-classes" class="section level3">
<h3>Examine performance when excluding certain chemical classes:</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean logHenry&#39;s law constant for PAH&#39;s:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="sc">%in%</span><span class="fu">subset</span>(MFdata.main,Chemical.Category<span class="sc">==</span><span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)<span class="sc">$</span>DTXSID)<span class="sc">$</span>logHenry)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>nonvols <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,logHenry <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.5</span>)<span class="sc">$</span>DTXSID</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>fluoros <span class="ot">&lt;-</span> chem.physical_and_invitro.data<span class="sc">$</span>DTXSID[<span class="fu">regexpr</span>(<span class="st">&quot;fluoro&quot;</span>,<span class="fu">tolower</span>(chem.physical_and_invitro.data<span class="sc">$</span>Compound))<span class="sc">!=-</span><span class="dv">1</span>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>MFdata.main,MFratio<span class="sc">~</span>MFratio.pred)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fit2)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>fit2sub <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(MFdata.main,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  MFratio<span class="sc">~</span>MFratio.pred)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2sub)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fit2sub)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;When volatile and fluorinated chemicals are omitted only &quot;</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(MFdata.main,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))))[<span class="dv">1</span>],</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; evaluation chemicals remain, but the R2 is &quot;</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(fit1sub)<span class="sc">$</span>adj.r.squared,<span class="dv">2</span>),</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; and the RMSE is &quot;</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit1sub),<span class="dv">2</span>),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; without the correction. When the fetal plasma fraction unbound correction is used, the predictivity decreases, slightly: R2 is &quot;</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(fit2sub)<span class="sc">$</span>adj.r.squared,<span class="dv">2</span>),</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; and the RMSE is &quot;</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit2sub),<span class="dv">2</span>),</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for the non-volatile, non-fluorinated chemicals.</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;We compare the RMSE for our predictions to the standard deviation \</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="st">of the observations &quot;</span>,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">sd</span>(MFdata.main<span class="sc">$</span>MFratio)[<span class="dv">1</span>],<span class="dv">2</span>),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">sd</span>(<span class="fu">subset</span>(MFdata.main,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))<span class="sc">$</span>MFratio),<span class="dv">2</span>),</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for non PAH or fluorinated compounds).</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;The average standard deviation for chemicals with repeated observations was &quot;</span>,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">sd</span>(<span class="fu">subset</span>(MFdata.main,N.obs<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">$</span>MFratio)[<span class="dv">1</span>],<span class="dv">2</span>),</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">sd</span>(<span class="fu">subset</span>(MFdata.main,</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  N.obs <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))<span class="sc">$</span>MFratio),<span class="dv">2</span>),</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for non PAH or fluorinated compounds).</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>repeats,MFratio<span class="sc">~</span>MFratio.pred.nofup)</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fit3)</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>fit3sub <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(MFdata.main, N.obs <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>  MFratio<span class="sc">~</span>MFratio.pred.nofup)</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3sub)</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(MFdata.main,N.obs <span class="sc">&gt;</span> <span class="dv">1</span>),MFratio<span class="sc">~</span>MFratio.pred)</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fit4)</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>fit4sub <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span><span class="fu">subset</span>(MFdata.main, N.obs <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))),</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>  MFratio<span class="sc">~</span>MFratio.pred)</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4sub)</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;Overall, we observed relatively poor correlation (R2 = &quot;</span>,</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(fit1)<span class="sc">$</span>adj.r.squared,<span class="dv">2</span>),</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;, RMSE = &quot;</span>,</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit1),<span class="dv">2</span>),</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;) without our fetal fup correction that was unchanged with that assumption (R2 = &quot;</span>,</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(fit2)<span class="sc">$</span>adj.r.squared,<span class="dv">2</span>),</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;, RMSE = &quot;</span>,</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit2),<span class="dv">2</span>),</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;).</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>repeats <span class="ot">&lt;-</span><span class="fu">subset</span>(MFdata.main,N.obs <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;The RMSE of the predictions for the &quot;</span>,</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(repeats,<span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))))[<span class="dv">1</span>],</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; non-PAH and non-fluorinated compounds with repeated observations is &quot;</span>,</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit4sub),<span class="dv">2</span>),</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; with the fup correction and &quot;</span>,</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit3sub),<span class="dv">2</span>),</span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; without.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;These values are close to the standard deviation of the mean but the p-value for the chemicals with repeated observations is &quot;</span>,</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">pf</span>(</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(fit4sub)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(fit4sub)<span class="sc">$</span>fstatistic[<span class="dv">2</span>],</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(fit4sub)<span class="sc">$</span>fstatistic[<span class="dv">3</span>]),<span class="dv">2</span>),    </span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a><span class="st">&quot; indicating some value for the predictive model, albeit for only &quot;</span>,</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">subset</span>(repeats,<span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>))))[<span class="dv">1</span>],</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a> <span class="st">&quot; chemicals&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>Fig4.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Number of Chemicals&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(MFdata.httk<span class="sc">$</span>DTXSID))</span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Number of Observations&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">dim</span>(MFdata.httk)[<span class="dv">1</span>]</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Observed Mean (Min - Max)&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(MFdata.httk<span class="sc">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">min</span>(MFdata.httk<span class="sc">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">max</span>(MFdata.httk<span class="sc">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Observed Standard Deviation&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">sd</span>(MFdata.httk<span class="sc">$</span>MFratio),<span class="dv">2</span>) </span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Predicted Mean (Min - Max)&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span>  <span class="fu">paste</span>(</span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(MFdata.main<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">min</span>(MFdata.main<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">max</span>(MFdata.main<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>) </span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;RMSE&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit2),<span class="dv">2</span>)</span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;R-squared&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">summary</span>(fit2)[[<span class="st">&quot;adj.r.squared&quot;</span>]],<span class="dv">2</span>)</span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;All Fig 4&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">summary</span>(fit2)[[<span class="st">&quot;coefficients&quot;</span>]][<span class="st">&quot;MFratio.pred&quot;</span>,<span class="dv">4</span>],<span class="dv">2</span>)</span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>MFdata.sub1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata.httk,</span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Number of Chemicals&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(MFdata.sub1<span class="sc">$</span>DTXSID))</span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Number of Observations&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">dim</span>(MFdata.sub1)[<span class="dv">1</span>]</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Observed Mean (Min - Max)&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(MFdata.sub1<span class="sc">$</span>MFratio,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">min</span>(MFdata.sub1<span class="sc">$</span>MFratio,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">max</span>(MFdata.sub1<span class="sc">$</span>MFratio,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Observed Standard Deviation&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">sd</span>(MFdata.sub1<span class="sc">$</span>MFratio),<span class="dv">2</span>) </span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a>MFdata.sub2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata.main,</span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))</span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Predicted Mean (Min - Max)&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span>  <span class="fu">paste</span>(</span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(MFdata.sub2<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">min</span>(MFdata.sub2<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">max</span>(MFdata.sub2<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>) </span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;RMSE&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit2sub),<span class="dv">2</span>)</span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;R-squared&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">summary</span>(fit2sub)[[<span class="st">&quot;adj.r.squared&quot;</span>]],<span class="dv">2</span>)</span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;No PFAS/PAH&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">summary</span>(fit2sub)[[<span class="st">&quot;coefficients&quot;</span>]][<span class="st">&quot;MFratio.pred&quot;</span>,<span class="dv">4</span>],<span class="dv">2</span>)</span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a>MFdata.sub3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(MFdata.main,N.obs <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(Chemical.Category <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Fluorinated compounds&quot;</span>,</span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Polyaromatic Hydrocarbons&quot;</span>)))</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Number of Chemicals&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(MFdata.sub3<span class="sc">$</span>DTXSID))</span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Number of Observations&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">dim</span>(MFdata.sub3)[<span class="dv">1</span>]</span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Observed Mean (Min - Max)&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(MFdata.sub3<span class="sc">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">min</span>(MFdata.sub3<span class="sc">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">max</span>(MFdata.sub3<span class="sc">$</span>MFratio),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Observed Standard Deviation&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">sd</span>(MFdata.sub3<span class="sc">$</span>MFratio),<span class="dv">2</span>) </span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;Predicted Mean (Min - Max)&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span>  <span class="fu">paste</span>(</span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(MFdata.sub3<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; (&quot;</span>,</span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">min</span>(MFdata.sub3<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot; - &quot;</span>,</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">max</span>(MFdata.sub3<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>) </span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;RMSE&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit4sub),<span class="dv">2</span>)</span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;R-squared&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">summary</span>(fit4sub)[[<span class="st">&quot;adj.r.squared&quot;</span>]],<span class="dv">2</span>)</span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a>Fig4.table[<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Replicates Only&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">summary</span>(fit4sub)[[<span class="st">&quot;coefficients&quot;</span>]][<span class="st">&quot;MFratio.pred&quot;</span>,<span class="dv">4</span>],<span class="dv">2</span>)</span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Fig4.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,],<span class="at">file=</span><span class="st">&quot;Fig4Table.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="evaluation-of-area-under-the-curve-predictions" class="section level1">
<h1>Evaluation of Area Under the Curve Predictions</h1>
<p><a href="http://dx.doi.org/10.1007/s40262-017-0594-5">Dallmann et
al., 2018</a> includes descriptions of toxicokinetics summary
statistics, including time-integrated plasma concentrations (area under
the curve or AUC) for six drugs administered to a sample of subjects
including both pregnant and non-pregnant women. Additional data from X
and Y for two chemicals among the httk library were collected from the
literature.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TKstats &lt;- as.data.frame(read_excel(&quot;MaternalFetalAUCData.xlsx&quot;))</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>TKstats <span class="ot">&lt;-</span> httk<span class="sc">::</span>pregnonpregaucs</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(TKstats<span class="sc">$</span>DTXSID)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(ids <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;chemicals for which the model fetal_pbtk can run that are in the Dallmann data set.&quot;</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>TKstats.Cmax <span class="ot">&lt;-</span> <span class="fu">subset</span>(TKstats,DTXSID<span class="sc">!=</span><span class="st">&quot;&quot;</span> <span class="sc">&amp;</span> Parameter<span class="sc">==</span><span class="st">&quot;Cmax&quot;</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>TKstats <span class="ot">&lt;-</span> <span class="fu">subset</span>(TKstats,DTXSID<span class="sc">!=</span><span class="st">&quot;&quot;</span> <span class="sc">&amp;</span> Parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AUCinf&quot;</span>,<span class="st">&quot;AUClast&quot;</span>))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(TKstats<span class="sc">$</span>DTXSID)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">sum</span>(ids <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="st">&quot;dtxsid&quot;</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;chemicals for which the model fetal_pbtk can run that have AUCs in the Dallmann data set.&quot;</span>))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumed body weight (kg) from Kapraun 2019</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>BW.nonpreg <span class="ot">&lt;-</span> <span class="fl">61.103</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#TKstats$Dose &lt;- TKstats$Dose/BW</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#TKstats$Dose.Units &lt;- &quot;mg/kg&quot;</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TKstats)[<span class="fu">colnames</span>(TKstats)<span class="sc">==</span><span class="st">&quot;Observed Pregnant&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Observed.Pregnant&quot;</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TKstats)[<span class="fu">colnames</span>(TKstats)<span class="sc">==</span><span class="st">&quot;Observed Pregnant5&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Observed.Pregnant5&quot;</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TKstats)[<span class="fu">colnames</span>(TKstats)<span class="sc">==</span><span class="st">&quot;Observed Non-Pregnant&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Observed.Non.Pregnant&quot;</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TKstats)[<span class="fu">colnames</span>(TKstats)<span class="sc">==</span><span class="st">&quot;Observed Non-Pregnant2&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Observed.Non.Pregnant2&quot;</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TKstats)[<span class="fu">colnames</span>(TKstats)<span class="sc">==</span><span class="st">&quot;Dose Route&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Dose.Route&quot;</span></span></code></pre></div>
<div id="predict-auc" class="section level2">
<h2>Predict AUC</h2>
<p>The circumstances of the dosing varied slightly between drugs and
pregnancy status required variation in simulated dose regimen as
summarized in Table 12. The function solve_fetal_pbtk was used to
determine the time-integrated plasma concentration (area under the
curve, or AUC) for the mothers both when pregnant and non-pregnant.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(TKstats<span class="sc">$</span>DTXSID))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">regexpr</span>(<span class="st">&quot;ng&quot;</span>,TKstats[TKstats<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Dose Units&quot;</span>])<span class="sc">!=-</span><span class="dv">1</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.id <span class="sc">%in%</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">info=</span><span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(TKstats,DTXSID<span class="sc">==</span>this.id)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">parameterize_pbtk</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">dtxsid=</span>this.id,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    p<span class="sc">$</span>hematocrit <span class="ot">&lt;-</span> <span class="fl">0.39412</span> <span class="co"># Kapraun 2019 (unitless)</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    p<span class="sc">$</span>Rblood2plasma <span class="ot">&lt;-</span> <span class="fu">calc_rblood2plasma</span>(</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameters=</span>p,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    p<span class="sc">$</span>BW <span class="ot">&lt;-</span> BW.nonpreg </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    p<span class="sc">$</span>Qcardiacc <span class="ot">&lt;-</span> <span class="fl">301.78</span> <span class="sc">/</span> p<span class="sc">$</span>BW<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># Kapraun 2019 (L/h/kg^3/4)</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.route <span class="cf">in</span> <span class="fu">unique</span>(this.subset<span class="sc">$</span>Dose.Route))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      this.route.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(this.subset, Dose.Route<span class="sc">==</span>this.route)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>] <span class="sc">&gt;</span> <span class="dv">12</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        this.dose <span class="ot">&lt;-</span> this.route.subset<span class="sc">$</span>Dose</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Non-pregnant PBPK:</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>        out.nonpreg <span class="ot">&lt;-</span> <span class="fu">solve_pbtk</span>(</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">parameters=</span>p,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">times =</span> <span class="fu">seq</span>(<span class="dv">0</span>, this.route.subset[<span class="dv">1</span>,<span class="st">&quot;NonPreg.Duration.Days&quot;</span>],</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>                      this.route.subset[<span class="dv">1</span>,<span class="st">&quot;NonPreg.Duration.Days&quot;</span>]<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">dose=</span>this.dose<span class="sc">/</span>BW.nonpreg, <span class="co"># mg/kg</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">daily.dose=</span><span class="cn">NULL</span>,</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">iv.dose=</span>(this.route<span class="sc">==</span><span class="st">&quot;iv&quot;</span>),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pregnant PBPK:</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        BW.preg <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">calc_maternal_bw</span>(</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">week=</span>this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>]))</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        out.preg <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">dtxsid=</span>this.id,</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">times =</span> <span class="fu">seq</span>(</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>            this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>]<span class="sc">*</span><span class="dv">7</span>, </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>            this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Gestational.Age.Weeks&quot;</span>]<span class="sc">*</span><span class="dv">7</span> <span class="sc">+</span> </span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>              this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Preg.Duration.Days&quot;</span>], </span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>            this.route.subset[<span class="dv">1</span>,<span class="st">&quot;Preg.Duration.Days&quot;</span>]<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">dose=</span>this.dose<span class="sc">/</span>BW.preg, <span class="co"># mg/kg</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">iv.dose=</span>(this.route<span class="sc">==</span><span class="st">&quot;iv&quot;</span>),</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">daily.dose=</span><span class="cn">NULL</span>,</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">output.units=</span><span class="st">&quot;uM&quot;</span>,</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">regexpr</span>(<span class="st">&quot;AUC&quot;</span>,this.subset<span class="sc">$</span>Parameter)<span class="sc">!=-</span><span class="dv">1</span>))</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>          TKstats[TKstats<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id <span class="sc">&amp;</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>                    TKstats<span class="sc">$</span>Dose.Route <span class="sc">==</span> this.route <span class="sc">&amp;</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">regexpr</span>(<span class="st">&quot;AUC&quot;</span>,TKstats<span class="sc">$</span>Parameter)<span class="sc">!=-</span><span class="dv">1</span>, </span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Predicted.Non.Pregnant.httk&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(out.nonpreg[,<span class="st">&quot;AUC&quot;</span>])<span class="sc">*</span><span class="dv">24</span> <span class="co">#uMdays-&gt;uMh                        </span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>          TKstats[TKstats<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id <span class="sc">&amp;</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>                    TKstats<span class="sc">$</span>Dose.Route <span class="sc">==</span> this.route <span class="sc">&amp;</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">regexpr</span>(<span class="st">&quot;AUC&quot;</span>,TKstats<span class="sc">$</span>Parameter)<span class="sc">!=-</span><span class="dv">1</span>, </span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Predicted.Pregnant.httk&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(out.preg[,<span class="st">&quot;AUC&quot;</span>])<span class="sc">*</span><span class="dv">24</span> <span class="co"># uM days -&gt; uM h </span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">regexpr</span>(<span class="st">&quot;Cmax&quot;</span>,this.subset<span class="sc">$</span>Parameter)<span class="sc">!=-</span><span class="dv">1</span>))</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>          TKstats[TKstats<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id <span class="sc">&amp;</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>                    TKstats<span class="sc">$</span>Dose.Route <span class="sc">==</span> this.route <span class="sc">&amp;</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">regexpr</span>(<span class="st">&quot;Cmax&quot;</span>,TKstats<span class="sc">$</span>Parameter)<span class="sc">!=-</span><span class="dv">1</span>, </span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Predicted.Non.Pregnant.httk&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(out.nonpreg[,<span class="st">&quot;Cplasma&quot;</span>])</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>          TKstats[TKstats<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id <span class="sc">&amp;</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>                    TKstats<span class="sc">$</span>Dose.Route <span class="sc">==</span> this.route <span class="sc">&amp;</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">regexpr</span>(<span class="st">&quot;Cmax&quot;</span>,TKstats<span class="sc">$</span>Parameter)<span class="sc">!=-</span><span class="dv">1</span>, </span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Predicted.Pregnant.httk&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">max</span>(out.preg[,<span class="st">&quot;Cfplasma&quot;</span>])        </span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>TKstats<span class="sc">$</span>Ratio.obs <span class="ot">&lt;-</span> TKstats<span class="sc">$</span>Observed.Pregnant <span class="sc">/</span> TKstats<span class="sc">$</span>Observed.Non.Pregnant</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>TKstats<span class="sc">$</span>Ratio.httk <span class="ot">&lt;-</span> TKstats<span class="sc">$</span>Predicted.Pregnant.httk <span class="sc">/</span> TKstats<span class="sc">$</span>Predicted.Non.Pregnant.httk</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>TKstats <span class="ot">&lt;-</span> <span class="fu">subset</span>(TKstats, <span class="sc">!</span><span class="fu">is.na</span>(TKstats<span class="sc">$</span>Ratio.httk))</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(TKstats,<span class="at">file=</span><span class="st">&quot;Table-Dallmann2018.csv&quot;</span>,<span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="generate-auc-predicted-vs.-observed-figure" class="section level2">
<h2>Generate AUC Predicted vs. Observed Figure</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>FigEa  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>TKstats) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Observed.Non.Pregnant2,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Predicted.Non.Pregnant.httk,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Dose.Route,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>Drug,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Drug),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">5</span>)   <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">24</span>))<span class="sc">+</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;httk Predicted (uM*h)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="co">#limits=c(10^-3,10^3),</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="co">#limits=c(10^-3,10^3),</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Non-Pregnant&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="dv">1000</span>, <span class="at">label =</span> <span class="st">&quot;A&quot;</span>, <span class="at">fontface =</span><span class="dv">2</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">#print(FigEa)</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;For the Dallman et al. (2018) data we observe an average-fold error (AFE)</span><span class="sc">\n</span><span class="st">\ of&quot;</span>,</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(TKstats<span class="sc">$</span>Predicted.Non.Pregnant.httk<span class="sc">/</span>TKstats<span class="sc">$</span>Observed.Non.Pregnant2),<span class="dv">2</span>),</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;and a RMSE (log10-scale) of&quot;</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>((<span class="fu">mean</span>((<span class="fu">log10</span>(TKstats<span class="sc">$</span>Predicted.Non.Pregnant.httk)<span class="sc">-</span><span class="fu">log10</span>(TKstats<span class="sc">$</span>Observed.Non.Pregnant2))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="dv">2</span>),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;for non-pregnant woman.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>FigEb  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>TKstats) <span class="sc">+</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Observed.Pregnant5,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Predicted.Pregnant.httk,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Dose.Route,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>Drug,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Drug),</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">5</span>)   <span class="sc">+</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">24</span>))<span class="sc">+</span> </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;httk Predicted (uM*h)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="co">#limits=c(10^-5,10^3),</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="co">#limits=c(10^-5,10^3),</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Pregnant&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="dv">300</span>, <span class="at">label =</span> <span class="st">&quot;B&quot;</span>, <span class="at">fontface =</span><span class="dv">2</span>)</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="co">#print(FigEb)</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;We observe an AFE of&quot;</span>,</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(TKstats<span class="sc">$</span>Predicted.Pregnant.httk<span class="sc">/</span>TKstats<span class="sc">$</span>Observed.Pregnant5),<span class="dv">2</span>),</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;and a RMSE (log10-scale) of&quot;</span>,</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>((<span class="fu">mean</span>((<span class="fu">log10</span>(TKstats<span class="sc">$</span>Predicted.Pregnant.httk)<span class="sc">-</span><span class="fu">log10</span>(TKstats<span class="sc">$</span>Observed.Pregnant5))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),<span class="dv">2</span>),</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;for pregnant woman.</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>FigEc  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>TKstats) <span class="sc">+</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Predicted.Non.Pregnant.httk,</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Predicted.Pregnant.httk,</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Dose.Route,</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>Drug,</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Drug),</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">5</span>)   <span class="sc">+</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">24</span>),<span class="at">name=</span><span class="st">&quot;Route&quot;</span>)<span class="sc">+</span> </span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;httk Pregnant (uM*h)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;httk Non-Pregnant (uM*h)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="co">#limits=c(10^-1,10^2),</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="co">#limits=c(10^-1,10^2),</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>                <span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model Comparison&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;left&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span> </span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="dv">21</span>)),<span class="at">alpha=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>),<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(FigEc)   </span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>FigEc <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(FigEc)</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>FigEd  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(TKstats,<span class="sc">!</span><span class="fu">is.na</span>(Ratio.httk))) <span class="sc">+</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Ratio.obs,</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Ratio.httk,</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Dose.Route,</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>Drug,</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>Drug),</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">5</span>)   <span class="sc">+</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">24</span>))<span class="sc">+</span> </span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;httk Predicted&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">2.75</span>, <span class="at">label =</span> <span class="st">&quot;C&quot;</span>, <span class="at">fontface =</span><span class="dv">2</span>)</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>()</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(FigEa,FigEb,FigEc,FigEd,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">subset</span>(TKstats,</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(Ratio.httk)),</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">file=</span><span class="st">&quot;DallmanTable.txt&quot;</span>)</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>  </span></code></pre></div>
</div>
</div>
<div id="evaluation-of-partition-coefficient-predictions" class="section level1">
<h1>Evaluation of Partition Coefficient Predictions</h1>
<p>For each tissue, the partition coefficient (which describes the ratio
of the concentration in the tissue to concentration of unbound chemical
in the plasma at equilibrium) is a constant. We calculate each partition
coefficient using the method of <a href="http://dx.doi.org/10.1016/j.tiv.2007.09.010">Schmitt, 2008</a> as
described by <a href="http://dx.doi.org/10.1007/s10928-017-9548-7">Pearce et al.,
2017</a>. The partition coefficient for any given type of tissue (for
example, liver tissue) depends on fraction unbound in plasma (<span class="math inline">\(f_{up}^m\)</span> or <span class="math inline">\(f_{up}^f\)</span>), so in general these differ for
mother and fetus.</p>
<p><a href="https://doi.org/10.1080/00039896.1969.10666901">Curley et
al., 1969</a> compiled data on the concentration of a variety of
pesticides in the cord blood of newborns and in the tissues of infants
that were stillborn.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Curley <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;Curley1969.xlsx&quot;</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Curley)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>Curley.compounds <span class="ot">&lt;-</span> Curley[<span class="dv">1</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Curley <span class="ot">&lt;-</span> Curley[<span class="dv">4</span><span class="sc">:</span><span class="dv">47</span>,]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Curley)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Tissue&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Curley)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;N&quot;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Curley)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Stat&quot;</span></span></code></pre></div>
<p>The ratio of chemical concentration in tissue (<span class="math inline">\(C_y^f\)</span>) vs. blood (<span class="math inline">\(C_{venb}^f\)</span>) was related to the
tissue-to-unbound-plasma concentration partition coefficients used in
the PBTK model as <span class="math display">\[
    (C_y^f )/(C_{venb}^f  )=(C_y^f)/(R_{b:p}^f \times
C_{plas}^f  )=(C_y^f \times f_{up}^f)/(R_{b:p}^f \times
C_{up}^f)=(f_{up}^f)/(R_{b:p}^f) \times K_y^f
\]</span> where <span class="math inline">\(C_{up}^f\)</span> denotes
the concentration of substance unbound in the fetal plasma.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Curley.pcs <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cord.blood <span class="ot">&lt;-</span> <span class="fu">subset</span>(Curley, Tissue <span class="sc">==</span> <span class="st">&quot;Cord Blood&quot;</span>) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="fu">unique</span>(Curley<span class="sc">$</span>Tissue))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.tissue <span class="sc">!=</span> <span class="st">&quot;Cord Blood&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(Curley, Tissue <span class="sc">==</span> this.tissue)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.chemical <span class="cf">in</span> <span class="fu">colnames</span>(Curley)[<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>])</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(<span class="fu">subset</span>(this.subset,Stat<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])) <span class="sc">&amp;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">as.numeric</span>(<span class="fu">subset</span>(cord.blood,Stat<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">Compound =</span> Curley.compounds[,this.chemical],</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">DTXSID =</span> this.chemical,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">Tissue =</span> this.tissue,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">PC =</span> <span class="fu">as.numeric</span>(<span class="fu">subset</span>(this.subset,Stat<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical]) <span class="sc">/</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">subset</span>(cord.blood,Stat<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        Curley.pcs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Curley.pcs,this.row)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>((<span class="fu">as.numeric</span>(<span class="fu">subset</span>(this.subset,Stat<span class="sc">==</span><span class="st">&quot;Range&quot;</span>)[,this.chemical]))) <span class="sc">&amp;</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">is.na</span>((<span class="fu">as.numeric</span>(<span class="fu">subset</span>(cord.blood,Stat<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical]))))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">Compound =</span> Curley.compounds[,this.chemical],</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">DTXSID =</span> this.chemical,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">Tissue =</span> this.tissue,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">PC =</span> <span class="fu">as.numeric</span>(<span class="fu">subset</span>(this.subset,Stat<span class="sc">==</span><span class="st">&quot;Range&quot;</span>)[,this.chemical]) <span class="sc">/</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(<span class="fu">subset</span>(cord.blood,Stat<span class="sc">==</span><span class="st">&quot;Mean&quot;</span>)[,this.chemical])</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        Curley.pcs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Curley.pcs,this.row)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>Curley.pcs[Curley.pcs<span class="sc">$</span>Tissue<span class="sc">==</span><span class="st">&quot;Lungs&quot;</span>,<span class="st">&quot;Tissue&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Lung&quot;</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>pearce2017 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;PC_Data.xlsx&quot;</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>pearce2017 <span class="ot">&lt;-</span> <span class="fu">subset</span>(pearce2017,DTXSID<span class="sc">%in%</span>Curley.pcs<span class="sc">$</span>DTXSID)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(pearce2017<span class="sc">$</span>DTXSID<span class="sc">%in%</span>Curley.pcs<span class="sc">$</span>DTXSID)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;None of the Curley chems were in the Pearce 2017 PC predictor evaluation.&quot;</span>)</span></code></pre></div>
<p>Partition coefficients were measured for tissues, including placenta,
in vitro by <a href="http://dx.doi.org/10.1007/s00204-002-0339-5">Csanady et al.,
2002</a> for Bisphenol A and Diadzen.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>csanadybpa <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Csanady2002.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;Table 2&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>csanadybpa<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="st">&quot;Bisphenol A&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>csanadybpa<span class="sc">$</span>DTXSID <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID7020182&quot;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>csanadybpa <span class="ot">&lt;-</span> csanadybpa[,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Tissue&quot;</span>,<span class="st">&quot;Mean&quot;</span>)]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(csanadybpa) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Curley.pcs)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>csanadydaid <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Csanady2002.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;Table 3&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>csanadydaid<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="st">&quot;Daidzein&quot;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>csanadydaid<span class="sc">$</span>DTXSID <span class="ot">&lt;-</span> <span class="st">&quot;DTXSID9022310&quot;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>csanadydaid <span class="ot">&lt;-</span> csanadydaid[,<span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Tissue&quot;</span>,<span class="st">&quot;Mean...6&quot;</span>)]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(csanadydaid) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Curley.pcs)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>Curley.pcs <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Curley.pcs,csanadybpa,csanadydaid)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>Curley.pcs <span class="ot">&lt;-</span> <span class="fu">subset</span>(Curley.pcs,Tissue<span class="sc">!=</span><span class="st">&quot;Mammary gland&quot;</span>)</span></code></pre></div>
<p>Three of the chemicals studied by <a href="https://doi.org/10.1080/00039896.1969.10666901">Curley et al.,
1969</a> were modeled by <a href="http://dx.doi.org/10.1021/es400386a">Weijs et al., 2013</a> using
the same partition coefficients for mother and fetus. The values used
represented “prior knowledge” summarizing the available literature.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>weijstab3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Weijs2013.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;Table3&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>weijstab3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(weijstab3, <span class="sc">!</span><span class="fu">is.na</span>(Compound) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Tissue))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>weijstab4 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Weijs2013.xlsx&quot;</span>,<span class="at">sheet=</span><span class="st">&quot;Table4&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>weijstab4 <span class="ot">&lt;-</span> <span class="fu">subset</span>(weijstab4, <span class="sc">!</span><span class="fu">is.na</span>(Compound) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Tissue))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.compound <span class="cf">in</span> <span class="fu">unique</span>(weijstab3<span class="sc">$</span>Compound))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="fu">unique</span>(weijstab3<span class="sc">$</span>Tissue))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    Curley.pcs[</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.compound <span class="sc">&amp;</span> Curley.pcs<span class="sc">$</span>Tissue<span class="sc">==</span>this.tissue,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Weijs2013&quot;</span>] <span class="ot">&lt;-</span> weijstab3[weijstab3<span class="sc">$</span>Compound<span class="sc">==</span>this.compound <span class="sc">&amp;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                                  weijstab3<span class="sc">$</span>Tissue<span class="sc">==</span>this.tissue,<span class="st">&quot;value&quot;</span>]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.compound <span class="cf">in</span> <span class="fu">unique</span>(weijstab4<span class="sc">$</span>Compound))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="fu">unique</span>(weijstab4<span class="sc">$</span>Tissue))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    Curley.pcs[</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>      Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.compound <span class="sc">&amp;</span> Curley.pcs<span class="sc">$</span>Tissue<span class="sc">==</span>this.tissue,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Weijs2013&quot;</span>] <span class="ot">&lt;-</span> weijstab4[weijstab4<span class="sc">$</span>Compound<span class="sc">==</span>this.compound <span class="sc">&amp;</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                                  weijstab4<span class="sc">$</span>Tissue<span class="sc">==</span>this.tissue,<span class="st">&quot;value&quot;</span>]</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Curley.pcs,<span class="st">&quot;PCs-table.csv&quot;</span>,<span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div id="predict-partition-coefficients" class="section level2">
<h2>Predict partition coefficients</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Curley.pcs <span class="ot">&lt;-</span> httk<span class="sc">::</span>fetalpcs</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dtxsid.list <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">load_sipes2017</span>())</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chemical <span class="cf">in</span> <span class="fu">unique</span>(Curley.pcs<span class="sc">$</span>DTXSID))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (this.chemical <span class="sc">%in%</span> dtxsid.list)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(Curley.pcs,DTXSID<span class="sc">==</span>this.chemical)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">dtxsid=</span>this.chemical,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustment =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    fetal.blood.pH <span class="ot">&lt;-</span> <span class="fl">7.26</span>   </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    Fup <span class="ot">&lt;-</span> p<span class="sc">$</span>Fraction_unbound_plasma_fetus</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    fetal_schmitt_parms <span class="ot">&lt;-</span> <span class="fu">parameterize_schmitt</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">dtxsid=</span>this.chemical,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    fetal_schmitt_parms<span class="sc">$</span>plasma.pH <span class="ot">&lt;-</span> fetal.blood.pH</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    fetal_schmitt_parms<span class="sc">$</span>Funbound.plasma <span class="ot">&lt;-</span> Fup</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    Curley.pcs[Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chemical,<span class="st">&quot;Fup&quot;</span>] <span class="ot">&lt;-</span> Fup</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># httk gives tissue:fup (unbound chemical in plasma) PC&#39;s:</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    fetal_pcs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameters =</span> fetal_schmitt_parms,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    fetal_pcs.nocal <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameters =</span> fetal_schmitt_parms,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">regression=</span><span class="cn">FALSE</span>,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">dtxsid =</span> this.chemical,</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustment =</span><span class="cn">FALSE</span>,</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">minimum.Funbound.plasma =</span> <span class="fl">1e-16</span>)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    Rb2p <span class="ot">&lt;-</span> out[<span class="fu">dim</span>(out)[<span class="dv">1</span>],<span class="st">&quot;Rfblood2plasma&quot;</span>]</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    Curley.pcs[Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chemical,<span class="st">&quot;Rb2p&quot;</span>] <span class="ot">&lt;-</span> Rb2p</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to tissue:blood PC&#39;s:</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (this.tissue <span class="cf">in</span> this.subset<span class="sc">$</span>Tissue)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">tolower</span>(this.tissue) <span class="sc">%in%</span> </span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unique</span>(<span class="fu">subset</span>(tissue.data,Species<span class="sc">==</span><span class="st">&quot;Human&quot;</span>)<span class="sc">$</span>Tissue))</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>        Curley.pcs[Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chemical <span class="sc">&amp;</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>          Curley.pcs<span class="sc">$</span>Tissue <span class="sc">==</span> this.tissue, <span class="st">&quot;HTTK.pred.t2up&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>          fetal_pcs[[<span class="fu">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="fu">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)]]</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>        Curley.pcs[Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chemical <span class="sc">&amp;</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>          Curley.pcs<span class="sc">$</span>Tissue <span class="sc">==</span> this.tissue, <span class="st">&quot;HTTK.pred.nocal.t2up&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>          fetal_pcs.nocal[[<span class="fu">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="fu">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)]]</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>        Curley.pcs[Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chemical <span class="sc">&amp;</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>          Curley.pcs<span class="sc">$</span>Tissue <span class="sc">==</span> this.tissue, <span class="st">&quot;HTTK.pred&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>          fetal_pcs[[<span class="fu">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="fu">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)]]<span class="sc">*</span>Fup<span class="sc">/</span>Rb2p</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>        Curley.pcs[Curley.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.chemical <span class="sc">&amp;</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>          Curley.pcs<span class="sc">$</span>Tissue <span class="sc">==</span> this.tissue, <span class="st">&quot;HTTK.pred.nocal&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>          fetal_pcs.nocal[[<span class="fu">paste</span>(<span class="st">&quot;K&quot;</span>,<span class="fu">tolower</span>(this.tissue),<span class="st">&quot;2pu&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)]]<span class="sc">*</span>Fup<span class="sc">/</span>Rb2p</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>       <span class="fu">print</span>(this.tissue)</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>      }  </span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="fu">print</span>(this.chemical)</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a><span class="fu">reset_httk</span>()</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;For the two placental observations (&quot;</span>,</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">subset</span>(Curley.pcs,Compound<span class="sc">==</span><span class="st">&quot;Bisphenol A&quot;</span> <span class="sc">&amp;</span> Tissue<span class="sc">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;PC&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for Bisphenol A and &quot;</span>,</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">subset</span>(Curley.pcs,Compound<span class="sc">==</span><span class="st">&quot;Daidzein&quot;</span> <span class="sc">&amp;</span> Tissue<span class="sc">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;PC&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for Diadzen) the predictions were &quot;</span>,</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">subset</span>(Curley.pcs,Compound<span class="sc">==</span><span class="st">&quot;Bisphenol A&quot;</span> <span class="sc">&amp;</span> Tissue<span class="sc">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;HTTK.pred&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; and &quot;</span>,</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">subset</span>(Curley.pcs,Compound<span class="sc">==</span><span class="st">&quot;Daidzein&quot;</span> <span class="sc">&amp;</span> Tissue<span class="sc">==</span><span class="st">&quot;Placenta&quot;</span>)[,<span class="st">&quot;HTTK.pred&quot;</span>],<span class="dv">2</span>),</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;, respectively.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
</div>
<div id="create-observed-vs.-predicted-plot" class="section level2">
<h2>Create Observed vs. Predicted Plot</h2>
<div id="first-indicate-compound" class="section level3">
<h3>First indicate compound:</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>FigFa  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(Curley.pcs,<span class="sc">!</span><span class="fu">is.na</span>(HTTK.pred.nocal))) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="fu">aes</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Weijs2013,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTK.pred,    </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Compound,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Compound)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">5</span>,<span class="fu">aes</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>PC,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTK.pred,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Compound,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Compound)) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>),<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted Tissue:Blood Partition Coefificent&quot;</span>) <span class="sc">+</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">28</span>))<span class="sc">+</span> </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigFa)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>fitFa <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Curley.pcs,<span class="fu">log10</span>(PC)<span class="sc">~</span><span class="fu">log10</span>(HTTK.pred))</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fitFa)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>fitFb <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>Curley.pcs,<span class="fu">log10</span>(PC)<span class="sc">~</span><span class="fu">log10</span>(HTTK.pred.nocal))</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="fu">RMSE</span>(fitFb)</span></code></pre></div>
</div>
<div id="then-indicate-tissues" class="section level3">
<h3>Then indicate tissues:</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>FigFb  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(Curley.pcs,<span class="sc">!</span><span class="fu">is.na</span>(HTTK.pred))) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="fu">aes</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Weijs2013,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTK.pred,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Tissue,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Tissue)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="fu">aes</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>PC,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>HTTK.pred,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Tissue,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Tissue))   <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>),<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted Tissue:Blood Partition Coefificent&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Observed&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10,<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">28</span>))<span class="sc">+</span> </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))<span class="sc">+</span> </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigFb)</span></code></pre></div>
</div>
</div>
<div id="compare-httk-partition-coefficients-with-pksim" class="section level2">
<h2>Compare httk partition coefficients with PKsim:</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pksim.pcs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">&quot;PartitionCoefficients.xlsx&quot;</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pksim.pcs)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.id <span class="cf">in</span> <span class="fu">unique</span>(pksim.pcs<span class="sc">$</span>DTXSID))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  httk.PCs <span class="ot">&lt;-</span> <span class="fu">predict_partitioning_schmitt</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">dtxsid=</span>this.id, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  httk.PCs[[<span class="st">&quot;Kplacenta2pu&quot;</span>]] <span class="ot">&lt;-</span> p[[<span class="st">&quot;Kplacenta2pu&quot;</span>]] </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  httk.PCs[[<span class="st">&quot;Fup&quot;</span>]] <span class="ot">&lt;-</span> p[[<span class="st">&quot;Funbound.plasma&quot;</span>]]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(httk.PCs,as.numeric)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  this.subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(pksim.pcs,DTXSID<span class="sc">==</span>this.id)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (this.tissue <span class="cf">in</span> <span class="fu">unique</span>(this.subset<span class="sc">$</span>Tissue))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.tissue),<span class="fu">names</span>(httk.PCs))<span class="sc">!=-</span><span class="dv">1</span>))</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>      pksim.pcs[pksim.pcs<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id <span class="sc">&amp;</span> pksim.pcs<span class="sc">$</span>Tissue<span class="sc">==</span>this.tissue,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;HTTK.pred&quot;</span>] <span class="ot">&lt;-</span>     </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        httk.PCs[<span class="fu">regexpr</span>(<span class="fu">tolower</span>(this.tissue),<span class="fu">names</span>(httk.PCs))<span class="sc">!=-</span><span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">*</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        httk.PCs[[<span class="st">&quot;Fup&quot;</span>]][[<span class="dv">1</span>]]         </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pksim.pcs)[<span class="fu">colnames</span>(pksim.pcs) <span class="sc">==</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Tissue-to-plasma partition coefficient&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PKSim.pred&quot;</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pksim.pcs)[<span class="fu">colnames</span>(pksim.pcs) <span class="sc">==</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Method for calculating tissue-to-plasma partition coefficients&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Method&quot;</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>pksim.pcs[,<span class="st">&quot;Method&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pksim.pcs[,<span class="st">&quot;Method&quot;</span>])</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>pksim.pcs[,<span class="st">&quot;Drug&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pksim.pcs[,<span class="st">&quot;Drug&quot;</span>])</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>pksim.pcs[,<span class="st">&quot;Tissue&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pksim.pcs[,<span class="st">&quot;Tissue&quot;</span>])</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>pksim.pcs[,<span class="st">&quot;PKSim.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  pksim.pcs[,<span class="st">&quot;PKSim.pred&quot;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pksim.pcs <span class="ot">&lt;-</span> httk<span class="sc">::</span>pksim.pcs</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>pksim.fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>pksim.pcs,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log10</span>(PKSim.pred)<span class="sc">~</span><span class="fu">log10</span>(HTTK.pred))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pksim.fit1)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>pksim.fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>pksim.pcs,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log10</span>(PKSim.pred)<span class="sc">~</span><span class="fu">log10</span>(HTTK.pred)<span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                  Drug<span class="sc">+</span>Tissue<span class="sc">+</span>Method)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pksim.fit2)</span></code></pre></div>
</div>
</div>
<div id="chemical-prioritization-on-the-basis-of-fetal-brain-concentration" class="section level1">
<h1>Chemical Prioritization on the Basis of Fetal Brain
Concentration</h1>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Wangchems &lt;- read_excel(&quot;Wang2018.xlsx&quot;,sheet=3,skip=2)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Wangchems <span class="ot">&lt;-</span> httk<span class="sc">::</span>wang2018</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>maternal.list <span class="ot">&lt;-</span> Wangchems<span class="sc">$</span>CASRN[Wangchems<span class="sc">$</span>CASRN <span class="sc">%in%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_cheminfo</span>(<span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>nonvols <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,logHenry <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">4.5</span>)<span class="sc">$</span>CAS</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>nonfluoros <span class="ot">&lt;-</span> chem.physical_and_invitro.data<span class="sc">$</span>CAS[</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">regexpr</span>(<span class="st">&quot;fluoro&quot;</span>,<span class="fu">tolower</span>(chem.physical_and_invitro.data<span class="sc">$</span>Compound))<span class="sc">==-</span><span class="dv">1</span>]</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>maternal.list <span class="ot">&lt;-</span> maternal.list[maternal.list <span class="sc">%in%</span> <span class="fu">intersect</span>(nonvols,nonfluoros)]</span></code></pre></div>
<p>For the plot we need a data frame with a column “Ratio.pred” broken
down by the different contributions to uncertainty being plotted
(columne “Uncertainty”). We build this plot by making multiple versions
of pred.table and concatonating them together at the end.</p>
<div id="make-predictions-for-fetalmaternal-plasma-ratio-using-three-daily-doses-from-week-13-to-full-term" class="section level2">
<h2>Make predictions for fetal:maternal plasma ratio using three daily
doses from week 13 to full term</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>pred.table1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">get_cheminfo</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;logP&quot;</span>,<span class="st">&quot;pka_accept&quot;</span>,<span class="st">&quot;pka_donor&quot;</span>),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  CAS <span class="sc">%in%</span> maternal.list,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>pred.table1<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>,pred.table1<span class="sc">$</span>Compound)    </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  Fup <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">get_cheminfo</span>(</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">info=</span><span class="st">&quot;all&quot;</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    CAS<span class="sc">==</span>this.cas)<span class="sc">$</span>Human.Funbound.plasma</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if Fup is provided as a distribution:</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="sc">!=-</span><span class="dv">1</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="sc">==</span><span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fl">0.9</span> <span class="sc">&amp;</span> </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="sc">&lt;</span><span class="fl">0.11</span>))</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    Fup.upper <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    Fup <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># These results are actually from a Bayesian posterior, but we can approximate that</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># they are normally distributed about the median to estimate a standard deviation:</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    Fup.sigma <span class="ot">&lt;-</span> (Fup.upper <span class="sc">-</span> Fup)<span class="sc">/</span><span class="fl">1.96</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it&#39;s not a distribution use defaults (see Wambaugh et al. 2019)</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">as.numeric</span>(Fup)<span class="sc">==</span> <span class="dv">0</span>) </span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    Fup <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Fup)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    Fup.sigma <span class="ot">&lt;-</span> Fup<span class="sc">*</span><span class="fl">0.4</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    Fup.upper  <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>,(<span class="dv">1</span><span class="fl">+1.96</span><span class="sc">*</span><span class="fl">0.4</span>)<span class="sc">*</span>Fup)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only run the simulation if we have the necessary parameters:</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>skip)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(this.cas)</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">dose=</span><span class="dv">0</span>,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">doses.per.day=</span><span class="dv">3</span>,</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustenment=</span><span class="cn">TRUE</span>,</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> <span class="fu">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="sc">&gt;</span><span class="dv">279</span>)</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> last.row[<span class="sc">!</span><span class="fu">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    pred.table1[pred.table1<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(Fup,<span class="dv">3</span>)</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    pred.table1[pred.table1<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(Fup.sigma,<span class="dv">3</span>)</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    pred.table1[pred.table1<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup.upper&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(Fup.upper,<span class="dv">3</span>)</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    pred.table1[pred.table1<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">signif</span>(<span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])<span class="sc">/</span><span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),<span class="dv">3</span>)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="create-final-table-holding-all-predictions-for-paper" class="section level2">
<h2>Create final table holding all predictions for paper:</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>PC.table <span class="ot">&lt;-</span> pred.table1</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(PC.table)[<span class="fu">colnames</span>(PC.table)<span class="sc">==</span><span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;R.plasma.FtoM&quot;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>pred.table1<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Predicted F:M Plasma Ratio&quot;</span></span></code></pre></div>
<div id="error-in-fetalmaternal-ratio-inverse-of-maternalfetal-ratio" class="section level3">
<h3>Error in fetal:maternal ratio (inverse of maternal:fetal
ratio):</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pred.table3 <span class="ot">&lt;-</span> pred.table1</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>pred.table3<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Plasma Error (Fig. 4)&quot;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>empirical.error <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(fit2sub)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  pred.table3[pred.table3<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span><span class="sc">/</span>pred.table1[pred.table3<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>])<span class="sc">*</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>         (<span class="dv">1</span><span class="fl">-1.96</span><span class="sc">*</span>empirical.error)), <span class="dv">3</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Update final table for paper:</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>PC.table<span class="sc">$</span>RMSE <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit2sub),<span class="dv">3</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>PC.table<span class="sc">$</span>R.plasma.FtoM.upper <span class="ot">&lt;-</span> pred.table3<span class="sc">$</span>Ratio.pred</span></code></pre></div>
</div>
<div id="brainplasma-partitioning" class="section level3">
<h3>brain:plasma partitioning</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pred.table4 <span class="ot">&lt;-</span> pred.table1</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pred.table4<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Fetal Brain Partitioning&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(this.cas)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">chem.cas=</span>this.cas,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustment=</span><span class="cn">TRUE</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  Kbrain2pu <span class="ot">&lt;-</span> p<span class="sc">$</span>Kfbrain2pu</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  fup <span class="ot">&lt;-</span> pred.table4[pred.table4<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  pred.table4[pred.table4<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>     PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]<span class="sc">*</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    Kbrain2pu <span class="sc">*</span> fup, <span class="dv">3</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Kbrain2pu&quot;</span>] <span class="ot">&lt;-</span> Kbrain2pu</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.brain.FtoM&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    pred.table4[pred.table4<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="brainplasma-uncertainty-partitioning" class="section level3">
<h3>brain:plasma uncertainty partitioning</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>pred.table5 <span class="ot">&lt;-</span> pred.table1</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>pred.table5<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Brain Partitioning Error (Pearce et al., 2017)&quot;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>{                                             </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">chem.cas=</span>this.cas,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustment=</span><span class="cn">TRUE</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  Kbrain2pu <span class="ot">&lt;-</span> p<span class="sc">$</span>Kfbrain2pu</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  fup <span class="ot">&lt;-</span> pred.table5[pred.table5<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  sigma.fup <span class="ot">&lt;-</span> pred.table5[pred.table5<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  Rmatfet <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  Rbrain2matblood <span class="ot">&lt;-</span> Kbrain2pu <span class="sc">*</span> fup <span class="sc">/</span> Rmatfet</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># From Pearce et al. (2017) PC paper:</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  sigma.logKbrain <span class="ot">&lt;-</span> <span class="fl">0.647</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  Kbrain2pu.upper <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="fu">log10</span>(Kbrain2pu)<span class="sc">+</span><span class="fl">1.96</span><span class="sc">*</span>sigma.logKbrain),<span class="dv">3</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  error.Rmatfet <span class="ot">&lt;-</span> PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;RMSE&quot;</span>]</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  sigma.Rbrain2matblood <span class="ot">&lt;-</span> Rbrain2matblood <span class="sc">*</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">log</span>(<span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sigma.logKbrain<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    sigma.fup<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>fup<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    error.Rmatfet<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>Rmatfet<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  Rbrain2matblood.upper <span class="ot">&lt;-</span> Rbrain2matblood <span class="sc">*</span> </span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>(<span class="fu">log</span>(<span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sigma.logKbrain<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    sigma.fup<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>fup<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    error.Rmatfet<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>Rmatfet<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  pred.table5[pred.table5<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(Rbrain2matblood.upper,<span class="dv">3</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;sigma.logKbrain&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(sigma.logKbrain, <span class="dv">3</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Kbrain2pu.upper&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(Kbrain2pu.upper, <span class="dv">3</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;sigma.Rbrain2matblood&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(sigma.Rbrain2matblood, <span class="dv">3</span>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>  PC.table[PC.table<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.brain.FtoM.upper&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    pred.table5[pred.table5<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="combine-different-ratio-predicitons-together-for-figure" class="section level3">
<h3>Combine different ratio predicitons together for figure</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pred.levels <span class="ot">&lt;-</span> pred.table5<span class="sc">$</span>Compound[<span class="fu">order</span>(pred.table5<span class="sc">$</span>Ratio.pred)]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>pred.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  pred.table1,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  pred.table2,</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  pred.table3,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  pred.table4,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  pred.table5)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>pred.table<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred.table<span class="sc">$</span>Compound,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> pred.levels)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>pred.table<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred.table<span class="sc">$</span>Uncertainty, </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(pred.table1[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>],</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    pred.table2[1,&quot;Uncertainty&quot;],</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    pred.table3[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>],</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    pred.table4[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>],</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    pred.table5[<span class="dv">1</span>,<span class="st">&quot;Uncertainty&quot;</span>]))</span></code></pre></div>
</div>
</div>
<div id="make-prioritization-figure" class="section level2">
<h2>Make prioritization figure:</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Wang 2018 confirmed 6 chemical identities:</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>confirmed.chemicals <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2,4-Di-tert-butylphenol&quot;</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2,4-Dinitrophenol&quot;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Pyrocatechol&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2&#39;-Hydroxyacetophenone&quot;</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;3,5-Di-tert-butylsalicylic acid&quot;</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;4-Hydroxycoumarin&quot;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>confirmed.chemicals <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;96-76-4&quot;</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;19715-19-6&quot;</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;51-28-5&quot;</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;120-80-9&quot;</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;118-93-4&quot;</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;1076-38-6&quot;</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>FigG  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pred.table) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Ratio.pred,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Compound,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> Uncertainty,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> Uncertainty),</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">3</span>)   <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>,<span class="dv">2</span>, <span class="dv">23</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">5</span>, <span class="dv">6</span>))<span class="sc">+</span> </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>),<span class="at">label=</span>scientific_10)<span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Chemicals Found in Maternal Plasma by Wang   &quot;</span>,<span class="fu">italic</span>(<span class="st">&quot;et al.&quot;</span>),<span class="st">&quot; (2018)&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Predicted Ratio to Maternal Plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme(legend.position=&quot;bottom&quot;)+</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))<span class="sc">+</span> </span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="co">#+ </span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a> <span class="co"># guides(color=guide_legend(nrow=4,byrow=TRUE))+ </span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#guides(shape=guide_legend(nrow=4,byrow=TRUE))</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#+</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme(legend.justification = c(0, 0), legend.position = c(0, 0))</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigG)</span></code></pre></div>
</div>
<div id="look-at-ionization-state" class="section level2">
<h2>Look at ionization state:</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.col <span class="cf">in</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">14</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  PC.table[,this.col] <span class="ot">&lt;-</span> <span class="fu">signif</span>(PC.table[,this.col],<span class="dv">3</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>PC.table <span class="ot">&lt;-</span> PC.table[<span class="fu">order</span>(PC.table<span class="sc">$</span>R.brain.FtoM.upper,<span class="at">decreasing=</span><span class="cn">TRUE</span>),]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(PC.table)[<span class="dv">1</span>])</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">calc_ionization</span>(</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pH=</span><span class="fl">7.26</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">pKa_Donor=</span>PC.table[this.row,<span class="st">&quot;pKa_Donor&quot;</span>],</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pKa_Accept=</span>PC.table[this.row,<span class="st">&quot;pKa_Accept&quot;</span>])</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (out<span class="sc">$</span>fraction_neutral<span class="sc">&gt;</span><span class="fl">0.9</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Neutral&quot;</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (out<span class="sc">$</span>fraction_positive<span class="sc">&gt;</span><span class="fl">0.1</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">signif</span>(out<span class="sc">$</span>fraction_positive<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot;% Positive&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (out<span class="sc">$</span>fraction_negative<span class="sc">&gt;</span><span class="fl">0.1</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">signif</span>(out<span class="sc">$</span>fraction_negative<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot;% Negative&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (out<span class="sc">$</span>fraction_zwitter<span class="sc">&gt;</span><span class="fl">0.1</span>) PC.table[this.row,<span class="st">&quot;Charge_726&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">signif</span>(out<span class="sc">$</span>fraction_zwitter<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot;% Zwitterion&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>PC.table <span class="ot">&lt;-</span> PC.table[,<span class="fu">c</span>(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Compound&quot;</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;CAS&quot;</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;DTXSID&quot;</span>,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;logP&quot;</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Charge_726&quot;</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;R.plasma.FtoM&quot;</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;RMSE&quot;</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;R.plasma.FtoM.upper&quot;</span>,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Kbrain2pu&quot;</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;fup&quot;</span>,</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;R.brain.FtoM&quot;</span>,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Kbrain2pu.upper&quot;</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;R.brain.FtoM.upper&quot;</span>)]</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(PC.table,</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">file=</span><span class="st">&quot;WangTable.txt&quot;</span>,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span><span class="cn">FALSE</span>)   </span></code></pre></div>
</div>
<div id="evaluate-any-value-added-by-pbpk-model-over-just-using-partition-coefficients" class="section level2">
<h2>Evaluate any value added by PBPK model over just using partition
coefficients:</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>MFbrainfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(R.brain.FtoM.upper<span class="sc">~</span>Kbrain2pu.upper,<span class="at">data=</span>PC.table)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MFbrainfit)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;As expected, the predicted fetal brain to maternal blood ratio was strongly correlated with the predicted brain partition coefficient (R2 = &quot;</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(MFbrainfit)<span class="sc">$</span>adj.r.square,<span class="dv">2</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;, p-value &quot;</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(MFbrainfit)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">4</span>],<span class="dv">2</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;). However, the PBTK simulation impacted the plasma and tissue concentrations such that &quot;</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(PC.table, <span class="fu">rank</span>(R.brain.FtoM.upper) <span class="sc">&lt;</span>  <span class="fu">rank</span>(Kbrain2pu.upper)))[<span class="dv">1</span>],</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; chemicals were ranked higher than they would have been using partitioning alone.&quot;</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="repeat-analysis-without-fetal-protein-binding-change" class="section level1">
<h1>Repeat analysis without fetal protein binding change:</h1>
<div id="make-predictions-for-fetalmaternal-plasma-ratio-using-three-daily-doses-from-week-13-to-full-term-1" class="section level2">
<h2>Make predictions for fetal:maternal plasma ratio using three daily
doses from week 13 to full term</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>pred.table1.nofup <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">get_cheminfo</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;logP&quot;</span>,<span class="st">&quot;pka_accept&quot;</span>,<span class="st">&quot;pka_donor&quot;</span>),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  CAS <span class="sc">%in%</span> maternal.list)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>pred.table1.nofup<span class="sc">$</span>Compound <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>,pred.table1.nofup<span class="sc">$</span>Compound)    </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  Fup <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">get_cheminfo</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">info=</span><span class="st">&quot;all&quot;</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    CAS<span class="sc">==</span>this.cas)<span class="sc">$</span>Human.Funbound.plasma</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if Fup is provided as a distribution:</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="sc">!=-</span><span class="dv">1</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="sc">==</span><span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fl">0.9</span> <span class="sc">&amp;</span> </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="sc">&lt;</span><span class="fl">0.11</span>))</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>      skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    Fup.upper <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    Fup <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># These results are actually from a Bayesian posterior, but we can approximate that</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># they are normally distributed about the median to estimate a standard deviation:</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    Fup.sigma <span class="ot">&lt;-</span> (Fup.upper <span class="sc">-</span> Fup)<span class="sc">/</span><span class="fl">1.96</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it&#39;s not a distribution use defaults (see Wambaugh et al. 2019)</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">as.numeric</span>(Fup)<span class="sc">==</span> <span class="dv">0</span>) </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    Fup <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Fup)</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    Fup.sigma <span class="ot">&lt;-</span> Fup<span class="sc">*</span><span class="fl">0.4</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    Fup.upper  <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>,(<span class="dv">1</span><span class="fl">+1.96</span><span class="sc">*</span><span class="fl">0.4</span>)<span class="sc">*</span>Fup)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only run the simulation if we have the necessary parameters:</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>skip)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  {  </span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">chem.cas=</span>this.cas,</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">dose=</span><span class="dv">0</span>,</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">doses.per.day=</span><span class="dv">3</span>,</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustenment=</span><span class="cn">FALSE</span>,</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> <span class="fu">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="sc">&gt;</span><span class="dv">279</span>)</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> last.row[<span class="sc">!</span><span class="fu">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>    pred.table1.nofup[pred.table1.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(Fup,<span class="dv">3</span>)</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    pred.table1.nofup[pred.table1.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(Fup.sigma,<span class="dv">3</span>)</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>    pred.table1.nofup[pred.table1.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup.upper&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(Fup.upper,<span class="dv">3</span>)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>    pred.table1.nofup[pred.table1.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">signif</span>(<span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])<span class="sc">/</span><span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),<span class="dv">3</span>)</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="create-final-table-holding-all-predictions-for-paper-1" class="section level2">
<h2>Create final table holding all predictions for paper:</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>PC.table.nofup <span class="ot">&lt;-</span> pred.table1.nofup</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(PC.table.nofup)[<span class="fu">colnames</span>(PC.table.nofup)<span class="sc">==</span><span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;R.plasma.FtoM&quot;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>pred.table1.nofup<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Predicted F:M Plasma Ratio&quot;</span></span></code></pre></div>
<div id="error-in-fetalmaternal-ratio-inverse-of-maternalfetal-ratio-1" class="section level3">
<h3>Error in fetal:maternal ratio (inverse of maternal:fetal
ratio):</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>pred.table3.nofup <span class="ot">&lt;-</span> pred.table1.nofup</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pred.table3.nofup<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Plasma Error (Fig. 4)&quot;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>empirical.error <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(fit2sub)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  pred.table3.nofup[pred.table3.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span><span class="sc">/</span>pred.table1.nofup[pred.table3.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>])<span class="sc">*</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>         (<span class="dv">1</span><span class="fl">-1.96</span><span class="sc">*</span>empirical.error)), <span class="dv">3</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Update final table for paper:</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>PC.table.nofup<span class="sc">$</span>RMSE <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="fu">RMSE</span>(fit2sub),<span class="dv">3</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>PC.table.nofup<span class="sc">$</span>R.plasma.FtoM.upper <span class="ot">&lt;-</span> pred.table3.nofup<span class="sc">$</span>Ratio.pred</span></code></pre></div>
</div>
<div id="brainplasma-partitioning-1" class="section level3">
<h3>brain:plasma partitioning</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pred.table4.nofup <span class="ot">&lt;-</span> pred.table1.nofup</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pred.table4.nofup<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Fetal Brain Partitioning&quot;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">chem.cas=</span>this.cas,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustment=</span><span class="cn">FALSE</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  Kbrain2pu <span class="ot">&lt;-</span> p<span class="sc">$</span>Kfbrain2pu</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  fup <span class="ot">&lt;-</span> pred.table4.nofup[pred.table4.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  pred.table4.nofup[pred.table4.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">signif</span>(</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>     PC.table.nofup[PC.table.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]<span class="sc">*</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    Kbrain2pu <span class="sc">*</span> fup, <span class="dv">3</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  PC.table.nofup[PC.table.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Kbrain2pu&quot;</span>] <span class="ot">&lt;-</span> Kbrain2pu</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  PC.table.nofup[PC.table.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.brain.FtoM&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    pred.table4.nofup[pred.table4.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="brainplasma-uncertainty-partitioning-1" class="section level3">
<h3>brain:plasma uncertainty partitioning</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>pred.table5.nofup <span class="ot">&lt;-</span> pred.table1.nofup</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>pred.table5.nofup<span class="sc">$</span>Uncertainty <span class="ot">&lt;-</span> <span class="st">&quot;Brain Partitioning Error (Pearce et al., 2017)&quot;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> maternal.list)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>{                                             </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">chem.cas=</span>this.cas,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">fetal_fup_adjustment=</span><span class="cn">FALSE</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  Kbrain2pu <span class="ot">&lt;-</span> p<span class="sc">$</span>Kfbrain2pu</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  fup <span class="ot">&lt;-</span> pred.table5.nofup[pred.table5.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup&quot;</span>]</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  sigma.fup <span class="ot">&lt;-</span> pred.table5.nofup[pred.table5.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;fup.sigma&quot;</span>]</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  Rmatfet <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>PC.table[PC.table.nofup<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.plasma.FtoM&quot;</span>]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  Rbrain2matblood <span class="ot">&lt;-</span> Kbrain2pu <span class="sc">*</span> fup <span class="sc">/</span> Rmatfet</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># From Pearce et al. (2017) PC paper:</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  sigma.logKbrain <span class="ot">&lt;-</span> <span class="fl">0.647</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  Kbrain2pu.upper <span class="ot">&lt;-</span> <span class="fu">signif</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="fu">log10</span>(Kbrain2pu)<span class="sc">+</span><span class="fl">1.96</span><span class="sc">*</span>sigma.logKbrain),<span class="dv">3</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  error.Rmatfet <span class="ot">&lt;-</span> PC.table.nofup [PC.table.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;RMSE&quot;</span>]</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  sigma.Rbrain2matblood <span class="ot">&lt;-</span> Rbrain2matblood <span class="sc">*</span> </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">log</span>(<span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sigma.logKbrain<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    sigma.fup<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>fup<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    error.Rmatfet<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>Rmatfet<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  Rbrain2matblood.upper <span class="ot">&lt;-</span> Rbrain2matblood <span class="sc">*</span> </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>(<span class="fu">log</span>(<span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>sigma.logKbrain<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    sigma.fup<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>fup<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    error.Rmatfet<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>Rmatfet<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  pred.table5.nofup [pred.table5.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(Rbrain2matblood.upper,<span class="dv">3</span>)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  PC.table.nofup [PC.table.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;sigma.logKbrain&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(sigma.logKbrain, <span class="dv">3</span>)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>  PC.table.nofup [PC.table.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Kbrain2pu.upper&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(Kbrain2pu.upper, <span class="dv">3</span>)</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  PC.table.nofup [PC.table.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;sigma.Rbrain2matblood&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">signif</span>(sigma.Rbrain2matblood, <span class="dv">3</span>)</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  PC.table.nofup [PC.table.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;R.brain.FtoM.upper&quot;</span>] <span class="ot">&lt;-</span> </span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    pred.table5.nofup [pred.table5.nofup <span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;Ratio.pred&quot;</span>]</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>case.study.fup.correct.table <span class="ot">&lt;-</span> <span class="fu">merge</span>(PC.table,PC.table.nofup,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>MFbrainfit.fup <span class="ot">&lt;-</span> <span class="fu">lm</span>(R.brain.FtoM.upper.x<span class="sc">~</span>R.brain.FtoM.upper.y,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>case.study.fup.correct.table)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MFbrainfit.fup)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;The predictions for fetal brain to maternal blood ratio with or without the fetal plasma binding correction (Eqn. 1) were strongly correlated (R2 = &quot;</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">summary</span>(MFbrainfit.fup)<span class="sc">$</span>adj.r.square,<span class="dv">2</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;). There were &quot;</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(<span class="fu">subset</span>(case.study.fup.correct.table, </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rank</span>(R.brain.FtoM.upper.x) <span class="sc">&gt;</span> <span class="fu">rank</span>(R.brain.FtoM.upper.y)))[<span class="dv">1</span>],</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; chemicals that were ranked higher with the correction than without, with an average increase of &quot;</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">mean</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    case.study.fup.correct.table<span class="sc">$</span>R.brain.FtoM.upper.y <span class="sc">/</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      case.study.fup.correct.table<span class="sc">$</span>R.brain.FtoM.upper.x),<span class="dv">2</span>),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; times when the plasma binding change was included.</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p>The next two figures take a long time to generate and so are disabled
by default.</p>
</div>
</div>
</div>
<div id="protein-binding-figures" class="section level1">
<h1>Protein Binding Figures</h1>
<p>The fetal fraction unbound (f_{up}^f i) is calculated from the
maternal fraction unbound and the serum protein concentration ratio in
infants vs. mothers based on Equation 6 of <a href="http://dx.doi.org/10.1208/ps040104">McNamara et al., 2019</a>,</p>
<p><span class="math display">\[
    f_{up}^f =(f_{up}^m )/(f_{up}^m +(P^f /P^m  )*(1-f_{up}^m  ) )
\]</span></p>
<p>in which the maternal fraction unbound, <span class="math inline">\(f_{up}^m\)</span>, is assumed to be equal to the
in vitro measured value for fraction unbound in plasma, and the ratio of
protein concentrations <span class="math inline">\(P^f /P^m\)</span>
depends on the identity of the dominant binding protein for the chemical
(assumed to be either albumin or AAG). Lacking data to model the
gestational kinetics of albumin and AAG concentrations, we used the
concentrations at birth ([McNamara et al., 2019] (<a href="http://dx.doi.org/10.1208/ps040104" class="uri">http://dx.doi.org/10.1208/ps040104</a>)) to calculate a
constant fetal <span class="math inline">\(f_{up}\)</span>, using <span class="math inline">\(P^f/P^m =0.777\)</span> for albumin and <span class="math inline">\(P^f/P^m = 0.456\)</span> for AAG (<a href="http://dx.doi.org/10.1208/ps040104">McNamara et al., 2019</a>). We
determine the charge state of a compound separately for maternal and
fetal plasma as a function of plasma pH (7.38 for maternal and 7.28 for
fetal ([K.H. Lee, 1972] (<a href="http://dx.doi.org/10.1136/pgmj.48.561.405" class="uri">http://dx.doi.org/10.1136/pgmj.48.561.405</a>)) and
chemical-specific predictions for ionization affinity (that is, pKa
([Strope et al., 2018] (<a href="http://dx.doi.org/10.1016/j.scitotenv.2017.09.033" class="uri">http://dx.doi.org/10.1016/j.scitotenv.2017.09.033</a>))
using the “httk” function “calc_ionization” ([Pearce et al., 2017] (<a href="http://dx.doi.org/10.1007/s10928-017-9548-7" class="uri">http://dx.doi.org/10.1007/s10928-017-9548-7</a>)). If the
fraction of a chemical that is predicted to be in positive ionic form is
greater than 50%, we treat the chemical as a base (which is in its
conjugate acid form) and use only the maternal-to-infant ratio of AAG
concentrations. Otherwise, we assume the chemical is neutral or an acid
and use the ratio of albumin concentrations.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fup.table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>all.chems <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="st">&quot;all&quot;</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>) </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of median fup 0:</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>all.chems <span class="ot">&lt;-</span> <span class="fu">subset</span>(all.chems,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">strsplit</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    all.chems<span class="sc">$</span>Human.Funbound.plasma,<span class="st">&quot;,&quot;</span>),<span class="cf">function</span>(x) x[[<span class="dv">1</span>]])))<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.chem <span class="cf">in</span> all.chems[,<span class="st">&quot;CAS&quot;</span>])</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">chem.cas=</span>this.chem,<span class="at">suppress.messages =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  state <span class="ot">&lt;-</span> <span class="fu">calc_ionization</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">pH=</span><span class="fl">7.26</span>,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">pKa_Donor=</span>temp<span class="sc">$</span>pKa_Donor,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">pKa_Accept=</span>temp<span class="sc">$</span>pKa_Accept)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (state<span class="sc">$</span>fraction_positive <span class="sc">&gt;</span> <span class="fl">0.5</span>) this.charge <span class="ot">&lt;-</span> <span class="st">&quot;Positive&quot;</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (state<span class="sc">$</span>fraction_negative <span class="sc">&gt;</span> <span class="fl">0.5</span>) this.charge <span class="ot">&lt;-</span> <span class="st">&quot;Negative&quot;</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> this.charge <span class="ot">&lt;-</span> <span class="st">&quot;Neutral&quot;</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  this.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DTXSID=</span>all.chems[all.chems[,<span class="st">&quot;CAS&quot;</span>]<span class="sc">==</span>this.chem,<span class="st">&quot;DTXSID&quot;</span>],</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Compound=</span>all.chems[all.chems[,<span class="st">&quot;CAS&quot;</span>]<span class="sc">==</span>this.chem,<span class="st">&quot;Compound&quot;</span>],</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">CAS=</span>this.chem,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fup.Mat.Pred =</span> temp<span class="sc">$</span>Funbound.plasma,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fup.Neo.Pred =</span> temp<span class="sc">$</span>Fraction_unbound_plasma_fetus,</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Charge =</span> this.charge</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  fup.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(fup.table,this.row)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>fup.table[fup.table<span class="sc">$</span>Charge<span class="sc">==</span><span class="st">&quot;Positive&quot;</span>,<span class="st">&quot;Charge&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Positive (n=&quot;</span>,</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(fup.table<span class="sc">$</span>Charge<span class="sc">==</span><span class="st">&quot;Positive&quot;</span>),</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>fup.table[fup.table<span class="sc">$</span>Charge<span class="sc">==</span><span class="st">&quot;Negative&quot;</span>,<span class="st">&quot;Charge&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Negative (n=&quot;</span>,</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(fup.table<span class="sc">$</span>Charge<span class="sc">==</span><span class="st">&quot;Negative&quot;</span>),</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>fup.table[fup.table<span class="sc">$</span>Charge<span class="sc">==</span><span class="st">&quot;Neutral&quot;</span>,<span class="st">&quot;Charge&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Neutral (n=&quot;</span>,</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(fup.table<span class="sc">$</span>Charge<span class="sc">==</span><span class="st">&quot;Neutral&quot;</span>),</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div id="plot-the-fetal-protein-binding-changes-predicted" class="section level2">
<h2>Plot the fetal protein binding changes predicted:</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>FigA  <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>fup.table) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.25</span>, <span class="fu">aes</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>Fup.Mat.Pred,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>Fup.Neo.Pred,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape=</span>Charge,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>Charge),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span><span class="dv">3</span>)   <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">intercept=</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Adjusted Neonate &quot;</span>,f[up]))) <span class="sc">+</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">&quot;In vitro&quot;</span>),<span class="st">&quot; Measured Adult &quot;</span>,f[up]))) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">label=</span>scientific_10) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigA) </span></code></pre></div>
</div>
<div id="maternal-fetal-predictions-across-httk-chemical-library" class="section level2">
<h2>Maternal-Fetal Predictions across HTTK Chemical Library:</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">13</span> <span class="sc">*</span> <span class="dv">7</span>, <span class="dv">40</span> <span class="sc">*</span> <span class="dv">7</span>, <span class="fl">0.25</span>),<span class="fu">seq</span>(<span class="dv">278</span>,<span class="dv">280</span>,.<span class="dv">1</span>))))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>MFratio.pred <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>all.chems <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;Funbound.plasma&quot;</span>),</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> all.chems<span class="sc">$</span>CAS)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((this.cas <span class="sc">%in%</span> nonvols) <span class="sc">&amp;</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(this.cas <span class="sc">%in%</span> fluoros))</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  this.id <span class="ot">&lt;-</span> all.chems[all.chems<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;DTXSID&quot;</span>]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  Fup <span class="ot">&lt;-</span> <span class="fu">subset</span>(all.chems,DTXSID<span class="sc">==</span>this.id)<span class="sc">$</span>Human.Funbound.plasma </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="sc">!=-</span><span class="dv">1</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="sc">==</span><span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fl">0.9</span> <span class="sc">&amp;</span> </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="sc">&lt;</span><span class="fl">0.1</span>))</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>      skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Fup<span class="sc">==</span> <span class="dv">0</span>) </span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>skip)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  {  </span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">fetal_fup_adjustment =</span><span class="cn">TRUE</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameters=</span>p,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">dose=</span><span class="dv">0</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">times=</span>times,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">doses.per.day=</span><span class="dv">3</span>,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">output.units =</span> <span class="st">&quot;uM&quot;</span>,</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> <span class="fu">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="sc">&gt;</span><span class="dv">279</span>)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> last.row[<span class="sc">!</span><span class="fu">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    new.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">Chemical =</span> all.chems[all.chems<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Compound&quot;</span>],</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">DTXSID =</span> this.id,</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mat.pred =</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">Fet.pred =</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>]),</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">MFratio.pred =</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="sc">/</span><span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    MFratio.pred <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MFratio.pred,new.row)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="histogram-of-maternal-fetal-ratio" class="section level2">
<h2>Histogram of maternal-fetal ratio</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>FigD <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>MFratio.pred)<span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>,<span class="at">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="fu">aes</span>(MFratio.pred))<span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Maternal:Fetal Plasma Concentration Ratio&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigD)</span></code></pre></div>
</div>
<div id="statistics-on-maternal-fetal-ratio-for-full-httk-library" class="section level2">
<h2>Statistics on maternal-fetal ratio for full HTTK library</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>max.chem <span class="ot">&lt;-</span> MFratio.pred[<span class="fu">which</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  MFratio.pred<span class="sc">$</span>MFratio.pred<span class="sc">==</span><span class="fu">max</span>(MFratio.pred<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>min.chem <span class="ot">&lt;-</span> MFratio.pred[<span class="fu">which</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  MFratio.pred<span class="sc">$</span>MFratio.pred<span class="sc">==</span><span class="fu">min</span>(MFratio.pred<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),]</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;In Figure X we examine the ratios predicted for the &quot;</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(MFratio.pred)[<span class="dv">1</span>],</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; appropriate (non-volatile or PFAS) chemicals with measured HTTK data.</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;We observe a median ratio of &quot;</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">median</span>(MFratio.pred<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">3</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;, with values ranging from &quot;</span>,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(min.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  min.chem[,<span class="st">&quot;DTXSID&quot;</span>],</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; to &quot;</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(max.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  max.chem[,<span class="st">&quot;DTXSID&quot;</span>],</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out phys-chem &gt; 1.6, &lt; 1:</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>highratio <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="sc">%in%</span><span class="fu">subset</span>(MFratio.pred,MFratio.pred<span class="sc">&gt;</span><span class="fl">1.6</span>)<span class="sc">$</span>DTXSID)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;There are&quot;</span>,</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(highratio)[<span class="dv">1</span>],</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;chemicals with ratios greater than 1.6, indicating a tendency to have higher concentrations&quot;</span>))</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co"># all highly bound</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>highratio<span class="sc">$</span>Compound</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">apply</span>(highratio,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">as.numeric</span>(x),<span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>lowratio <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="sc">%in%</span><span class="fu">subset</span>(MFratio.pred,MFratio.pred<span class="sc">&lt;</span><span class="fl">0.9</span>)<span class="sc">$</span>DTXSID)</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co"># No obvious pattern</span></span></code></pre></div>
</div>
<div id="examine-maternal-fetal-ratio-predictions-without-fetaul-fup-correction" class="section level2">
<h2>Examine Maternal-Fetal ratio Predictions without fetaul Fup
correction:</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">13</span> <span class="sc">*</span> <span class="dv">7</span>, <span class="dv">40</span> <span class="sc">*</span> <span class="dv">7</span>, <span class="fl">0.25</span>),<span class="fu">seq</span>(<span class="dv">278</span>,<span class="dv">280</span>,.<span class="dv">1</span>))))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>MFratio.pred.nofup <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>all.chems <span class="ot">&lt;-</span> <span class="fu">get_cheminfo</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model=</span><span class="st">&quot;fetal_pbtk&quot;</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">info=</span><span class="fu">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;Funbound.plasma&quot;</span>),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (this.cas <span class="cf">in</span> all.chems<span class="sc">$</span>CAS)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((this.cas <span class="sc">%in%</span> nonvols) <span class="sc">&amp;</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(this.cas <span class="sc">%in%</span> fluoros))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  this.id <span class="ot">&lt;-</span> all.chems[all.chems<span class="sc">$</span>CAS<span class="sc">==</span>this.cas,<span class="st">&quot;DTXSID&quot;</span>]</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  Fup <span class="ot">&lt;-</span> <span class="fu">subset</span>(all.chems,DTXSID<span class="sc">==</span>this.id)<span class="sc">$</span>Human.Funbound.plasma </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">regexpr</span>(<span class="st">&quot;,&quot;</span>,Fup)<span class="sc">!=-</span><span class="dv">1</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])<span class="sc">==</span><span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">3</span>])<span class="sc">&gt;</span><span class="fl">0.9</span> <span class="sc">&amp;</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">strsplit</span>(Fup,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])<span class="sc">&lt;</span><span class="fl">0.1</span>))</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>      skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (Fup<span class="sc">==</span> <span class="dv">0</span>) </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    skip <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> skip <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>skip)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  {  </span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">parameterize_fetal_pbtk</span>(<span class="at">dtxsid=</span>this.id,</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">fetal_fup_adjustment =</span><span class="cn">FALSE</span>,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)<span class="er">)</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">solve_fetal_pbtk</span>(</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameters=</span>p,</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">dose=</span><span class="dv">0</span>,</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">times=</span>times,</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">daily.dose=</span><span class="dv">1</span>,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">doses.per.day=</span><span class="dv">3</span>,</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">output.units =</span> <span class="st">&quot;uM&quot;</span>,</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">suppress.messages=</span><span class="cn">TRUE</span>)</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> <span class="fu">which</span>(out[,<span class="st">&quot;time&quot;</span>]<span class="sc">&gt;</span><span class="dv">279</span>)</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>    last.row <span class="ot">&lt;-</span> last.row[<span class="sc">!</span><span class="fu">duplicated</span>(out[last.row,<span class="st">&quot;time&quot;</span>])]</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    new.row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">Chemical =</span> all.chems[all.chems<span class="sc">$</span>DTXSID<span class="sc">==</span>this.id,<span class="st">&quot;Compound&quot;</span>],</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">DTXSID =</span> this.id,</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mat.pred =</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>]),</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">Fet.pred =</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>]),</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">MFratio.pred =</span> <span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cplasma&quot;</span>])<span class="sc">/</span><span class="fu">mean</span>(out[last.row,<span class="st">&quot;Cfplasma&quot;</span>])</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    MFratio.pred.nofup <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MFratio.pred.nofup,new.row)</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  <span class="er">}</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>  <span class="er">}</span></span></code></pre></div>
</div>
<div id="supplemental-histogram-of-maternal-fetal-ratio-without-fup-correction" class="section level2">
<h2>Supplemental Histogram of maternal-fetal ratio without Fup
correction</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>FigSupD <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>MFratio.pred.nofup)<span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>,<span class="at">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="fu">aes</span>(MFratio.pred))<span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Maternal:Fetal Plasma Concentration Ratio (No Fup Corr.)&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>( <span class="at">text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FigSupD)</span></code></pre></div>
</div>
<div id="statistics-on-maternal-fetal-ratio-for-full-httk-library-without-fup-correction" class="section level2">
<h2>Statistics on maternal-fetal ratio for full HTTK library without Fup
correction</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>max.chem <span class="ot">&lt;-</span> MFratio.pred.nofup[<span class="fu">which</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  MFratio.pred.nofup<span class="sc">$</span>MFratio.pred<span class="sc">==</span><span class="fu">max</span>(MFratio.pred.nofup<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>min.chem <span class="ot">&lt;-</span> MFratio.pred.nofup[<span class="fu">which</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  MFratio.pred.nofup<span class="sc">$</span>MFratio.pred<span class="sc">==</span><span class="fu">min</span>(MFratio.pred.nofup<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>)),]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;In Figure X we examine the ratios predicted for the &quot;</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(MFratio.pred)[<span class="dv">1</span>],</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; appropriate (non-volatile or PFAS) chemicals with measured HTTK data.</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;We observe a median ratio of &quot;</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(<span class="fu">median</span>(MFratio.pred.nofup<span class="sc">$</span>MFratio.pred,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="dv">3</span>),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;, with values ranging from &quot;</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(min.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  min.chem[,<span class="st">&quot;DTXSID&quot;</span>],</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; to &quot;</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">signif</span>(max.chem[,<span class="st">&quot;MFratio.pred&quot;</span>],<span class="dv">3</span>),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; for &quot;</span>,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  max.chem[,<span class="st">&quot;DTXSID&quot;</span>],</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;.</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out phys-chem &gt; 1.6, &lt; 1:</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>highratio <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="sc">%in%</span><span class="fu">subset</span>(MFratio.pred.nofup,MFratio.pred<span class="sc">&gt;</span><span class="fl">1.6</span>)<span class="sc">$</span>DTXSID)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;There are&quot;</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(highratio)[<span class="dv">1</span>],</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;chemicals with ratios greater than 1.6, indicating a tendency to have higher concentrations&quot;</span>))</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="co"># all highly bound</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>highratio<span class="sc">$</span>Compound</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">apply</span>(highratio,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">as.numeric</span>(x),<span class="at">na.rm=</span><span class="dv">2</span>)))</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>lowratio <span class="ot">&lt;-</span> <span class="fu">subset</span>(chem.physical_and_invitro.data,DTXSID<span class="sc">%in%</span><span class="fu">subset</span>(MFratio.pred.nofup,MFratio.pred<span class="sc">&lt;</span><span class="fl">0.9</span>)<span class="sc">$</span>DTXSID)</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="co"># No obvious pattern</span></span></code></pre></div>
</div>
</div>
<div id="code-used-to-create-data-distributed-with-vignette" class="section level1">
<h1>Code used to create data distributed with vignette</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>aylward2014 <span class="ot">&lt;-</span>MFdata</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pregnonpregaucs <span class="ot">&lt;-</span> TKstats</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>fetalpcs <span class="ot">&lt;-</span> Curley.pcs</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>wang2018 <span class="ot">&lt;-</span> Wangchems</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(aylward2014,pregnonpregaucs,fetalpcs,wang2018,pksim.pcs,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">file=</span><span class="st">&quot;Kapraun2022Vignette.RData&quot;</span>,<span class="at">version=</span><span class="dv">2</span>)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
