---
title: "Kreutz et al. (2022): Analysis of Plasma Binding Measured by GC"
author: "Anna Kreutz, Matthew Scott Clifton, W. Matthew Henderson, Marci G. Smeltz, John F. Wambaugh, and Barbara A. Wetmore"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Kreutz (2022): PFAS Plasma Binding}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
  *Please send questions to wambaugh.john@epa.gov*
  
  from "Category-Based Toxicokinetic Evaluations of Data-Poor Per and Polyfluoroalkyl Substances (PFAS) by Gas Chromatography Coupled with Mass Spectrometry"

Anna Kreutz, Matthew Scott Clifton, W. Matthew Henderson, Marci G. Smeltz, John F. Wambaugh, and Barbara A. Wetmore

## Abstract

Concern over per- and polyfluoroalkyl substances (PFAS) has increased significantly as more is learned about their widespread environmental presence, persistence, and bioaccumulative potential. The limited measurement, monitoring, toxicokinetic (TK), and toxicologic data currently available is inadequate to inform risk evaluations across this diverse domain. In this study, 73 PFAS were selected for *in vitro* TK evaluation to expand our knowledge across lesser studied PFAS that include alcohol, amide, and acrylate functional groups. Targeted analytical methods were developed using gas chromatography coupled with tandem mass spectrometry (GC-MS/MS); ultracentrifugation was used to measure human plasma protein binding and human hepatocyte suspensions were used in a substrate depletion approach to measure in vitro clearance (Clint). Method development was successful in plasma for 43 PFAS, with fraction unbound in plasma ($f_{up}$) values ranging from 0.004 for 1,6-dibromododecafluorohexane and 1 for 2-aminohexafluoropropan-2-ol, With a median $f_{up}$ of 0.09 (i.e., 91% bound), these PFAS are highly bound, but exhibit 10-fold lower binding than that recently reported for legacy perfluoroalkyl acids (Smeltz et al., 2022). Physico-chemical property trends analyses revealed that increased binding was associated with increases in mass, van der Waals volumes, and values of Log Pow and Log D at pH 7.4. Thirty of the PFAS evaluated in the hepatocyte assay showed abiotic loss, with many exceeding 60% loss within 60 min of media addition. Metabolic clearance was noted for 11 of the 13 successfully evaluated, with rates up to 49.9 l/min/million cells for 1H,1H,10H,10H-Perfluorodecane-1,10-diol. The Chemical Transformation Simulator revealed potential metabolites and other transformation products to consider during *in vitro* assay data interpretation. This integration of quantitative analytic methods with *in vitro* toxicokinetics has provided critical learnings as New Approach Methods are considered to evaluate PFAS for which volatility, metabolism, and other routes of transformation are likely to modulate their environmental fate. 

## HTTK Version

This vignette was created with **httk** v2.3.0. Although we attempt to maintain 
backward compatibility, if you encounter issues with the latest release of 
**httk**
  and cannot easily address the changes, historical versions of httk are 
available from: https://cran.r-project.org/src/contrib/Archive/httk/
  
  ## Prepare for session
```{r}
knitr::opts_chunk$set(collapse = TRUE, comment = '#>')
options(rmarkdown.html_vignette.check_title = FALSE)
```

### Load the relevant libraries
If you get the message "Error in library(X) : there is no package called 'X'"
then you will need to install that package: 
  
  From the R command prompt:
  
  install.packages("X")

Or, if using RStudio, look for 'Install Packages' under 'Tools' tab.

```{r load_packages, eval = TRUE}
# Clear the memory:
rm(list=ls()) 
#
#
# Setup
#
#
library(ggplot2)
library(httk)
library(grid)
```


### Multiple plot function
From http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/
 ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
 - cols:   Number of columns in layout
 - layout: A matrix specifying the layout. If present, 'cols' is ignored.

 If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
 then plot 1 will go in the upper left, 2 will go in the upper right, and
 3 will go all the way across the bottom.
```{r multi.plot, eval = TRUE}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL, heights=NULL, widths=unit(rep_len(1, cols), "null")) {

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    if (!is.null(heights))
    {
      pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout),heights=heights,widths=widths)))
    } else {
      pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout),widths=widths)))
    }
    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
```
### Distribution coefficient
```{r calc_dow, eval = TRUE}
calc_dow <- function(Pow,pH=NA,pKa_Donor=NA,pKa_Accept=NA,fraction_charged=NULL,alpha=0.001) 
{
  # Octanol:water distribution coefficient,
  if (is.null(fraction_charged))
  {
    if (is.na(pH)) stop("pH or fraction_charged must be specified in calc_dow.")
    ionization <- calc_ionization(pH=pH,pKa_Donor=pKa_Donor,pKa_Accept=pKa_Accept)
    fraction_charged  <- ionization[["fraction_charged"]]
  }
  
  Dow <- Pow*(1 + (alpha - 1)*fraction_charged)
  return(Dow)
}
```

# Analysis of Kreutz et al. (2022) $f_{up}$ data

Create a subset of httk data where we know $f_{up}$. We drop the $f_{up}$ measurements of "0" since those
are < limit of detection in earlier studies (
[Wetmore, 2012](https://doi.org/10.1093/toxsci/kfr254), 
[Wetmore, 2015](https://doi.org/10.1093/toxsci/kfv171)). We don't have quantitative values for analysis of those chemicals.
```{r subset_chems, eval = TRUE}
fup.subset <- subset(chem.physical_and_invitro.data,
                     !is.na(Human.Funbound.plasma))
fup.subset <- subset(fup.subset, Human.Funbound.plasma != "0")
fup.subset$Human.Funbound.plasma <- sapply(
  fup.subset$Human.Funbound.plasma, function(x) 
    as.numeric(strsplit(x,",")[[1]][1]))
fup.subset <- subset(fup.subset, Human.Funbound.plasma < 1)
```

Calculate Log D in plasma (pH=7.4)
```{r calc_logd, eval = TRUE}
fup.subset$logD74 <- apply(fup.subset, 1, function(x) log10(calc_dow(
  Pow=10^as.numeric(x[["logP"]]), 
  pKa_Accept = x[["pKa_Accept"]], 
  pKa_Donor = x[["pKa_Donor"]],
  pH = 7.4)))
```

Group the chemicals.
```{r group_chems, eval = TRUE}
non.pfas <- fup.subset[regexpr("PFAS",
               fup.subset$Chemical.Class)== -1,]
kreutz <- fup.subset[
               !is.na(fup.subset$Human.Funbound.plasma.Reference),]
kreutz <- kreutz[regexpr("Kreutz",
               kreutz$Human.Funbound.plasma.Reference)!=-1,]
pfas <- fup.subset[regexpr("PFAS",
               fup.subset$Chemical.Class)!= -1,]
dim(non.pfas)
dim(kreutz)
dim(pfas)
```

Summary statistics for $f_{up}$. Let's see what the median and lower 2.5% quantiles are for both non-PFAS and PFAS.
```{r fup_stats, eval = TRUE}
median(non.pfas$Human.Funbound.plasma)
quantile(non.pfas$Human.Funbound.plasma,0.025)
median(pfas$Human.Funbound.plasma)
quantile(pfas$Human.Funbound.plasma,0.025)
median(kreutz$Human.Funbound.plasma)
quantile(kreutz$Human.Funbound.plasma,0.025)
```
```{r make_physchemtable, eval = TRUE}
physchem <- rbind(non.pfas,pfas)
physchem$PFAS <- 0
physchem$GCPFAS <- 0
physchem[physchem$DTXSID %in% pfas$DTXSID,"PFAS"] <- 1
physchem[physchem$DTXSID %in% kreutz$DTXSID,"GCPFAS"] <- 1
physchem$PFAS <- factor(physchem$PFAS)
physchem$GCPFAS <- factor(physchem$GCPFAS)
```
## Test for differences between chemical sets

We consider three sets of chemicals: 1) 1681 non-PFAS chemicals with $f_{up}$ 
collected from the literature by R package "httk", 2) 114 PFAS with $f_up$ 
measurements, and 3) the 44 chemicals measured by GC here, which
are a subset of the 114. For each set we examine the dependence of $f_{up}$ on
physico-chemical properties and test for differences between the three sets.

### Dependence on hydrophobicity (log P):
```{r logp, eval = TRUE}
fit.logp <- lm(data=physchem,Human.Funbound.plasma ~ logP*PFAS*GCPFAS)
summary(fit.logp)
```
```{r logp.best.model, eval = TRUE}
fit.logp.best <- lm(data=physchem,Human.Funbound.plasma ~ logP*PFAS)
summary(fit.logp.best)
```
$f_{up}$ decreases with logP for all chemicals, but more so for the
PFAS (significance 0.00011). The PFAS measured by GC are not significantly 
different from other PFAS.

### Dependence on hydrophobicity (log P):
```{r logd, eval = TRUE}
fit.logd <- lm(data=physchem,Human.Funbound.plasma ~ logD74*PFAS*GCPFAS)
summary(fit.logd)
```
```{r logd.best.model, eval = TRUE}
fit.logd.best <- lm(data=physchem,Human.Funbound.plasma ~ logD74*PFAS)
summary(fit.logd.best)
```
$f_{up}$ decreases with logP for all chemicals, but more so for the
PFAS (significance 3.11e-07). The PFAS measured by GC are not significantly 
different from other PFAS..


### Dependence on water solubility (logWSol):
```{r logwsol, eval = TRUE}
fit.logwsol <- lm(data=physchem,Human.Funbound.plasma ~ logWSol*PFAS*GCPFAS)
summary(fit.logwsol)
```
```{r logwsol.best.model, eval = TRUE}
fit.logwsol.best <- lm(data=physchem,Human.Funbound.plasma ~ logWSol*PFAS)
summary(fit.logwsol.best)
```
$f_{up}$ increases with logWSol for all chemicals, but decreases for the
PFAS (significance 2.98e-13). The PFAS measured by GC are not significantly 
different from other PFAS..

### Dependence on molecular weight (MW):
```{r MW, eval = TRUE}
fit.mw <- lm(data=physchem,Human.Funbound.plasma ~ MW*PFAS*GCPFAS)
summary(fit.mw)
```
```{r MW.best, eval = TRUE}
fit.mw.best <- lm(data=physchem,Human.Funbound.plasma ~ MW)
summary(fit.mw.best)
```
$f_{up}$ decreases with molecular weight for all chemicals, 
but there is no statistically significant difference for PFAS.

### Dependence on Henry's law constant (logHenry):
```{r henry, eval = TRUE}
fit.henry <- lm(data=physchem,Human.Funbound.plasma ~ logHenry*PFAS*GCPFAS)
summary(fit.henry)
```
```{r henry.best, eval = TRUE}
fit.henry.best <- lm(data=physchem,Human.Funbound.plasma ~ logHenry)
summary(fit.henry.best)
```
$f_{up}$ decreases with the Henry's law constant for all chemicals, 
but there is no statistically significant difference for PFAS.

```{r fig_logP, eval = TRUE}
FONT.SIZE <- 9
kreutz$PFAS<-0
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$logPfit1 <- predict(fit.logp.best,kreutz)
kreutz$PFAS<-1
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$logPfit2 <- predict(fit.logp.best,kreutz)
fig.logp  <- ggplot(data=kreutz) +
  geom_point(aes(
    x=logP,
    y=Human.Funbound.plasma),
    size=3,
    color="Black") +
  geom_line(aes(x=logP,y=logPfit1),color="black") + 
  geom_line(aes(x=logP,y=logPfit2),color="blue",linetype = "dashed") +
   #ylab("Fraction unbound in plasma") + 
  ylab("") +
  xlab(bquote("Log "~P[ow])) +
  theme_bw()  +
  theme( text  = element_text(size=FONT.SIZE))

print(fig.logp)
```
```{r fig_logD, eval = TRUE}
kreutz$PFAS<-0
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$logDfit1 <- predict(fit.logd.best,kreutz)
kreutz$PFAS<-1
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$logDfit2 <- predict(fit.logd.best,kreutz)
fig.logd  <- ggplot(data=kreutz) +
  geom_point(aes(
    x=logD74,
    y=Human.Funbound.plasma),
    size=3,
    color="Black") +
  geom_line(aes(x=logD74,y=logDfit1),color="black") + 
  geom_line(aes(x=logD74,y=logDfit2),color="blue",linetype = "dashed") +
  ylab("Fraction unbound in plasma") + 
  xlab("Log D, pH 7.4") +
  theme_bw()  +
  theme( text  = element_text(size=FONT.SIZE))

print(fig.logd)
```

```{r fig_mw, eval = TRUE}
kreutz$PFAS<-0
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$MWfit <- predict(fit.mw.best,kreutz)
fig.mw <- ggplot(data=kreutz) +
  geom_point(aes(
    x=MW,
    y=Human.Funbound.plasma),
    size=3,
    color="Black") +
  geom_line(aes(x=MW,y=MWfit),color="black") + 
   #ylab("Fraction unbound in plasma") + 
  ylab("") +
  xlab("Molecular Weight (g/mol)") +
  theme_bw()  +
  theme( text  = element_text(size=FONT.SIZE))

print(fig.mw)
```


```{r fig_wsol, eval = TRUE}
kreutz$PFAS<-0
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$logWSolfit1 <- predict(fit.logwsol.best,kreutz)
kreutz$PFAS<-1
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$logWSolfit2 <- predict(fit.logwsol.best,kreutz)
fig.wsol  <- ggplot(data=kreutz) +
  geom_point(aes(
    x=logWSol,
    y=Human.Funbound.plasma),
    size=3,
    color="Black") +
  geom_line(aes(x=logWSol,y=logWSolfit1),color="black") + 
  geom_line(aes(x=logWSol,y=logWSolfit2),color="blue",linetype = "dashed") + 
  #ylab("Fraction unbound in plasma") + 
  ylab("") +
  xlab("Log Water Solubility (mg/L)") +
  theme_bw()  +
  theme( text  = element_text(size=FONT.SIZE))

print(fig.wsol)
```


```{r fig_henry, eval = TRUE}
kreutz$PFAS<-0
kreutz$PFAS <- factor(kreutz$PFAS,levels=c(0,1))
kreutz$Henryfit <- predict(fit.henry.best,kreutz)
fig.henry  <- ggplot(data=kreutz) +
  geom_point(aes(
    x=logHenry,
    y=Human.Funbound.plasma),
    size=3,
    color="Black") +
  geom_line(aes(x=logHenry,y=Henryfit),color="black") + 
  #ylab("Fraction unbound in plasma") + 
  ylab("") +
  xlab("Henry's Law Constant (logHenry)") +
  theme_bw()  +
  theme( text  = element_text(size=FONT.SIZE))

print(fig.henry)
```

```{r fig_legend, eval = TRUE}
kreutz$Chemical.Class <- sample(c("PFAS","Non-PFAS"),
                                  dim(kreutz)[1],
                                  replace=TRUE)
fig.legend <- ggplot(data=kreutz) +
  geom_line(aes(x=logWSol,y=logWSolfit1,color=Chemical.Class)) +
  #ylab("Fraction unbound in plasma") + 
  scale_color_manual(values=c("black","blue"),name = "") +
  ylab("") +
  xlab("") +
    theme_bw()  +
    geom_line(aes(x=logWSol,y=logWSolfit1),color="white",size=3) +
  guides(shape = FALSE,colour = guide_legend(override.aes = list(shape = c(NA, NA),
                                                   linetype = c("solid","dashed"))))+
  theme(
    panel.grid = element_blank(),
        axis.title = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
    panel.border = element_blank(),
        panel.background = element_blank())+
   theme(legend.key.height= unit(1.5, 'cm'),
        legend.key.width= unit(6, 'cm'))+
  theme( text  = element_text(size=FONT.SIZE)) 

print(fig.legend)
```
```{r fig_combined, eval = TRUE}
multiplot(fig.mw,fig.logp,fig.logd,fig.wsol,fig.henry,fig.legend,cols=2,widths=c(1.75,1.75))
```

```{r evaluate_predictors, eval=TRUE}
fups <- get_cheminfo(info=c("DTXSID","Funbound.plasma"))
preds <- merge(pfas.fup.predictions,fups,by.x="Admet",by.y="DTXSID")
colnames(preds)[3] <- "ADMet"
colnames(preds)[7] <- "OPERA26"
colnames(preds)[11] <- "OPERA29"
colnames(preds)[15] <- "Dawson26"
colnames(preds)[18] <- "Dawson29"
for (this.col in c(3,7,11,15,18)) preds[,this.col] <- as.numeric(preds[,this.col])
preds$Obs.Med <- sapply(preds$Human.Funbound.plasma,function(x) as.numeric(strsplit(x,",")[[1]][1]))
summary(lm(Obs.Med ~ ADMet,data=preds))
summary(lm(Obs.Med ~ OPERA29,data=preds))
summary(lm(Obs.Med ~ OPERA29,data=preds))
summary(lm(Obs.Med ~ Dawson26,data=preds))
summary(lm(Obs.Med ~ Dawson29,data=preds))```