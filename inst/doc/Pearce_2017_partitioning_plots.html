<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Robert Pearce" />

<meta name="date" content="2019-02-04" />

<title>Pearce et al. 2017 Figures in Partition Coefficient Evaluation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Pearce et al. 2017 Figures in Partition Coefficient Evaluation</h1>
<h4 class="author"><em>Robert Pearce</em></h4>
<h4 class="date"><em>2019-02-04</em></h4>



<p>This vignette generates the data and figures from the partition coefficient evaluation paper.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(gdata)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(CensRegMod)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(gmodels)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(gplots)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(colorspace)</a></code></pre></div>
<p>We first filter the measured rat Kp data, pc.data. Then the old and new Kp predictions are made, along with error and improvement measures, and these are all consolidated into a table for analysis and plotting. Note that the final table contains log10-transformed values and error and improvements derived from subtracting these values. Only relevant rat values are used. Compounds with Funbound.plasma and partition coefficients of zero are removed as well as compounds with approximated Funbound.plasma values.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">pc.table &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-2" title="2">pc.data &lt;-<span class="st"> </span><span class="kw">subset</span>(pc.data,fu <span class="op">!=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>Exp_PC <span class="op">!=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>Tissue <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Adipose&quot;</span>,<span class="st">&quot;Bone&quot;</span>,<span class="st">&quot;Brain&quot;</span>,<span class="st">&quot;Gut&quot;</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="st">&quot;Heart&quot;</span>,<span class="st">&quot;Kidney&quot;</span>,<span class="st">&quot;Liver&quot;</span>,<span class="st">&quot;Lung&quot;</span>,<span class="st">&quot;Muscle&quot;</span>,<span class="st">&quot;Skin&quot;</span>,<span class="st">&quot;Spleen&quot;</span>,<span class="st">&quot;Blood Cells&quot;</span>) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="st">    </span><span class="kw">tolower</span>(Species) <span class="op">==</span><span class="st"> &#39;rat&#39;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>CAS <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;10457-90-6&#39;</span>,<span class="st">&#39;5786-21-0&#39;</span>,<span class="st">&#39;17617-23-1&#39;</span>,<span class="st">&#39;69-23-8&#39;</span>,<span class="st">&#39;2898-12-6&#39;</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="st">&#39;57562-99-9&#39;</span>,<span class="st">&#39;59-99-4&#39;</span>,<span class="st">&#39;2955-38-6&#39;</span>,<span class="st">&#39;155-97-5&#39;</span>,<span class="st">&#39;41903-57-5&#39;</span>,<span class="st">&#39;58-55-9&#39;</span>,<span class="st">&#39;77-32-7&#39;</span>,<span class="st">&#39;59-05-2&#39;</span>,<span class="st">&#39;60-54-8&#39;</span>))</a>
<a class="sourceLine" id="cb2-6" title="6">cas.list &lt;-<span class="st"> </span><span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&#39;schmitt&#39;</span>,<span class="dt">species=</span><span class="st">&#39;rat&#39;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">cas.list &lt;-<span class="st">  </span>cas.list[cas.list <span class="op">%in%</span><span class="st"> </span>pc.data[,<span class="st">&#39;CAS&#39;</span>]]</a>
<a class="sourceLine" id="cb2-8" title="8">ma.data.list &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,<span class="op">!</span><span class="kw">is.na</span>(logMA))[,<span class="st">&#39;CAS&#39;</span>]</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="cf">for</span>(this.cas <span class="cf">in</span> cas.list){</a>
<a class="sourceLine" id="cb2-10" title="10">  parameters &lt;-<span class="st"> </span><span class="kw">parameterize_schmitt</span>(<span class="dt">chem.cas=</span>this.cas,<span class="dt">species=</span><span class="st">&#39;rat&#39;</span>)</a>
<a class="sourceLine" id="cb2-11" title="11">  init.parameters &lt;-<span class="st"> </span>parameters</a>
<a class="sourceLine" id="cb2-12" title="12">  charge &lt;-<span class="st"> </span><span class="kw">calc_ionization</span>(<span class="dt">chem.cas=</span>this.cas,<span class="dt">pH=</span><span class="fl">7.4</span>)<span class="op">$</span>fraction_charged</a>
<a class="sourceLine" id="cb2-13" title="13">  <span class="cf">if</span>(<span class="op">!</span>this.cas <span class="op">%in%</span><span class="st"> </span>ma.data.list){</a>
<a class="sourceLine" id="cb2-14" title="14">    init.parameters<span class="op">$</span>MA &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="fl">0.999831</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.016578</span><span class="op">*</span><span class="fl">38.7</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.881721</span> <span class="op">*</span><span class="st"> </span><span class="kw">log10</span>(parameters<span class="op">$</span>Pow))</a>
<a class="sourceLine" id="cb2-15" title="15">  }</a>
<a class="sourceLine" id="cb2-16" title="16">  pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>parameters,<span class="dt">species=</span><span class="st">&#39;rat&#39;</span>,<span class="dt">regression=</span>F)</a>
<a class="sourceLine" id="cb2-17" title="17">  init.pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>init.parameters,<span class="dt">species=</span><span class="st">&#39;rat&#39;</span>,<span class="dt">regression=</span>F)</a>
<a class="sourceLine" id="cb2-18" title="18">  <span class="cf">for</span>(this.tissue <span class="cf">in</span> <span class="kw">subset</span>(pc.data,CAS<span class="op">==</span>this.cas)[,<span class="st">&#39;Tissue&#39;</span>]){</a>
<a class="sourceLine" id="cb2-19" title="19">    <span class="cf">if</span>(this.tissue <span class="op">==</span><span class="st"> &#39;Blood Cells&#39;</span>) this.pc &lt;-<span class="st"> &#39;rbc&#39;</span></a>
<a class="sourceLine" id="cb2-20" title="20">    <span class="cf">else</span> this.pc &lt;-<span class="st"> </span>this.tissue</a>
<a class="sourceLine" id="cb2-21" title="21">    pc.table &lt;-<span class="st"> </span><span class="kw">rbind</span>(pc.table,<span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(this.cas),<span class="kw">as.data.frame</span>(this.tissue),</a>
<a class="sourceLine" id="cb2-22" title="22">    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(init.pcs[[<span class="kw">which</span>(<span class="kw">substr</span>(<span class="kw">names</span>(init.pcs),<span class="dv">2</span>,<span class="kw">nchar</span>(<span class="kw">names</span>(init.pcs))<span class="op">-</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-23" title="23">                                  <span class="op">==</span><span class="st"> </span><span class="kw">tolower</span>(this.pc))]] <span class="op">*</span><span class="st"> </span>init.parameters<span class="op">$</span>Funbound.plasma)),</a>
<a class="sourceLine" id="cb2-24" title="24">    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(pcs[[<span class="kw">which</span>(<span class="kw">substr</span>(<span class="kw">names</span>(pcs),<span class="dv">2</span>,<span class="kw">nchar</span>(<span class="kw">names</span>(pcs))<span class="op">-</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-25" title="25">                             <span class="op">==</span><span class="st"> </span><span class="kw">tolower</span>(this.pc))]] <span class="op">*</span><span class="st"> </span>parameters<span class="op">$</span>unadjusted.Funbound.plasma)),</a>
<a class="sourceLine" id="cb2-26" title="26">    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(init.pcs[[<span class="kw">which</span>(<span class="kw">substr</span>(<span class="kw">names</span>(init.pcs),<span class="dv">2</span>,<span class="kw">nchar</span>(<span class="kw">names</span>(init.pcs))<span class="op">-</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-27" title="27">                                  <span class="op">==</span><span class="st"> </span><span class="kw">tolower</span>(this.pc))]] <span class="op">*</span><span class="st"> </span>init.parameters<span class="op">$</span>unadjusted.Funbound.plasma)),</a>
<a class="sourceLine" id="cb2-28" title="28">    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(pcs[[<span class="kw">which</span>(<span class="kw">substr</span>(<span class="kw">names</span>(pcs),<span class="dv">2</span>,<span class="kw">nchar</span>(<span class="kw">names</span>(pcs))<span class="op">-</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-29" title="29">                             <span class="op">==</span><span class="st"> </span><span class="kw">tolower</span>(this.pc))]] <span class="op">*</span><span class="st"> </span>parameters<span class="op">$</span>Funbound.plasma)),</a>
<a class="sourceLine" id="cb2-30" title="30">    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(<span class="kw">subset</span>(pc.data,CAS<span class="op">==</span>this.cas <span class="op">&amp;</span><span class="st"> </span>Tissue<span class="op">==</span>this.tissue)[,<span class="st">&#39;Exp_PC&#39;</span>])),</a>
<a class="sourceLine" id="cb2-31" title="31">    <span class="kw">as.data.frame</span>(<span class="kw">subset</span>(pc.data,CAS<span class="op">==</span>this.cas <span class="op">&amp;</span><span class="st"> </span>Tissue<span class="op">==</span>this.tissue)[,<span class="st">&#39;LogP&#39;</span>]),<span class="kw">as.data.frame</span>(charge),</a>
<a class="sourceLine" id="cb2-32" title="32">    <span class="kw">as.data.frame</span>(<span class="kw">as.character</span>(<span class="kw">subset</span>(pc.data,CAS <span class="op">==</span><span class="st"> </span>this.cas)[<span class="dv">1</span>,<span class="st">&#39;A.B.N&#39;</span>])),</a>
<a class="sourceLine" id="cb2-33" title="33">    <span class="kw">as.data.frame</span>(<span class="kw">subset</span>(pc.data,CAS <span class="op">==</span><span class="st"> </span>this.cas)[<span class="dv">1</span>,<span class="st">&#39;fu&#39;</span>])))</a>
<a class="sourceLine" id="cb2-34" title="34">  }</a>
<a class="sourceLine" id="cb2-35" title="35">}</a>
<a class="sourceLine" id="cb2-36" title="36"><span class="kw">colnames</span>(pc.table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;CAS&#39;</span>,<span class="st">&#39;Tissue&#39;</span>,<span class="st">&#39;fup.adjustment&#39;</span>,<span class="st">&#39;ma.adjustment&#39;</span>,<span class="st">&#39;init.Predicted&#39;</span>,</a>
<a class="sourceLine" id="cb2-37" title="37">                        <span class="st">&#39;Predicted&#39;</span>,<span class="st">&#39;Experimental&#39;</span>,<span class="st">&#39;logP&#39;</span>,<span class="st">&#39;charge&#39;</span>,<span class="st">&#39;type&#39;</span>,<span class="st">&#39;fup&#39;</span>)</a>
<a class="sourceLine" id="cb2-38" title="38">init.error &lt;-<span class="st"> </span>pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>pc.table[,<span class="st">&#39;init.Predicted&#39;</span>]</a>
<a class="sourceLine" id="cb2-39" title="39">fup.error &lt;-<span class="st"> </span>pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>pc.table[,<span class="st">&#39;fup.adjustment&#39;</span>]</a>
<a class="sourceLine" id="cb2-40" title="40">ma.error &lt;-<span class="st"> </span>pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>pc.table[,<span class="st">&#39;ma.adjustment&#39;</span>]</a>
<a class="sourceLine" id="cb2-41" title="41">final.error &lt;-<span class="st"> </span>pc.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>pc.table[,<span class="st">&#39;Predicted&#39;</span>]</a>
<a class="sourceLine" id="cb2-42" title="42">fup.improvement &lt;-<span class="st"> </span><span class="kw">abs</span>(init.error) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(fup.error)</a>
<a class="sourceLine" id="cb2-43" title="43">ma.improvement &lt;-<span class="st"> </span><span class="kw">abs</span>(init.error) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(ma.error)</a>
<a class="sourceLine" id="cb2-44" title="44">final.improvement &lt;-<span class="st"> </span><span class="kw">abs</span>(init.error) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(final.error)</a>
<a class="sourceLine" id="cb2-45" title="45">pc.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(pc.table,fup.improvement,ma.improvement, final.improvement,</a>
<a class="sourceLine" id="cb2-46" title="46">                  final.error,init.error,ma.error,fup.error)</a>
<a class="sourceLine" id="cb2-47" title="47"></a>
<a class="sourceLine" id="cb2-48" title="48">scientific_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x) {                                  </a>
<a class="sourceLine" id="cb2-49" title="49">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="kw">scientific_format</span>()(x))              </a>
<a class="sourceLine" id="cb2-50" title="50">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </a>
<a class="sourceLine" id="cb2-51" title="51">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </a>
<a class="sourceLine" id="cb2-52" title="52">  out &lt;-<span class="st"> </span><span class="kw">parse</span>(<span class="dt">text=</span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </a>
<a class="sourceLine" id="cb2-53" title="53">}  </a>
<a class="sourceLine" id="cb2-54" title="54"></a>
<a class="sourceLine" id="cb2-55" title="55"></a>
<a class="sourceLine" id="cb2-56" title="56">init.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data=</span>pc.table,<span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(init.Predicted),<span class="dv">10</span><span class="op">^</span>(Experimental))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-57" title="57"><span class="st">    </span><span class="kw">geom_abline</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])), <span class="dt">x=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-58" title="58"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb2-59" title="59">    <span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-60" title="60"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;(A)&#39;</span>)</a>
<a class="sourceLine" id="cb2-61" title="61"></a>
<a class="sourceLine" id="cb2-62" title="62">final.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data=</span>pc.table,<span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(Predicted),<span class="dv">10</span><span class="op">^</span>(Experimental))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-63" title="63"><span class="st">    </span><span class="kw">geom_abline</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])),<span class="dt">x=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-64" title="64"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb2-65" title="65">    <span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust=</span><span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-66" title="66"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;(B)&#39;</span>)</a>
<a class="sourceLine" id="cb2-67" title="67"></a>
<a class="sourceLine" id="cb2-68" title="68">fup.change.plot &lt;-<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-69" title="69"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span>pc.table[<span class="kw">order</span>(pc.table[,<span class="st">&#39;fup.improvement&#39;</span>],<span class="dt">decreasing=</span>F),],</a>
<a class="sourceLine" id="cb2-70" title="70">    <span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(fup.adjustment),<span class="dv">10</span><span class="op">^</span>(Experimental),<span class="dt">color=</span>fup.improvement)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-71" title="71"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])),<span class="dt">x=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p])),<span class="dt">color=</span><span class="st">&#39;Improvement&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-72" title="72"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-73" title="73"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-74" title="74"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-75" title="75"><span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">direction=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">option=</span><span class="st">&#39;inferno&#39;</span>)</a>
<a class="sourceLine" id="cb2-76" title="76">ma.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(pc.table,<span class="op">!</span>CAS <span class="op">%in%</span><span class="st"> </span>ma.data.list)</a>
<a class="sourceLine" id="cb2-77" title="77">ma.change.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-78" title="78"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span>ma.subset[<span class="kw">order</span>(ma.subset[,<span class="st">&#39;ma.improvement&#39;</span>],<span class="dt">decreasing=</span>F),]</a>
<a class="sourceLine" id="cb2-79" title="79">    ,<span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(ma.adjustment),<span class="dv">10</span><span class="op">^</span>(Experimental),<span class="dt">color=</span>ma.improvement)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-80" title="80"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Measured &quot;</span>,K[p])),<span class="dt">x=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p])),<span class="dt">color=</span><span class="st">&#39;Improvement&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-81" title="81"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-82" title="82"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-83" title="83"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">^</span><span class="fl">4.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-84" title="84"><span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">direction=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">option=</span><span class="st">&#39;inferno&#39;</span>)</a></code></pre></div>
<p>Now we calculate and plot the regressions for all tissues, together with their 95% confidence intervals.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">regressions &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="cf">for</span>(tissue <span class="cf">in</span> <span class="kw">as.character</span>(<span class="kw">unique</span>(pc.table[,<span class="st">&#39;Tissue&#39;</span>]))){</a>
<a class="sourceLine" id="cb3-4" title="4">  fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Experimental <span class="op">~</span><span class="st"> </span>Predicted ,<span class="dt">data=</span><span class="kw">subset</span>(pc.table,Tissue<span class="op">==</span>tissue))</a>
<a class="sourceLine" id="cb3-5" title="5">  smry &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)</a>
<a class="sourceLine" id="cb3-6" title="6">  est &lt;-<span class="st"> </span><span class="kw">estimable</span>(fit, <span class="dt">cm=</span><span class="kw">diag</span>(<span class="dv">2</span>), <span class="dt">beta0=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">joint.test=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-7" title="7">  regressions &lt;-<span class="st"> </span><span class="kw">rbind</span>(regressions,<span class="kw">cbind</span>(tissue,<span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[[<span class="st">&#39;(Intercept)&#39;</span>]]),</a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[[<span class="st">&#39;Predicted&#39;</span>]]),</a>
<a class="sourceLine" id="cb3-9" title="9">      <span class="kw">as.data.frame</span>(smry<span class="op">$</span>coefficients[[<span class="st">&#39;Predicted&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]]),</a>
<a class="sourceLine" id="cb3-10" title="10">      <span class="kw">as.data.frame</span>(smry<span class="op">$</span>sigma),<span class="kw">as.data.frame</span>(smry<span class="op">$</span>r.squared),</a>
<a class="sourceLine" id="cb3-11" title="11">      <span class="kw">as.data.frame</span>(smry[[<span class="dv">11</span>]][<span class="dv">1</span>,<span class="dv">1</span>]),<span class="kw">as.data.frame</span>(smry[[<span class="dv">11</span>]][<span class="dv">2</span>,<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb3-12" title="12">      <span class="kw">as.data.frame</span>(smry[[<span class="dv">11</span>]][<span class="dv">1</span>,<span class="dv">2</span>]),<span class="kw">as.data.frame</span>(smry<span class="op">$</span>df[<span class="dv">2</span>]),<span class="kw">as.data.frame</span>(est[[<span class="dv">3</span>]])))</a>
<a class="sourceLine" id="cb3-13" title="13">}</a>
<a class="sourceLine" id="cb3-14" title="14"><span class="kw">colnames</span>(regressions) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Tissue&#39;</span>,<span class="st">&#39;Intercept&#39;</span>,<span class="st">&#39;Slope&#39;</span>,<span class="st">&#39;P-value&#39;</span>,<span class="st">&#39;SE&#39;</span>,<span class="st">&#39;R-squared&#39;</span>,</a>
<a class="sourceLine" id="cb3-15" title="15">                           <span class="st">&#39;Int Var&#39;</span>,<span class="st">&#39;Slp Var&#39;</span>,<span class="st">&#39;Cov&#39;</span>,<span class="st">&#39;df&#39;</span>,<span class="st">&#39;estimable&#39;</span>)</a>
<a class="sourceLine" id="cb3-16" title="16">x.cf &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="fl">3.5</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb3-17" title="17"><span class="cf">for</span>(tissue <span class="cf">in</span>  <span class="kw">as.character</span>(<span class="kw">unique</span>(pc.table[,<span class="st">&#39;Tissue&#39;</span>]))){</a>
<a class="sourceLine" id="cb3-18" title="18">  conf &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dt">df=</span><span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;df&#39;</span>]]<span class="op">+</span><span class="dv">1</span>) <span class="op">*</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="st">      </span><span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;SE&#39;</span>]] <span class="op">*</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="st">      </span><span class="kw">sqrt</span>(<span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;Int Var&#39;</span>]] <span class="op">+</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="st">      </span>x.cf<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;Slp Var&#39;</span>]] <span class="op">+</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="st">      </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x.cf <span class="op">*</span><span class="st"> </span><span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;Cov&#39;</span>]] <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-23" title="23">  line &lt;-<span class="st"> </span><span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;Intercept&#39;</span>]] <span class="op">+</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="st">      </span>x.cf <span class="op">*</span><span class="st"> </span><span class="kw">subset</span>(regressions,Tissue<span class="op">==</span>tissue)[[<span class="st">&#39;Slope&#39;</span>]]</a>
<a class="sourceLine" id="cb3-25" title="25">  y.cf &lt;-<span class="st"> </span>line <span class="op">+</span><span class="st"> </span>conf</a>
<a class="sourceLine" id="cb3-26" title="26">  y.ncf &lt;-<span class="st"> </span>line <span class="op">-</span><span class="st"> </span>conf</a>
<a class="sourceLine" id="cb3-27" title="27"></a>
<a class="sourceLine" id="cb3-28" title="28">  cf &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(x.cf),<span class="kw">as.data.frame</span>(y.cf),<span class="kw">as.data.frame</span>(y.ncf))</a>
<a class="sourceLine" id="cb3-29" title="29">  <span class="cf">if</span>(tissue <span class="op">==</span><span class="st"> &#39;Blood Cells&#39;</span>){</a>
<a class="sourceLine" id="cb3-30" title="30">    <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text=</span> <span class="kw">paste</span>(<span class="st">&#39;Blood &lt;- ggplot() + labs(y=expression(paste(&quot;Inferred &quot;,K[p])),</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="st">                               x=expression(paste(&quot;Predicted &quot;,K[p]))) + geom_abline(linetype = &quot;dashed&quot;) +</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="st">                               geom_point(data=subset(pc.table,Tissue == </span><span class="ch">\&#39;</span><span class="st">&#39;</span>,tissue,<span class="st">&#39;</span><span class="ch">\&#39;</span><span class="st">),aes(10^(Predicted),</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="st">                               10^(Experimental)))  +  theme(axis.text=element_text(size=14),</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="st">                               axis.title=element_text(size=14),plot.title=element_text(size=14,hjust=0.5)) +</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="st">                               scale_x_log10(label=scientific_10,limits=c(0.01,1000)) + </span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="st">                               scale_y_log10(label=scientific_10,limits=c(0.01,1000)) +</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.cf))) +</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.ncf))) +</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="st">                               geom_abline(intercept=subset(regressions,Tissue==tissue)[[</span><span class="ch">\&#39;</span><span class="st">Intercept</span><span class="ch">\&#39;</span><span class="st">]],</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="st">                               slope=subset(regressions,Tissue==tissue)[[</span><span class="ch">\&#39;</span><span class="st">Slope</span><span class="ch">\&#39;</span><span class="st">]]) +</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="st">                               ggtitle(</span><span class="ch">\&#39;</span><span class="st">Red Blood Cells</span><span class="ch">\&#39;</span><span class="st">)&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>)))</a>
<a class="sourceLine" id="cb3-42" title="42">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb3-43" title="43">    <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text=</span> <span class="kw">paste</span>(tissue,<span class="st">&#39; &lt;- ggplot() + labs(y=expression(paste(&quot;Measured &quot;,K[p]))</span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="st">                               ,x=expression(paste(&quot;Predicted &quot;,K[p]))) + geom_abline(linetype = &quot;dashed&quot;) +</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="st">                               geom_point(data=subset(pc.table,Tissue == </span><span class="ch">\&#39;</span><span class="st">&#39;</span>,tissue,<span class="st">&#39;</span><span class="ch">\&#39;</span><span class="st">),</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="st">                               aes(10^(Predicted),10^(Experimental))) + theme(axis.text=element_text(size=14),</span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="st">                               axis.title=element_text(size=14),plot.title=element_text(size=14,hjust=0.5)) +</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="st">                               scale_x_log10(label=scientific_10,limits=c(0.01,1000)) + </span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="st">                               scale_y_log10(label=scientific_10,limits=c(0.01,1000)) +</span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.cf))) +</span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="st">                               geom_line(data=cf,aes(10^(x.cf),10^(y.ncf))) +</span></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="st">                               geom_abline(intercept=subset(regressions,Tissue==tissue)[[</span><span class="ch">\&#39;</span><span class="st">Intercept</span><span class="ch">\&#39;</span><span class="st">]],</span></a>
<a class="sourceLine" id="cb3-53" title="53"><span class="st">                               slope=subset(regressions,Tissue==tissue)[[</span><span class="ch">\&#39;</span><span class="st">Slope</span><span class="ch">\&#39;</span><span class="st">]]) +</span></a>
<a class="sourceLine" id="cb3-54" title="54"><span class="st">                               ggtitle(</span><span class="ch">\&#39;</span><span class="st">&#39;</span>,tissue,<span class="st">&#39;</span><span class="ch">\&#39;</span><span class="st">)&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>)))</a>
<a class="sourceLine" id="cb3-55" title="55">  }</a>
<a class="sourceLine" id="cb3-56" title="56">}</a></code></pre></div>
<p>In vivo volume of distribution data are compared with the predictions, and errors are calculated. Regressions and improvements are calculated and plotted.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">obach &lt;-<span class="st"> </span><span class="kw">subset</span>(Obach2008,CAS <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&#39;schmitt&#39;</span>))</a>
<a class="sourceLine" id="cb4-2" title="2">vd.table &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="cf">for</span>(this.cas <span class="cf">in</span> obach[,<span class="st">&#39;CAS&#39;</span>]){</a>
<a class="sourceLine" id="cb4-5" title="5">  parameters &lt;-<span class="st"> </span><span class="kw">parameterize_schmitt</span>(<span class="dt">chem.cas=</span>this.cas)</a>
<a class="sourceLine" id="cb4-6" title="6">  init.parameters &lt;-<span class="st"> </span>parameters</a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="cf">if</span>(<span class="op">!</span>this.cas <span class="op">%in%</span><span class="st"> </span>ma.data.list){</a>
<a class="sourceLine" id="cb4-8" title="8">    init.parameters<span class="op">$</span>MA &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span>(<span class="fl">0.999831</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.016578</span><span class="op">*</span><span class="dv">37</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.881721</span> <span class="op">*</span><span class="st"> </span><span class="kw">log10</span>(parameters<span class="op">$</span>Pow))</a>
<a class="sourceLine" id="cb4-9" title="9">  }</a>
<a class="sourceLine" id="cb4-10" title="10">  pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>parameters,<span class="dt">regression=</span>F)</a>
<a class="sourceLine" id="cb4-11" title="11">  init.pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>init.parameters,<span class="dt">regression=</span>F)</a>
<a class="sourceLine" id="cb4-12" title="12">  reg.pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>parameters,<span class="dt">regression=</span>T)</a>
<a class="sourceLine" id="cb4-13" title="13">  vdist &lt;-<span class="st"> </span><span class="kw">calc_vdist</span>(<span class="dt">parameters=</span><span class="kw">c</span>(pcs,<span class="dt">Funbound.plasma=</span>parameters<span class="op">$</span>Funbound.plasma))</a>
<a class="sourceLine" id="cb4-14" title="14">  init.vdist &lt;-<span class="st"> </span><span class="kw">calc_vdist</span>(<span class="dt">parameters=</span><span class="kw">c</span>(init.pcs,<span class="dt">Funbound.plasma=</span>parameters<span class="op">$</span>unadjusted.Funbound.plasma))</a>
<a class="sourceLine" id="cb4-15" title="15">  reg.vdist &lt;-<span class="st"> </span><span class="kw">calc_vdist</span>(<span class="dt">parameters=</span><span class="kw">c</span>(reg.pcs,<span class="dt">Funbound.plasma=</span>parameters<span class="op">$</span>Funbound.plasma))</a>
<a class="sourceLine" id="cb4-16" title="16">  vd.table &lt;-<span class="st"> </span><span class="kw">rbind</span>(vd.table,<span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(this.cas),<span class="kw">as.data.frame</span>(<span class="kw">log10</span>(init.vdist)),</a>
<a class="sourceLine" id="cb4-17" title="17">                    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(vdist)),<span class="kw">as.data.frame</span>(<span class="kw">log10</span>(reg.vdist)),</a>
<a class="sourceLine" id="cb4-18" title="18">                    <span class="kw">as.data.frame</span>(<span class="kw">log10</span>(<span class="kw">subset</span>(obach,CAS<span class="op">==</span>this.cas)[[<span class="st">&#39;VDss (L/kg)&#39;</span>]]))))</a>
<a class="sourceLine" id="cb4-19" title="19">}</a>
<a class="sourceLine" id="cb4-20" title="20"><span class="kw">colnames</span>(vd.table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;CAS&#39;</span>,<span class="st">&#39;init.vdist&#39;</span>,<span class="st">&#39;adjusted.vdist&#39;</span>,<span class="st">&#39;calibrated.vdist&#39;</span>,<span class="st">&#39;Experimental&#39;</span>)</a>
<a class="sourceLine" id="cb4-21" title="21">init.error &lt;-<span class="st"> </span>vd.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>vd.table[,<span class="st">&#39;init.vdist&#39;</span>]</a>
<a class="sourceLine" id="cb4-22" title="22">adjustment.error &lt;-<span class="st"> </span>vd.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>vd.table[,<span class="st">&#39;adjusted.vdist&#39;</span>]</a>
<a class="sourceLine" id="cb4-23" title="23">calibration.error &lt;-<span class="st"> </span>vd.table[,<span class="st">&#39;Experimental&#39;</span>] <span class="op">-</span><span class="st"> </span>vd.table[,<span class="st">&#39;calibrated.vdist&#39;</span>]</a>
<a class="sourceLine" id="cb4-24" title="24">adjustment.improvement &lt;-<span class="st"> </span><span class="kw">abs</span>(init.error) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(adjustment.error)</a>
<a class="sourceLine" id="cb4-25" title="25">calibration.improvement &lt;-<span class="st"> </span><span class="kw">abs</span>(adjustment.error) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(calibration.error)</a>
<a class="sourceLine" id="cb4-26" title="26">vd.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(vd.table,adjustment.improvement,calibration.improvement,</a>
<a class="sourceLine" id="cb4-27" title="27">                  init.error,adjustment.error,calibration.error)</a>
<a class="sourceLine" id="cb4-28" title="28">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Experimental <span class="op">~</span><span class="st"> </span>calibrated.vdist,<span class="dt">data=</span>vd.table)</a>
<a class="sourceLine" id="cb4-29" title="29">smry &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)</a>
<a class="sourceLine" id="cb4-30" title="30">calibrated.reg &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[<span class="st">&#39;(Intercept)&#39;</span>]),</a>
<a class="sourceLine" id="cb4-31" title="31">                        <span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[<span class="st">&#39;calibrated.vdist&#39;</span>]),</a>
<a class="sourceLine" id="cb4-32" title="32">                        <span class="kw">as.data.frame</span>(smry<span class="op">$</span>coefficients[<span class="st">&#39;calibrated.vdist&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]),</a>
<a class="sourceLine" id="cb4-33" title="33">                        <span class="kw">as.data.frame</span>(smry<span class="op">$</span>sigma),<span class="kw">as.data.frame</span>(smry<span class="op">$</span>r.squared))</a>
<a class="sourceLine" id="cb4-34" title="34">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Experimental <span class="op">~</span><span class="st"> </span>init.vdist,<span class="dt">data=</span>vd.table)</a>
<a class="sourceLine" id="cb4-35" title="35">smry &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)</a>
<a class="sourceLine" id="cb4-36" title="36">init.reg &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[<span class="st">&#39;(Intercept)&#39;</span>]),</a>
<a class="sourceLine" id="cb4-37" title="37">                  <span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[<span class="st">&#39;init.vdist&#39;</span>]),</a>
<a class="sourceLine" id="cb4-38" title="38">                  <span class="kw">as.data.frame</span>(smry<span class="op">$</span>coefficients[<span class="st">&#39;init.vdist&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]),</a>
<a class="sourceLine" id="cb4-39" title="39">                  <span class="kw">as.data.frame</span>(smry<span class="op">$</span>sigma),<span class="kw">as.data.frame</span>(smry<span class="op">$</span>r.squared))</a>
<a class="sourceLine" id="cb4-40" title="40">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Experimental <span class="op">~</span><span class="st"> </span>adjusted.vdist,<span class="dt">data=</span>vd.table)</a>
<a class="sourceLine" id="cb4-41" title="41">smry &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)</a>
<a class="sourceLine" id="cb4-42" title="42">adjustment.reg &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[<span class="st">&#39;(Intercept)&#39;</span>]),</a>
<a class="sourceLine" id="cb4-43" title="43">                       <span class="kw">as.data.frame</span>(fit<span class="op">$</span>coefficients[<span class="st">&#39;adjusted.vdist&#39;</span>]),</a>
<a class="sourceLine" id="cb4-44" title="44">                       <span class="kw">as.data.frame</span>(smry<span class="op">$</span>coefficients[<span class="st">&#39;adjusted.vdist&#39;</span>,<span class="st">&#39;Pr(&gt;|t|)&#39;</span>]),</a>
<a class="sourceLine" id="cb4-45" title="45">                       <span class="kw">as.data.frame</span>(smry<span class="op">$</span>sigma),<span class="kw">as.data.frame</span>(smry<span class="op">$</span>r.squared))</a>
<a class="sourceLine" id="cb4-46" title="46"><span class="kw">colnames</span>(init.reg) &lt;-<span class="st"> </span><span class="kw">colnames</span>(adjustment.reg) &lt;-</a>
<a class="sourceLine" id="cb4-47" title="47"><span class="kw">colnames</span>(calibrated.reg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Intercept&#39;</span>,<span class="st">&#39;Slope&#39;</span>,<span class="st">&#39;P-value&#39;</span>,<span class="st">&#39;Std Err&#39;</span>,<span class="st">&#39;R-squared&#39;</span>)</a>
<a class="sourceLine" id="cb4-48" title="48"></a>
<a class="sourceLine" id="cb4-49" title="49">init.vd.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(vd.table,<span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(init.vdist),<span class="dv">10</span><span class="op">^</span>(Experimental))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-50" title="50"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> init.reg[[<span class="st">&#39;Intercept&#39;</span>]], <span class="dt">slope =</span> init.reg[[<span class="st">&quot;Slope&quot;</span>]]) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-51" title="51"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Predicted Volume of Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-52" title="52"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Measured Volume of Distribution&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb4-53" title="53">    <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-54" title="54"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="op">^</span>(<span class="fl">8.5</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-55" title="55"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="op">^</span>(<span class="fl">8.5</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-56" title="56"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&#39;(A)&#39;</span>)</a>
<a class="sourceLine" id="cb4-57" title="57"></a>
<a class="sourceLine" id="cb4-58" title="58">adjustment.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-59" title="59"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span>vd.table[<span class="kw">order</span>(vd.table[,<span class="st">&#39;adjustment.improvement&#39;</span>],<span class="dt">decreasing=</span>F),],</a>
<a class="sourceLine" id="cb4-60" title="60">    <span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(adjusted.vdist),<span class="dv">10</span><span class="op">^</span>(Experimental),<span class="dt">color=</span>adjustment.improvement)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-61" title="61"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> adjustment.reg[[<span class="st">&#39;Intercept&#39;</span>]],<span class="dt">slope =</span> adjustment.reg[[<span class="st">&quot;Slope&quot;</span>]]) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-62" title="62"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Predicted Volume of Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-63" title="63"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Measured Volume of Distribution&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb4-64" title="64">    <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),<span class="dt">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb4-65" title="65">    <span class="dt">legend.margin =</span> <span class="kw">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb4-66" title="66">    <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-67" title="67"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="op">^</span>(<span class="dv">3</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="op">^</span>(<span class="dv">3</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-68" title="68"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&#39;(B)&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_viridis</span>(<span class="dt">direction=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">option=</span><span class="st">&#39;inferno&#39;</span>)</a>
<a class="sourceLine" id="cb4-69" title="69"></a>
<a class="sourceLine" id="cb4-70" title="70">calibration.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-71" title="71"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span>vd.table[<span class="kw">order</span>(vd.table[,<span class="st">&#39;calibration.improvement&#39;</span>],<span class="dt">decreasing=</span>F),],</a>
<a class="sourceLine" id="cb4-72" title="72">    <span class="kw">aes</span>(<span class="dv">10</span><span class="op">^</span>(calibrated.vdist),<span class="dv">10</span><span class="op">^</span>(Experimental),<span class="dt">color=</span>calibration.improvement)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-73" title="73"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> calibrated.reg[[<span class="st">&#39;Intercept&#39;</span>]],<span class="dt">slope =</span> calibrated.reg[[<span class="st">&quot;Slope&quot;</span>]]) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-74" title="74"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Predicted Volume of Distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-75" title="75"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Measured Volume of Distribution&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb4-76" title="76">    <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>),<span class="dt">legend.box.just =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb4-77" title="77">    <span class="dt">legend.margin =</span> <span class="kw">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb4-78" title="78">    <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-79" title="79"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="op">^</span>(<span class="dv">3</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="fl">1.5</span>),<span class="dv">10</span><span class="op">^</span>(<span class="dv">3</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-80" title="80"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&#39;(C)&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_viridis</span>(<span class="dt">direction=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">option=</span><span class="st">&#39;inferno&#39;</span>)</a></code></pre></div>
<p>Now we pull in the in vivo blood to plasma ratios, use these to calculate the inferred red blood cell to plasma ratios, and then make predictions for these values. A censored regressions is performed, and predictions are plotted against errors.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">rb2p.data &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,<span class="op">!</span><span class="kw">is.na</span>(Human.Rblood2plasma))</a>
<a class="sourceLine" id="cb5-2" title="2">measured.rb2p &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-3" title="3">measured.krbc &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-4" title="4">predicted.rb2p &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-5" title="5">predicted.krbc &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-6" title="6">cas &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-7" title="7">charge &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-8" title="8">fup &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-9" title="9">logP &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-10" title="10">pka_donor &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-11" title="11">pka_accept &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="cf">for</span>(this.cas <span class="cf">in</span> rb2p.data[rb2p.data[,<span class="st">&#39;CAS&#39;</span>] <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&#39;schmitt&#39;</span>),<span class="st">&#39;CAS&#39;</span>]){</a>
<a class="sourceLine" id="cb5-13" title="13">  rb2p &lt;-<span class="st"> </span><span class="kw">get_rblood2plasma</span>(<span class="dt">chem.cas=</span>this.cas)</a>
<a class="sourceLine" id="cb5-14" title="14">  krbc &lt;-<span class="st"> </span>(rb2p <span class="op">+</span><span class="st"> </span><span class="fl">.44</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.44</span></a>
<a class="sourceLine" id="cb5-15" title="15">  measured.rb2p &lt;-<span class="st"> </span><span class="kw">c</span>(measured.rb2p,rb2p)</a>
<a class="sourceLine" id="cb5-16" title="16">  measured.krbc &lt;-<span class="st"> </span><span class="kw">c</span>(measured.krbc,krbc)</a>
<a class="sourceLine" id="cb5-17" title="17">  parameters &lt;-<span class="st"> </span><span class="kw">parameterize_schmitt</span>(<span class="dt">chem.cas=</span>this.cas)</a>
<a class="sourceLine" id="cb5-18" title="18">  pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>parameters)</a>
<a class="sourceLine" id="cb5-19" title="19">  predicted.krbc &lt;-<span class="st"> </span><span class="kw">c</span>(predicted.krbc,pcs[[<span class="st">&#39;Krbc2pu&#39;</span>]] <span class="op">*</span><span class="st"> </span>parameters<span class="op">$</span>Funbound.plasma)</a>
<a class="sourceLine" id="cb5-20" title="20">  cas &lt;-<span class="st"> </span><span class="kw">c</span>(cas,this.cas)</a>
<a class="sourceLine" id="cb5-21" title="21">  charge &lt;-<span class="st"> </span><span class="kw">c</span>(charge,<span class="kw">calc_ionization</span>(<span class="dt">chem.cas=</span>this.cas,<span class="dt">pH=</span><span class="fl">7.4</span>)<span class="op">$</span>fraction_charged)</a>
<a class="sourceLine" id="cb5-22" title="22">  fup &lt;-<span class="st"> </span><span class="kw">c</span>(fup,parameters<span class="op">$</span>unadjusted.Funbound.plasma)</a>
<a class="sourceLine" id="cb5-23" title="23">  logP &lt;-<span class="st">  </span><span class="kw">c</span>(logP,<span class="kw">log10</span>(parameters<span class="op">$</span>Pow))</a>
<a class="sourceLine" id="cb5-24" title="24">  pka_donor &lt;-<span class="st"> </span><span class="kw">c</span>(pka_donor,<span class="kw">paste</span>(parameters<span class="op">$</span>pKa_Donor,<span class="dt">collapse=</span><span class="st">&#39;,&#39;</span>))</a>
<a class="sourceLine" id="cb5-25" title="25">  pka_accept &lt;-<span class="st"> </span><span class="kw">c</span>(pka_accept,<span class="kw">paste</span>(parameters<span class="op">$</span>pKa_Accept,<span class="dt">collapse=</span><span class="st">&#39;,&#39;</span>))</a>
<a class="sourceLine" id="cb5-26" title="26">}</a>
<a class="sourceLine" id="cb5-27" title="27">predicted.rb2p &lt;-<span class="st">  </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.44</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.44</span> <span class="op">*</span><span class="st"> </span>predicted.krbc</a>
<a class="sourceLine" id="cb5-28" title="28">rb2p.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(cas),<span class="kw">as.data.frame</span>(predicted.rb2p),<span class="kw">as.data.frame</span>(measured.rb2p))</a>
<a class="sourceLine" id="cb5-29" title="29"><span class="kw">colnames</span>(rb2p.table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;cas&#39;</span>,<span class="st">&#39;predicted.rb2p&#39;</span>,<span class="st">&#39;measured.rb2p&#39;</span>)</a>
<a class="sourceLine" id="cb5-30" title="30">error &lt;-<span class="st"> </span><span class="kw">log10</span>(rb2p.table[,<span class="st">&#39;measured.rb2p&#39;</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">log10</span>(rb2p.table[,<span class="st">&#39;predicted.rb2p&#39;</span>])</a>
<a class="sourceLine" id="cb5-31" title="31">rb2p.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(rb2p.table,error,charge,fup,logP)</a>
<a class="sourceLine" id="cb5-32" title="32"></a>
<a class="sourceLine" id="cb5-33" title="33">error &lt;-<span class="st"> </span><span class="kw">log10</span>(measured.krbc) <span class="op">-</span><span class="st">  </span><span class="kw">log10</span>(predicted.krbc)</a>
<a class="sourceLine" id="cb5-34" title="34">krbc.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(cas),<span class="kw">as.data.frame</span>(predicted.krbc),<span class="kw">as.data.frame</span>(measured.krbc),</a>
<a class="sourceLine" id="cb5-35" title="35">                    <span class="kw">as.data.frame</span>(error),charge,fup,logP,pka_donor,pka_accept)</a>
<a class="sourceLine" id="cb5-36" title="36"></a>
<a class="sourceLine" id="cb5-37" title="37">pdta &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> predicted.krbc,</a>
<a class="sourceLine" id="cb5-38" title="38">                   <span class="dt">y =</span> measured.krbc)</a>
<a class="sourceLine" id="cb5-39" title="39">pdta<span class="op">$</span>y[pdta<span class="op">$</span>y <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.1</span>] &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb5-40" title="40">pdta<span class="op">$</span>Censoring &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Not Censored&quot;</span>,<span class="st">&quot;Censored&quot;</span>)[<span class="kw">as.numeric</span>(pdta<span class="op">$</span>y <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb5-41" title="41">y &lt;-<span class="st"> </span>measured.krbc</a>
<a class="sourceLine" id="cb5-42" title="42">x &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(y)),<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">log10</span>(predicted.krbc))</a>
<a class="sourceLine" id="cb5-43" title="43"><span class="kw">colnames</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Predicted&quot;</span>)</a>
<a class="sourceLine" id="cb5-44" title="44">cc &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb5-45" title="45">y[y <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>] &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb5-46" title="46">y &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log10</span>(y)</a>
<a class="sourceLine" id="cb5-47" title="47"></a>
<a class="sourceLine" id="cb5-48" title="48">out &lt;-<span class="st"> </span><span class="kw">em.cens</span>(cc, x, y, <span class="dt">dist=</span><span class="st">&quot;Normal&quot;</span>)</a>
<a class="sourceLine" id="cb5-49" title="49"></a>
<a class="sourceLine" id="cb5-50" title="50">censored.regression &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-51" title="51"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data=</span>pdta,<span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y, <span class="dt">color=</span>Censoring)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-52" title="52"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(.<span class="dv">0009</span>,<span class="dv">40</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>(<span class="dt">limits=</span><span class="kw">c</span>(.<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">breaks=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,<span class="fl">2.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-53" title="53"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Inferred &quot;</span>,K[p])),<span class="dt">x=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Predicted &quot;</span>,K[p]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-54" title="54"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">intercept=</span><span class="dv">0</span>, <span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="st">&#39;dashed&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-55" title="55"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb5-56" title="56">    <span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust=</span><span class="fl">0.5</span>),<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.11</span>, <span class="fl">.8</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-57" title="57"><span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span>out<span class="op">$</span>betas[<span class="dv">2</span>],<span class="dt">intercept=</span><span class="op">-</span>out<span class="op">$</span>betas[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;(B)&#39;</span>)</a>
<a class="sourceLine" id="cb5-58" title="58"></a>
<a class="sourceLine" id="cb5-59" title="59">rb2p.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rb2p.table,<span class="kw">aes</span>(predicted.rb2p,measured.rb2p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-60" title="60"><span class="st">    </span><span class="kw">geom_point</span>()  <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_log10</span>(<span class="dt">lim=</span><span class="kw">c</span>(.<span class="dv">52</span>,<span class="dv">18</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-61" title="61"><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="dt">lim=</span><span class="kw">c</span>(.<span class="dv">52</span>,<span class="fl">2.5</span>),<span class="dt">breaks=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">linetype=</span><span class="st">&#39;dashed&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-62" title="62"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Measured B:P Ratio &quot;</span>,</a>
<a class="sourceLine" id="cb5-63" title="63">    <span class="dt">x=</span><span class="st">&quot;Predicted B:P Ratio&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-64" title="64"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb5-65" title="65">    <span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>,<span class="dt">hjust=</span><span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&#39;(A)&#39;</span>)</a></code></pre></div>
<p>Lastly, we make the heatmap.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">heatmap.table &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="cf">for</span>(this.cas <span class="cf">in</span> <span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&#39;schmitt&#39;</span>)){</a>
<a class="sourceLine" id="cb6-3" title="3">    parms &lt;-<span class="st"> </span><span class="kw">parameterize_schmitt</span>(<span class="dt">chem.cas=</span>this.cas)</a>
<a class="sourceLine" id="cb6-4" title="4">    pcs &lt;-<span class="st"> </span><span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>parms)</a>
<a class="sourceLine" id="cb6-5" title="5">    heatmap.table &lt;-<span class="st"> </span><span class="kw">cbind</span>(heatmap.table,<span class="kw">log10</span>(<span class="kw">unlist</span>(pcs)[<span class="dv">1</span><span class="op">:</span><span class="dv">11</span>]<span class="op">*</span>parms<span class="op">$</span>Funbound.plasma))</a>
<a class="sourceLine" id="cb6-6" title="6">}</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">rownames</span>(heatmap.table) &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&#39;Adipose&#39;</span>,<span class="st">&#39;Bone&#39;</span>,<span class="st">&#39;Brain&#39;</span>,<span class="st">&#39;Gut&#39;</span>,<span class="st">&#39;Heart&#39;</span>,</a>
<a class="sourceLine" id="cb6-8" title="8">                              <span class="st">&#39;Kidney&#39;</span>,<span class="st">&#39;Liver&#39;</span>,<span class="st">&#39;Lung&#39;</span>,<span class="st">&#39;Muscle&#39;</span>,<span class="st">&#39;Skin&#39;</span>,<span class="st">&#39;Spleen&#39;</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">colnames</span>(heatmap.table) &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;&quot;</span>,<span class="kw">dim</span>(heatmap.table)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb6-10" title="10"></a>
<a class="sourceLine" id="cb6-11" title="11">pal &lt;-<span class="st"> </span><span class="cf">function</span> (n, <span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">260</span>, <span class="dv">-328</span>), <span class="dt">c =</span> <span class="dv">80</span>, <span class="dt">l =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">100</span>), <span class="dt">power =</span> <span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="dt">fixup =</span> <span class="ot">TRUE</span>, <span class="dt">gamma =</span> <span class="ot">NULL</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, ...)</a>
<a class="sourceLine" id="cb6-13" title="13">{</a>
<a class="sourceLine" id="cb6-14" title="14">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(gamma))</a>
<a class="sourceLine" id="cb6-15" title="15">        <span class="kw">warning</span>(<span class="st">&quot;&#39;gamma&#39; is deprecated and has no effect&quot;</span>)</a>
<a class="sourceLine" id="cb6-16" title="16">    <span class="cf">if</span> (n <span class="op">&lt;</span><span class="st"> </span>1L)</a>
<a class="sourceLine" id="cb6-17" title="17">        <span class="kw">return</span>(<span class="kw">character</span>(0L))</a>
<a class="sourceLine" id="cb6-18" title="18">   h &lt;-<span class="st"> </span><span class="kw">rep</span>(h, <span class="dt">length.out =</span> 2L)</a>
<a class="sourceLine" id="cb6-19" title="19">    c &lt;-<span class="st"> </span>c[1L]</a>
<a class="sourceLine" id="cb6-20" title="20">    l &lt;-<span class="st"> </span><span class="kw">rep</span>(l, <span class="dt">length.out =</span> 2L)</a>
<a class="sourceLine" id="cb6-21" title="21">    power &lt;-<span class="st"> </span><span class="kw">rep</span>(power, <span class="dt">length.out =</span> 2L)</a>
<a class="sourceLine" id="cb6-22" title="22">    rval &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dt">length =</span> n)</a>
<a class="sourceLine" id="cb6-23" title="23">    rval &lt;-<span class="st"> </span><span class="kw">hex</span>(<span class="kw">polarLUV</span>(<span class="dt">L =</span> l[2L] <span class="op">-</span><span class="st"> </span><span class="kw">diff</span>(l) <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(rval)<span class="op">^</span>power[2L],</a>
<a class="sourceLine" id="cb6-24" title="24">        <span class="dt">C =</span> c <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(rval)<span class="op">^</span>power[1L], <span class="dt">H =</span> <span class="kw">ifelse</span>(rval <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, h[1L],</a>
<a class="sourceLine" id="cb6-25" title="25">            h[2L])), <span class="dt">fixup =</span> fixup, ...)</a>
<a class="sourceLine" id="cb6-26" title="26">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">missing</span>(alpha)) {</a>
<a class="sourceLine" id="cb6-27" title="27">        alpha &lt;-<span class="st"> </span><span class="kw">pmax</span>(<span class="kw">pmin</span>(alpha, <span class="dv">1</span>), <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb6-28" title="28">        alpha &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">as.hexmode</span>(<span class="kw">round</span>(alpha <span class="op">*</span><span class="st"> </span><span class="dv">255</span> <span class="op">+</span><span class="st"> </span><span class="fl">1e-04</span>)),</a>
<a class="sourceLine" id="cb6-29" title="29">            <span class="dt">width =</span> 2L, <span class="dt">upper.case =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-30" title="30">        rval &lt;-<span class="st"> </span><span class="kw">paste</span>(rval, alpha, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb6-31" title="31">    }</a>
<a class="sourceLine" id="cb6-32" title="32">    <span class="kw">return</span>(rval)</a>
<a class="sourceLine" id="cb6-33" title="33">}</a>
<a class="sourceLine" id="cb6-34" title="34"></a>
<a class="sourceLine" id="cb6-35" title="35">hclust.ave &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">hclust</span>(x, <span class="dt">method=</span><span class="st">&quot;ward.D2&quot;</span>)</a>
<a class="sourceLine" id="cb6-36" title="36"><span class="kw">par</span>(<span class="dt">cex.main=</span><span class="fl">1.5</span>,<span class="dt">cex.lab=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-37" title="37">lhei &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb6-38" title="38">lwid &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.25</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-39" title="39">lmat &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-40" title="40"><span class="kw">heatmap.2</span>(heatmap.table,<span class="dt">dendrogram=</span><span class="st">&#39;column&#39;</span>,<span class="dt">col=</span>pal,<span class="dt">trace=</span><span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb6-41" title="41">          <span class="dt">hclustfun=</span>hclust.ave,<span class="dt">key.xlab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(log[<span class="dv">10</span>],K[p],<span class="st">&quot; Value&quot;</span>)),</a>
<a class="sourceLine" id="cb6-42" title="42">          <span class="dt">key.ylab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Number of &quot;</span>,K[p])),</a>
<a class="sourceLine" id="cb6-43" title="43">          <span class="dt">key.title=</span><span class="st">&quot;Partition Coefficients&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Chemicals&quot;</span>,<span class="dt">cex.lab=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-44" title="44">          <span class="dt">lmat=</span>lmat,<span class="dt">margins=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),<span class="dt">lwid=</span>lwid,<span class="dt">lhei=</span>lhei)</a></code></pre></div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
