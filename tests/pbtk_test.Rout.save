
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> #R CMD BATCH other_tests.R other_tests.Rout
> library(httk)

Attaching package: 'httk'

The following object is masked _by_ '.GlobalEnv':

    chem.physical_and_invitro.data

> calc_analytic_css(chem.name="bisphenol a",model="pbtk")
Plasma concentration returned in uM units.
[1] 1.173914
There were 32 warnings (use warnings() to see them)
> calc_analytic_css(chem.cas="80-05-7",model="pbtk")
Plasma concentration returned in uM units.
[1] 1.173914
There were 32 warnings (use warnings() to see them)
> calc_analytic_css(parameters=parameterize_pbtk(chem.cas="80-05-7"),model="pbtk")
Plasma concentration returned in uM units.
[1] 1.173914
There were 32 warnings (use warnings() to see them)
> calc_analytic_css(chem.name="bisphenol a",model="pbtk",tissue="liver")
Tissue concentration for liver returned in uM units.
[1] 21.99815
There were 50 or more warnings (use warnings() to see the first 50)
> calc_analytic_css(chem.name="bisphenol a",model="pbtk",tissue="brain")
Tissue concentration for brain returned in uM units.
[1] 6.769065
There were 50 or more warnings (use warnings() to see the first 50)
> 
> head(solve_pbtk(chem.name="bisphenol a"))
Human values returned in uM units.
AUC is area under plasma concentration curve in uM * days units with Rblood2plasma = 0.79 .
           time Agutlumen      Cart      Cven    Clung     Cgut   Cliver
[1,] 0.00000000 306.62619 0.0000000 0.0000000 0.000000  0.00000  0.00000
[2,] 0.01041667 177.79465 0.2524046 0.2893574 2.349612 71.95248 23.88888
[3,] 0.02083333 103.09280 0.6635468 0.6924439 5.953619 72.94086 49.30121
[4,] 0.03125000  59.77750 0.9106869 0.9235951 8.082038 59.24553 59.22915
[5,] 0.04166667  34.66149 0.9943698 0.9962908 8.783927 45.57617 58.15645
[6,] 0.05208333  20.09818 0.9815249 0.9779566 8.652082 34.88430 51.90785
       Ckidney      Crest Ametabolized    Atubules   Cplasma         AUC
[1,]  0.000000 0.00000000     0.000000 0.000000000 0.0000000 0.000000000
[2,]  3.172391 0.06633834     1.103540 0.001965999 0.3662752 0.001415222
[3,] 12.533955 0.41370538     5.477242 0.019805484 0.8765113 0.008020654
[4,] 20.035116 0.97336122    11.891203 0.058155028 1.1691077 0.018881627
[5,] 23.479160 1.58728598    18.754595 0.109072218 1.2611276 0.031675711
[6,] 23.992863 2.15118704    25.147879 0.164256077 1.2379198 0.044758176
There were 32 warnings (use warnings() to see them)
> head(solve_pbtk(chem.cas="80-05-7"))
Human values returned in uM units.
AUC is area under plasma concentration curve in uM * days units with Rblood2plasma = 0.79 .
           time Agutlumen      Cart      Cven    Clung     Cgut   Cliver
[1,] 0.00000000 306.62619 0.0000000 0.0000000 0.000000  0.00000  0.00000
[2,] 0.01041667 177.79465 0.2524046 0.2893574 2.349612 71.95248 23.88888
[3,] 0.02083333 103.09280 0.6635468 0.6924439 5.953619 72.94086 49.30121
[4,] 0.03125000  59.77750 0.9106869 0.9235951 8.082038 59.24553 59.22915
[5,] 0.04166667  34.66149 0.9943698 0.9962908 8.783927 45.57617 58.15645
[6,] 0.05208333  20.09818 0.9815249 0.9779566 8.652082 34.88430 51.90785
       Ckidney      Crest Ametabolized    Atubules   Cplasma         AUC
[1,]  0.000000 0.00000000     0.000000 0.000000000 0.0000000 0.000000000
[2,]  3.172391 0.06633834     1.103540 0.001965999 0.3662752 0.001415222
[3,] 12.533955 0.41370538     5.477242 0.019805484 0.8765113 0.008020654
[4,] 20.035116 0.97336122    11.891203 0.058155028 1.1691077 0.018881627
[5,] 23.479160 1.58728598    18.754595 0.109072218 1.2611276 0.031675711
[6,] 23.992863 2.15118704    25.147879 0.164256077 1.2379198 0.044758176
There were 32 warnings (use warnings() to see them)
> head(solve_pbtk(parameters=parameterize_pbtk(chem.cas="80-05-7")))
Values returned in uM units.
AUC is area under plasma concentration curve in uM * days units with Rblood2plasma = 0.79 .
           time Agutlumen      Cart      Cven    Clung     Cgut   Cliver
[1,] 0.00000000 306.62619 0.0000000 0.0000000 0.000000  0.00000  0.00000
[2,] 0.01041667 177.79465 0.2524046 0.2893574 2.349612 71.95248 23.88888
[3,] 0.02083333 103.09280 0.6635468 0.6924439 5.953619 72.94086 49.30121
[4,] 0.03125000  59.77750 0.9106869 0.9235951 8.082038 59.24553 59.22915
[5,] 0.04166667  34.66149 0.9943698 0.9962908 8.783927 45.57617 58.15645
[6,] 0.05208333  20.09818 0.9815249 0.9779566 8.652082 34.88430 51.90785
       Ckidney      Crest Ametabolized    Atubules   Cplasma         AUC
[1,]  0.000000 0.00000000     0.000000 0.000000000 0.0000000 0.000000000
[2,]  3.172391 0.06633834     1.103540 0.001965999 0.3662752 0.001415222
[3,] 12.533955 0.41370538     5.477242 0.019805484 0.8765113 0.008020654
[4,] 20.035116 0.97336122    11.891203 0.058155028 1.1691077 0.018881627
[5,] 23.479160 1.58728598    18.754595 0.109072218 1.2611276 0.031675711
[6,] 23.992863 2.15118704    25.147879 0.164256077 1.2379198 0.044758176
There were 34 warnings (use warnings() to see them)
> 
> script.args <- commandArgs(TRUE)
> if (length(script.args) > 0) 
+ {
+   if (any(script.args=="mctest"))
+   {
+     set.seed(12345)
+     calc_mc_css(chem.name="bisphenol a",model="pbtk")
+     set.seed(12345)
+     calc_mc_css(chem.cas="80-05-7",model="pbtk")
+     set.seed(12345)
+     calc_mc_css(parameters=parameterize_pbtk(chem.cas="80-05-7"),model="pbtk")
+   }
+   if (any(script.args=="wetmoretest"))
+   {
+     wetmore.chems <- subset(chem.physical_and_invitro.data,
+       regexpr("Wetmore",Human.Clint.Reference)!=-1 &
+       regexpr("Wetmore",Human.Funbound.plasma.Reference)!=-1)
+     Css.table <- data.frame()
+     for (this.cas in sort(get_lit_cheminfo()))
+       if (this.cas %in% get_cheminfo(model="pbtk") &
+         this.cas %in% wetmore.chems$CAS)
+       {
+         Css.table[this.cas,"Css.lit"] <- get_lit_css(chem.cas=this.cas,
+           output.units="uM",
+           which.quantile=0.5)
+         Css.table[this.cas,"Css.calc"] <- calc_analytic_css(chem.cas=this.cas,
+           model="pbtk")
+       }                                                                          
+     cat(lm(log(Css.lit)~log(Css.calc),data=Css.table)$coefficients)
+     
+     library(ggplot2)
+     test.fig <- ggplot(Css.table,aes(x=Css.calc,y=Css.lit)) +
+              geom_point(size=3)+
+        scale_y_log10()+
+        scale_x_log10()+
+       ylab(expression(paste(C[ss]," Literature (uM)"))) +
+       xlab(expression(paste(C[ss]," pbtk model (uM)"))) +
+       geom_abline(intercept = 0, slope = 1,linetype="dashed", colour="Blue") 
+     
+     dev.new()
+     print(test.fig)
+   }
+ }
> 
> proc.time()
   user  system elapsed 
   2.79    0.48    3.25 
