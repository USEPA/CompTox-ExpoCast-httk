
R version 3.6.2 (2019-12-12) -- "Dark and Stormy Night"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #R CMD BATCH --no-timing --no-restore --no-save pbtk_test.R pbtk_test.Rout
> library(httk)
> options(warn=-1)
> 
> calc_analytic_css(chem.name="bisphenol a",model="pbtk")
Plasma concentration returned in uM units.
[1] 1.173
> calc_analytic_css(chem.cas="80-05-7",model="pbtk")
Plasma concentration returned in uM units.
[1] 1.173
> calc_analytic_css(parameters=parameterize_pbtk(chem.cas="80-05-7"),model="pbtk")
Plasma concentration returned in uM units.
[1] 1.173
> calc_analytic_css(chem.name="bisphenol a",model="pbtk",tissue="liver")
Tissue concentration for liver returned in uM units.
[1] 21.96
> calc_analytic_css(chem.name="bisphenol a",model="pbtk",tissue="brain")
Tissue concentration for brain returned in uM units.
[1] 6.759
> 
> head(solve_pbtk(chem.name="bisphenol a"))
Human amounts returned in umol and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
          time Agutlumen      Cgut      Cliver        Cven       Clung
[1,] 0.0000000  306.6260  0.000000 0.00000e+00 0.00000e+00 0.00000e+00
[2,] 0.0000100  306.4660  0.144945 4.42042e-05 4.96403e-09 1.97287e-10
[3,] 0.0104167  177.7950 71.936600 2.38949e+01 2.89568e-01 2.35010e+00
[4,] 0.0208333  103.0930 72.914000 4.93024e+01 6.92810e-01 5.95347e+00
[5,] 0.0312500   59.7775 59.218100 5.92191e+01 9.23926e-01 8.08037e+00
[6,] 0.0416667   34.6615 45.552300 5.81369e+01 9.96516e-01 8.78089e+00
            Cart       Crest     Ckidney     Cplasma    Atubules Ametabolized
[1,] 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00  0.00000e+00
[2,] 1.37672e-13 2.08623e-17 1.64718e-15 6.28358e-09 6.28721e-22  1.63907e-09
[3,] 2.52605e-01 6.63954e-02 3.17444e+00 3.66541e-01 1.96703e-03  1.10571e+00
[4,] 6.63918e-01 4.13976e-01 1.25377e+01 8.76974e-01 1.98101e-02  5.48716e+00
[5,] 9.11031e-01 9.73845e-01 2.00360e+01 1.16953e+00 5.81571e-02  1.19112e+01
[6,] 9.94605e-01 1.58787e+00 2.34758e+01 1.26141e+00 1.09060e-01  1.87842e+01
             AUC
[1,] 0.00000e+00
[2,] 1.57314e-14
[3,] 1.41633e-03
[4,] 8.02580e-03
[5,] 1.88915e-02
[6,] 3.16893e-02
> head(solve_pbtk(chem.cas="80-05-7"))
Human amounts returned in umol and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
          time Agutlumen      Cgut      Cliver        Cven       Clung
[1,] 0.0000000  306.6260  0.000000 0.00000e+00 0.00000e+00 0.00000e+00
[2,] 0.0000100  306.4660  0.144945 4.42042e-05 4.96403e-09 1.97287e-10
[3,] 0.0104167  177.7950 71.936600 2.38949e+01 2.89568e-01 2.35010e+00
[4,] 0.0208333  103.0930 72.914000 4.93024e+01 6.92810e-01 5.95347e+00
[5,] 0.0312500   59.7775 59.218100 5.92191e+01 9.23926e-01 8.08037e+00
[6,] 0.0416667   34.6615 45.552300 5.81369e+01 9.96516e-01 8.78089e+00
            Cart       Crest     Ckidney     Cplasma    Atubules Ametabolized
[1,] 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00  0.00000e+00
[2,] 1.37672e-13 2.08623e-17 1.64718e-15 6.28358e-09 6.28721e-22  1.63907e-09
[3,] 2.52605e-01 6.63954e-02 3.17444e+00 3.66541e-01 1.96703e-03  1.10571e+00
[4,] 6.63918e-01 4.13976e-01 1.25377e+01 8.76974e-01 1.98101e-02  5.48716e+00
[5,] 9.11031e-01 9.73845e-01 2.00360e+01 1.16953e+00 5.81571e-02  1.19112e+01
[6,] 9.94605e-01 1.58787e+00 2.34758e+01 1.26141e+00 1.09060e-01  1.87842e+01
             AUC
[1,] 0.00000e+00
[2,] 1.57314e-14
[3,] 1.41633e-03
[4,] 8.02580e-03
[5,] 1.88915e-02
[6,] 3.16893e-02
> head(solve_pbtk(parameters=parameterize_pbtk(chem.cas="80-05-7")))
Amounts returned in umol  and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
          time Agutlumen      Cgut      Cliver        Cven       Clung
[1,] 0.0000000  306.6260  0.000000 0.00000e+00 0.00000e+00 0.00000e+00
[2,] 0.0000100  306.4660  0.144945 4.42042e-05 4.96403e-09 1.97287e-10
[3,] 0.0104167  177.7950 71.936600 2.38949e+01 2.89568e-01 2.35010e+00
[4,] 0.0208333  103.0930 72.914000 4.93024e+01 6.92810e-01 5.95347e+00
[5,] 0.0312500   59.7775 59.218100 5.92191e+01 9.23926e-01 8.08037e+00
[6,] 0.0416667   34.6615 45.552300 5.81369e+01 9.96516e-01 8.78089e+00
            Cart       Crest     Ckidney     Cplasma    Atubules Ametabolized
[1,] 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00  0.00000e+00
[2,] 1.37672e-13 2.08623e-17 1.64718e-15 6.28358e-09 6.28721e-22  1.63907e-09
[3,] 2.52605e-01 6.63954e-02 3.17444e+00 3.66541e-01 1.96703e-03  1.10571e+00
[4,] 6.63918e-01 4.13976e-01 1.25377e+01 8.76974e-01 1.98101e-02  5.48716e+00
[5,] 9.11031e-01 9.73845e-01 2.00360e+01 1.16953e+00 5.81571e-02  1.19112e+01
[6,] 9.94605e-01 1.58787e+00 2.34758e+01 1.26141e+00 1.09060e-01  1.87842e+01
             AUC
[1,] 0.00000e+00
[2,] 1.57314e-14
[3,] 1.41633e-03
[4,] 8.02580e-03
[5,] 1.88915e-02
[6,] 3.16893e-02
> 
> script.args <- commandArgs(TRUE)
> if (length(script.args) > 0) 
+ {
+   if (any(script.args=="mctest"))
+   {
+     set.seed(12345)
+     calc_mc_css(chem.name="bisphenol a",model="pbtk")
+     set.seed(12345)
+     calc_mc_css(chem.cas="80-05-7",model="pbtk")
+     set.seed(12345)
+     calc_mc_css(parameters=parameterize_pbtk(chem.cas="80-05-7"),model="pbtk")
+   }
+   if (any(script.args=="wetmoretest"))
+   {
+     wetmore.chems <- subset(chem.physical_and_invitro.data,
+       regexpr("Wetmore",Human.Clint.Reference)!=-1 &
+       regexpr("Wetmore",Human.Funbound.plasma.Reference)!=-1)
+     Css.table <- data.frame()
+     for (this.cas in sort(get_lit_cheminfo()))
+       if (this.cas %in% get_cheminfo(model="pbtk") &
+         this.cas %in% wetmore.chems$CAS)
+       {
+         Css.table[this.cas,"Css.lit"] <- get_lit_css(chem.cas=this.cas,
+           output.units="uM",
+           which.quantile=0.5)
+         Css.table[this.cas,"Css.calc"] <- calc_analytic_css(chem.cas=this.cas,
+           model="pbtk")
+       }                                                                          
+     cat(lm(log(Css.lit)~log(Css.calc),data=Css.table)$coefficients)
+     
+     library(ggplot2)
+     test.fig <- ggplot(Css.table,aes(x=Css.calc,y=Css.lit)) +
+              geom_point(size=3)+
+        scale_y_log10()+
+        scale_x_log10()+
+       ylab(expression(paste(C[ss]," Literature (uM)"))) +
+       xlab(expression(paste(C[ss]," pbtk model (uM)"))) +
+       geom_abline(intercept = 0, slope = 1,linetype="dashed", colour="Blue") 
+     
+     dev.new()
+     print(test.fig)
+   }
+ }
> 
> quit("no")
