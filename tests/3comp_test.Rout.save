
R version 3.6.2 (2019-12-12) -- "Dark and Stormy Night"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #R CMD BATCH --no-timing --no-restore --no-save 3comp_test.R 3comp_test.Rout
> library(httk)
> options(warn=-1)
> 
> calc_analytic_css(chem.name="bisphenol a",model="3compartment")
Plasma concentration returned in uM units.
[1] 1.488
> calc_analytic_css(chem.cas="80-05-7",model="3compartment")
Plasma concentration returned in uM units.
[1] 1.488
> calc_analytic_css(parameters=parameterize_3comp(chem.cas="80-05-7"),model="3compartment")
Plasma concentration returned in uM units.
[1] 1.488
> calc_analytic_css(chem.name="bisphenol a",model="3compartment",tissue="liver")
Tissue concentration for liver returned in uM units.
[1] 27.06
> calc_analytic_css(chem.name="bisphenol a",model="3compartment",tissue="brain")
Tissue concentration for brain returned in uM units.
[1] 8.577
> 
> head(solve_3comp(chem.name="bisphenol a"))
Human amounts returned in umol and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
          time Aintestine      Cliver    Csyscomp    Atubules Ametabolized
[1,] 0.0000000   306.6260  0.00000000 0.00000e+00 0.00000e+00  0.00000e+00
[2,] 0.0000100   306.4660  0.00199531 3.18209e-08 1.89468e-13  7.42518e-08
[3,] 0.0104167   177.7950 35.57290000 1.13526e+00 1.09491e-02  2.82883e+00
[4,] 0.0208333   103.0930 32.21510000 2.53238e+00 5.72345e-02  6.84929e+00
[5,] 0.0312500    59.7775 26.19990000 3.44891e+00 1.32211e-01  1.02198e+01
[6,] 0.0416667    34.6615 22.02570000 3.98591e+00 2.24847e-01  1.29949e+01
             AUC     Cplasma
[1,] 0.00000e+00 0.00000e+00
[2,] 7.97330e-14 3.18209e-08
[3,] 4.60763e-03 1.13526e+00
[4,] 2.40857e-02 2.53238e+00
[5,] 5.56377e-02 3.44891e+00
[6,] 9.46211e-02 3.98591e+00
> head(solve_3comp(chem.cas="80-05-7"))
Human amounts returned in umol and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
          time Aintestine      Cliver    Csyscomp    Atubules Ametabolized
[1,] 0.0000000   306.6260  0.00000000 0.00000e+00 0.00000e+00  0.00000e+00
[2,] 0.0000100   306.4660  0.00199531 3.18209e-08 1.89468e-13  7.42518e-08
[3,] 0.0104167   177.7950 35.57290000 1.13526e+00 1.09491e-02  2.82883e+00
[4,] 0.0208333   103.0930 32.21510000 2.53238e+00 5.72345e-02  6.84929e+00
[5,] 0.0312500    59.7775 26.19990000 3.44891e+00 1.32211e-01  1.02198e+01
[6,] 0.0416667    34.6615 22.02570000 3.98591e+00 2.24847e-01  1.29949e+01
             AUC     Cplasma
[1,] 0.00000e+00 0.00000e+00
[2,] 7.97330e-14 3.18209e-08
[3,] 4.60763e-03 1.13526e+00
[4,] 2.40857e-02 2.53238e+00
[5,] 5.56377e-02 3.44891e+00
[6,] 9.46211e-02 3.98591e+00
> head(solve_3comp(parameters=parameterize_3comp(chem.cas="80-05-7")))
Amounts returned in umol  and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
          time Aintestine      Cliver    Csyscomp    Atubules Ametabolized
[1,] 0.0000000   306.6260  0.00000000 0.00000e+00 0.00000e+00  0.00000e+00
[2,] 0.0000100   306.4660  0.00199531 3.18209e-08 1.89468e-13  7.42518e-08
[3,] 0.0104167   177.7950 35.57290000 1.13526e+00 1.09491e-02  2.82883e+00
[4,] 0.0208333   103.0930 32.21510000 2.53238e+00 5.72345e-02  6.84929e+00
[5,] 0.0312500    59.7775 26.19990000 3.44891e+00 1.32211e-01  1.02198e+01
[6,] 0.0416667    34.6615 22.02570000 3.98591e+00 2.24847e-01  1.29949e+01
             AUC     Cplasma
[1,] 0.00000e+00 0.00000e+00
[2,] 7.97330e-14 3.18209e-08
[3,] 4.60763e-03 1.13526e+00
[4,] 2.40857e-02 2.53238e+00
[5,] 5.56377e-02 3.44891e+00
[6,] 9.46211e-02 3.98591e+00
> 
> script.args <- commandArgs(TRUE)
> if (length(script.args) > 0) 
+ {
+   if (any(script.args=="mctest"))
+   {
+     set.seed(12345)
+     calc_mc_css(chem.name="bisphenol a",model="3compartment")
+     set.seed(12345)
+     calc_mc_css(chem.cas="80-05-7",model="3compartment")
+     set.seed(12345)
+     calc_mc_css(parameters=parameterize_3comp(chem.cas="80-05-7"),model="3compartment")
+   }
+   if (any(script.args=="wetmoretest"))
+   {
+     wetmore.chems <- subset(chem.physical_and_invitro.data,
+       regexpr("Wetmore",Human.Clint.Reference)!=-1 &
+       regexpr("Wetmore",Human.Funbound.plasma.Reference)!=-1)
+     Css.table <- data.frame()
+     for (this.cas in sort(get_lit_cheminfo()))
+       if (this.cas %in% get_cheminfo(model="pbtk") &
+         this.cas %in% wetmore.chems$CAS)
+       {
+         Css.table[this.cas,"Css.lit"] <- get_lit_css(chem.cas=this.cas,
+           output.units="uM",
+           which.quantile=0.5)
+         Css.table[this.cas,"Css.calc"] <- calc_analytic_css(chem.cas=this.cas,
+           model="3compartment")
+       }                                                                          
+     cat(lm(log(Css.lit)~log(Css.calc),data=Css.table)$coefficients)
+       
+     #library(ggplot2)
+     #test.fig <- ggplot(Css.table,aes(x=Css.calc,y=Css.lit)) +
+     #         geom_point(size=3)+
+     #   scale_y_log10()+
+     #   scale_x_log10()+
+     #  ylab(expression(paste(C[aa]," Literature (uM)"))) +
+     #  xlab(expression(paste(C[aa]," 3compartment model (uM)"))) +
+     #  geom_abline(intercept = 0, slope = 1,linetype="dashed", colour="Blue") 
+     #
+     #dev.new()
+     #print(test.fig)
+   }
+ }
> 
> quit("no")
