
R version 3.6.2 (2019-12-12) -- "Dark and Stormy Night"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #R CMD BATCH --no-timing --no-restore --no-save montecarlo_tests.R montecarlo_tests.Rout
> library(httk)
> #options(warn=-1)
> NSAMP <- 10
> 
> 
> 
> #
> #
> # Test that the underlying PK models give the same answers:
> calc_analytic_css(chem.cas="15972-60-8")
Plasma concentration returned in uM units.
[1] 0.1913
There were 50 or more warnings (use warnings() to see the first 50)
> calc_analytic_css(chem.cas="15972-60-8",model="1compartment")
Human volume of distribution returned in units of L/kg BW.
Plasma concentration returned in uM units.
[1] 0.2251
Warning messages:
1: NAs introduced by coercion 
2: NAs introduced by coercion 
3: In available_rblood2plasma(chem.cas = chem.cas, chem.name = chem.name,  :
  Human in vivo measured Rblood2plasma used.
> calc_analytic_css(chem.cas="15972-60-8",model="pbtk")
Plasma concentration returned in uM units.
[1] 0.1913
There were 50 or more warnings (use warnings() to see the first 50)
> calc_analytic_css(chem.cas="15972-60-8",model="3compartment")
Plasma concentration returned in uM units.
[1] 0.226
There were 50 or more warnings (use warnings() to see the first 50)
> 
> 
> 
> #
> #
> # Now test Monte Carlo for a variety of chemicals:
> # Clint and Fup are distributions, clint is zero:
> set.seed(1234)
> calc_mc_css(chem.cas="50594-66-6",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
131.2 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Clint is provided as a distribution.
2: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Fraction unbound is provided as a distribution.
3: NAs introduced by coercion 
4: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
5: NAs introduced by coercion 
6: NAs introduced by coercion 
7: In available_rblood2plasma(chem.name = chem.name, chem.cas = chem.cas,  :
  Human in vivo measured Rblood2plasma used.
8: NAs introduced by coercion 
9: NAs introduced by coercion 
10: NAs introduced by coercion 
> # Human.Clint.pvalue > 0.05, no measured Rblood2plasma
> set.seed(1234)
> calc_mc_css(chem.cas="116-06-3",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
10.09 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
2: In predict_partitioning_schmitt(parameters = parameters, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
> # Human.Funbound.plasma is below LOD (0.005), can't do PBPK, can't predict
> # Rblood2plasma
> set.seed(1234)
> calc_mc_css(chem.cas="101-05-3",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
37.07 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Fraction unbound = 0, changed to 0.005.
2: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
3: In available_rblood2plasma(chem.name = chem.name, chem.cas = chem.cas,  :
  Average in vivo Human Rblood2plasma (0.846) substituted.
4: In parameterize_schmitt(chem.cas = chem.cas, chem.name, dtxsid = dtxsid,  :
  Fraction unbound = 0, can't predict tissue partitioning.
> # well-behaved chemical with a measured Rblood2plasma:
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
2.314 
There were 14 warnings (use warnings() to see them)
> 
> 
> 
> #
> #
> # Now test that MC works across different models:
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",model="3compartment",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
2.316 
There were 50 or more warnings (use warnings() to see the first 50)
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",model="1compartment",samples=NSAMP)
Human volume of distribution returned in units of L/kg BW.
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
2.314 
There were 12 warnings (use warnings() to see them)
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",model="pbtk",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
1.472 
There were 50 or more warnings (use warnings() to see the first 50)
> 
> #
> #
> # Now do different MC sampling:
> set.seed(1234)
> # Standard HTTK Monte Carlo:
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
176.7 
There were 38 warnings (use warnings() to see them)
> set.seed(1234)
> # HTTK Monte Carlo with no measurment uncertainty (pre v1.10.0):
> calc_mc_css(chem.cas="90-43-7",
+   model="pbtk",
+   samples=NSAMP,
+   invitro.mc.arg.list = list(adjusted.Funbound.plasma = T,
+     poormetab = T, 
+     fup.censored.dist = FALSE, 
+     fup.lod = 0.01, 
+     fup.meas.cv = 0.0, 
+     clint.meas.cv = 0.0, 
+     fup.pop.cv = 0.3, 
+     clint.pop.cv = 0.3))
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
120.6 
There were 38 warnings (use warnings() to see them)
> set.seed(1234)
> # HTTK Monte Carlo with no HTTK-Pop physiological variability):
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP,httkpop=F)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
85.73 
There were 38 warnings (use warnings() to see them)
> set.seed(1234)
> # HTTK Monte Carlo with no in vitro uncertainty and variability):
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP,invitrouv=F)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
24.46 
There were 35 warnings (use warnings() to see them)
> set.seed(1234)
> # HTTK Monte Carlo with no HTTK-Pop and no in vitro uncertainty and variability):
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP,httkpop=F,invitrouv=F)
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
13.29 
There were 35 warnings (use warnings() to see them)
> # Should be the same as the mean result:
> calc_analytic_css(chem.cas="90-43-7",model="pbtk",output.units="mg/L")
Plasma concentration returned in mg/L units.
[1] 13.28
There were 34 warnings (use warnings() to see them)
> set.seed(1234)
> # HTTK Monte Carlo using basic Monte Carlo sampler:
> calc_mc_css(chem.cas="90-43-7",
+   model="pbtk",
+   samples=NSAMP,
+   httkpop=F,
+   invitrouv=F,
+   vary.params=list(Pow=0.3))
Human plasma concentration returned in mg/L units for 0.95 quantile.
  95% 
13.41 
There were 35 warnings (use warnings() to see them)
> 
> 
>     
> calc_mc_tk(chem.cas="80-05-7",samples=NSAMP)
$means
      time     Agutlumen      Cgut       Cliver         Cven        Clung
1  0.00000  3.977527e+02 0.0000000 0.000000e+00 0.000000e+00 0.000000e+00
2  0.00001  3.975447e+02 0.1981243 8.239553e-05 8.788985e-09 5.264526e-10
3  0.25000  8.299303e-04 7.8941880 1.051074e+01 5.190715e-01 4.385236e+00
4  0.50000  1.732255e-09 7.2314690 9.648942e+00 4.775482e-01 4.023266e+00
5  0.75000  1.239305e-14 6.6734000 8.937916e+00 4.414694e-01 3.712447e+00
6  1.00000  1.297708e-14 6.1841930 8.310491e+00 4.095859e-01 3.440261e+00
7  1.50000 -1.888525e-15 5.3715210 7.258398e+00 3.560285e-01 2.988749e+00
8  2.00000 -4.838348e-15 4.7280440 6.415367e+00 3.130454e-01 2.631843e+00
9  2.50000  1.056129e-15 4.2083895 5.727321e+00 2.779450e-01 2.344007e+00
10 3.00000  7.775762e-14 3.7808314 5.156042e+00 2.488182e-01 2.107414e+00
11 4.00000  6.414994e-17 3.1187383 4.262230e+00 2.033768e-01 1.741299e+00
12 5.00000  3.121782e-17 2.6280604 3.593477e+00 1.696099e-01 1.469935e+00
           Cart        Crest      Ckidney      Cplasma     Atubules
1  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
2  9.107721e-13 1.150277e-16 1.221219e-14 1.141093e-08 4.077870e-21
3  5.191996e-01 3.532011e+00 1.202682e+01 6.505892e-01 8.333934e-01
4  4.776459e-01 3.249126e+00 1.104074e+01 5.992439e-01 1.436325e+00
5  4.415542e-01 3.000994e+00 1.019368e+01 5.544221e-01 1.993112e+00
6  4.096601e-01 2.783034e+00 9.449965e+00 5.146628e-01 2.509513e+00
7  3.560859e-01 2.419888e+00 8.211746e+00 4.475319e-01 3.439542e+00
8  3.130906e-01 2.131238e+00 7.228609e+00 3.933215e-01 4.256613e+00
9  2.779817e-01 1.897321e+00 6.432776e+00 3.488286e-01 4.982744e+00
10 2.488485e-01 1.704279e+00 5.776773e+00 3.117636e-01 5.634256e+00
11 2.033987e-01 1.404357e+00 4.759117e+00 2.537354e-01 6.759771e+00
12 1.696265e-01 1.181474e+00 4.004178e+00 2.105494e-01 7.701843e+00
   Ametabolized          AUC
1  0.000000e+00 0.000000e+00
2  2.372807e-09 2.856966e-14
3  6.590745e+01 2.136838e-01
4  8.711009e+01 3.697216e-01
5  1.059660e+02 5.138159e-01
6  1.228390e+02 6.473539e-01
7  1.517316e+02 8.872823e-01
8  1.755497e+02 1.097034e+00
9  1.955295e+02 1.282220e+00
10 2.125474e+02 1.447096e+00
11 2.400591e+02 1.728323e+00
12 2.613983e+02 1.959474e+00

$sds
   time    Agutlumen        Cgut       Cliver         Cven        Clung
1     0 1.032177e+01 0.000000000 0.000000e+00 0.000000e+00 0.000000e+00
2     0 1.031643e+01 0.005457557 1.650882e-05 2.622872e-09 3.072558e-10
3     0 2.153690e-05 0.118746000 3.254213e-01 7.658117e-02 1.626920e-01
4     0 4.503173e-11 0.062119667 3.619527e-01 7.412827e-02 1.268387e-01
5     0 3.433339e-15 0.029256667 3.655947e-01 7.093787e-02 1.024223e-01
6     0 8.684674e-15 0.009357667 3.565863e-01 6.734203e-02 8.572367e-02
7     0 6.199117e-16 0.002596333 3.127340e-01 5.946882e-02 6.910620e-02
8     0 5.971684e-15 0.009174667 2.489810e-01 5.131754e-02 6.712757e-02
9     0 2.154000e-15 0.033666500 1.770732e-01 4.337466e-02 7.341217e-02
10    0 2.680630e-14 0.063910467 1.042525e-01 3.591959e-02 8.387790e-02
11    0 1.884434e-16 0.126092767 2.883673e-02 2.296273e-02 1.081031e-01
12    0 3.928164e-17 0.178523453 1.350324e-01 1.275970e-02 1.293282e-01
           Cart        Crest      Ckidney      Cplasma     Atubules
1  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
2  6.894926e-13 5.926443e-17 6.256936e-15 4.423624e-09 1.237623e-21
3  7.656113e-02 6.310300e-02 1.357260e-01 1.529803e-01 8.416547e-02
4  7.411670e-02 7.651800e-02 1.937853e-01 1.459520e-01 1.334649e-01
5  7.092927e-02 8.360533e-02 2.234740e-01 1.383460e-01 1.772773e-01
6  6.733563e-02 8.556533e-02 2.352117e-01 1.305231e-01 2.168710e-01
7  5.946570e-02 7.875740e-02 2.207880e-01 1.147824e-01 2.871740e-01
8  5.131645e-02 6.325060e-02 1.752403e-01 9.954485e-02 3.500743e-01
9  4.337476e-02 4.359980e-02 1.143580e-01 8.527113e-02 4.090880e-01
10 3.592016e-02 2.264043e-02 4.802220e-02 7.219378e-02 4.663253e-01
11 2.296378e-02 1.706233e-02 7.941560e-02 4.989452e-02 5.796270e-01
12 1.276050e-02 4.942128e-02 1.840861e-01 3.249420e-02 6.937010e-01
   Ametabolized          AUC
1  0.000000e+00 0.000000e+00
2  4.609509e-10 1.107495e-14
3  2.738950e+00 4.420773e-02
4  1.904597e+00 8.160147e-02
5  8.036633e-01 1.171450e-01
6  4.766767e-01 1.507554e-01
7  3.333813e+00 2.120759e-01
8  6.306083e+00 2.656253e-01
9  9.181513e+00 3.117833e-01
10 1.184052e+01 3.510947e-01
11 1.631231e+01 4.117123e-01
12 1.961589e+01 4.525220e-01

There were 36 warnings (use warnings() to see them)
> 
> quit("no")
