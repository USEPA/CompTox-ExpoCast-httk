
R version 3.6.2 (2019-12-12) -- "Dark and Stormy Night"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #R CMD BATCH --no-timing --no-restore --no-save montecarlo_tests.R montecarlo_tests.Rout
> library(httk)
> #options(warn=-1)
> NSAMP <- 10
> 
> 
> 
> #
> #
> # Test that the underlying PK models give the same answers:
> calc_analytic_css(chem.cas="15972-60-8")
Plasma concentration returned in uM units.
[1] 0.1913081
Warning messages:
1: In predict_partitioning_schmitt(parameters = schmitt.params, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
2: In parameterize_pbtk(default.to.human = FALSE, adjusted.Funbound.plasma = TRUE,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
3: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human in vivo measured Rblood2plasma used.
> calc_analytic_css(chem.cas="15972-60-8",model="1compartment")
Human volume of distribution returned in units of L/kg BW.
Plasma concentration returned in uM units.
[1] 0.2250561
Warning message:
In available_rblood2plasma(chem.cas = chem.cas, chem.name = chem.name,  :
  Human in vivo measured Rblood2plasma used.
> calc_analytic_css(chem.cas="15972-60-8",model="pbtk")
Plasma concentration returned in uM units.
[1] 0.1913081
Warning messages:
1: In predict_partitioning_schmitt(parameters = schmitt.params, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
2: In parameterize_pbtk(default.to.human = FALSE, adjusted.Funbound.plasma = TRUE,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
3: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human in vivo measured Rblood2plasma used.
> calc_analytic_css(chem.cas="15972-60-8",model="3compartment")
Plasma concentration returned in uM units.
[1] 0.2260238
Warning messages:
1: In predict_partitioning_schmitt(parameters = schmitt.params, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
2: In parameterize_pbtk(chem.cas = chem.cas, chem.name = chem.name,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
3: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human in vivo measured Rblood2plasma used.
> 
> 
> 
> #
> #
> # Now test Monte Carlo for a variety of chemicals:
> # Clint and Fup are distributions, clint is zero:
> set.seed(1234)
> calc_mc_css(chem.cas="50594-66-6",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
   95% 
146.74 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Clint is provided as a distribution.
2: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Fraction unbound is provided as a distribution.
3: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
4: In available_rblood2plasma(chem.name = chem.name, chem.cas = chem.cas,  :
  Human in vivo measured Rblood2plasma used.
5: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
6: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> # Human.Clint.pvalue > 0.05, no measured Rblood2plasma
> set.seed(1234)
> calc_mc_css(chem.cas="116-06-3",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
10.08783 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
2: In predict_partitioning_schmitt(parameters = parameters, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
4: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> # Human.Funbound.plasma is below LOD (0.005), can't do PBPK, can't predict
> # Rblood2plasma
> set.seed(1234)
> calc_mc_css(chem.cas="101-05-3",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
37.07424 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Fraction unbound = 0, changed to 0.005.
2: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
3: In available_rblood2plasma(chem.name = chem.name, chem.cas = chem.cas,  :
  Average in vivo Human Rblood2plasma (0.846) substituted.
4: In parameterize_schmitt(chem.cas = chem.cas, chem.name, dtxsid = dtxsid,  :
  Fraction unbound = 0, can't predict tissue partitioning.
5: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
6: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> # well-behaved chemical with a measured Rblood2plasma:
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
2.314536 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partitioning (Pearce, 2017).
2: In available_rblood2plasma(chem.name = chem.name, chem.cas = chem.cas,  :
  Human in vivo measured Rblood2plasma used.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
4: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> 
> 
> 
> #
> #
> # Now test that MC works across different models:
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",model="3compartment",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
2.316193 
Warning messages:
1: In predict_partitioning_schmitt(parameters = schmitt.params, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
2: In parameterize_pbtk(chem.cas = chem.cas, chem.name = chem.name,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
3: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human in vivo measured Rblood2plasma used.
4: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",model="1compartment",samples=NSAMP)
Human volume of distribution returned in units of L/kg BW.
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
2.314536 
Warning messages:
1: In available_rblood2plasma(chem.cas = chem.cas, chem.name = chem.name,  :
  Human in vivo measured Rblood2plasma used.
2: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
3: In predict_partitioning_schmitt(parameters = parameters.dt) :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
4: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> set.seed(1234)
> calc_mc_css(chem.cas="15972-60-8",model="pbtk",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
1.471638 
Warning messages:
1: In predict_partitioning_schmitt(parameters = schmitt.params, species = species,  :
  Membrane affintity (MA) predicted with method of Yun and Edginton (2013)
2: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
3: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human in vivo measured Rblood2plasma used.
4: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> 
> #
> #
> # Now do different MC sampling:
> set.seed(1234)
> # Standard HTTK Monte Carlo:
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
176.7115 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> set.seed(1234)
> # HTTK Monte Carlo with no measurment uncertainty (pre v1.10.0):
> calc_mc_css(chem.cas="90-43-7",
+   model="pbtk",
+   samples=NSAMP,
+   invitro.mc.arg.list = list(adjusted.Funbound.plasma = T,
+     poormetab = T, 
+     fup.censored.dist = FALSE, 
+     fup.lod = 0.01, 
+     fup.meas.cv = 0.0, 
+     clint.meas.cv = 0.0, 
+     fup.pop.cv = 0.3, 
+     clint.pop.cv = 0.3))
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
120.5482 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> set.seed(1234)
> # HTTK Monte Carlo with no HTTK-Pop physiological variability):
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP,httkpop=F)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
85.72126 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> set.seed(1234)
> # HTTK Monte Carlo with no in vitro uncertainty and variability):
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP,invitrouv=F)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
24.46588 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> set.seed(1234)
> # HTTK Monte Carlo with no HTTK-Pop and no in vitro uncertainty and variability):
> calc_mc_css(chem.cas="90-43-7",model="pbtk",samples=NSAMP,httkpop=F,invitrouv=F)
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
13.29465 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> # Should be the same as the mean result:
> calc_analytic_css(chem.cas="90-43-7",model="pbtk",output.units="mg/L")
Plasma concentration returned in mg/L units.
[1] 13.2816
Warning messages:
1: In parameterize_pbtk(default.to.human = FALSE, adjusted.Funbound.plasma = TRUE,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
> set.seed(1234)
> # HTTK Monte Carlo using basic Monte Carlo sampler:
> calc_mc_css(chem.cas="90-43-7",
+   model="pbtk",
+   samples=NSAMP,
+   httkpop=F,
+   invitrouv=F,
+   vary.params=list(Pow=0.3))
Human plasma concentration returned in mg/L units for 0.95 quantile.
     95% 
13.41496 
Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
2: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human Rblood2plasma calculated with calc_rblood2plasma.
3: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> 
> 
>     
> calc_mc_tk(chem.cas="80-05-7",samples=NSAMP)
$means
      time     Agutlumen      Cgut       Cliver         Cven        Clung
1  0.00000  3.977528e+02 0.0000000 0.000000e+00 0.000000e+00 0.000000e+00
2  0.00001  3.975447e+02 0.1981245 8.235887e-05 8.781807e-09 5.260237e-10
3  0.25000  8.299305e-04 7.8966766 1.051387e+01 5.189787e-01 4.386892e+00
4  0.50000  1.732313e-09 7.2347458 9.652979e+00 4.775172e-01 4.025371e+00
5  0.75000  6.759998e-14 6.6772192 8.942620e+00 4.414835e-01 3.714843e+00
6  1.00000  1.112535e-14 6.1883368 8.315593e+00 4.096317e-01 3.442826e+00
7  1.50000  5.189993e-15 5.3758839 7.263777e+00 3.561111e-01 2.991405e+00
8  2.00000  5.109706e-15 4.7323050 6.420652e+00 3.131433e-01 2.634416e+00
9  2.50000 -1.096379e-14 4.2124209 5.732350e+00 2.780480e-01 2.346429e+00
10 3.00000 -3.571702e-14 3.7845978 5.160777e+00 2.489216e-01 2.109669e+00
11 4.00000  1.053504e-13 3.1220353 4.266438e+00 2.034775e-01 1.743260e+00
12 5.00000 -2.876088e-15 2.6310236 3.597317e+00 1.697091e-01 1.471688e+00
           Cart        Crest      Ckidney      Cplasma     Atubules
1  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
2  9.095679e-13 1.148780e-16 1.219607e-14 1.140195e-08 4.073266e-21
3  5.191068e-01 3.532680e+00 1.202991e+01 6.504776e-01 8.337105e-01
4  4.776148e-01 3.250170e+00 1.104507e+01 5.991999e-01 1.436904e+00
5  4.415682e-01 3.002283e+00 1.019885e+01 5.544280e-01 1.993993e+00
6  4.097057e-01 2.784477e+00 9.455632e+00 5.147043e-01 2.510719e+00
7  3.561684e-01 2.421457e+00 8.217787e+00 4.476159e-01 3.441427e+00
8  3.131887e-01 2.132799e+00 7.234550e+00 3.934250e-01 4.259178e+00
9  2.780848e-01 1.898815e+00 6.438441e+00 3.489401e-01 4.985970e+00
10 2.489519e-01 1.705690e+00 5.782091e+00 3.118780e-01 5.638109e+00
11 2.034992e-01 1.405611e+00 4.763807e+00 2.538508e-01 6.764786e+00
12 1.697256e-01 1.182619e+00 4.008426e+00 2.106661e-01 7.707897e+00
   Ametabolized          AUC
1  0.000000e+00 0.000000e+00
2  2.371066e-09 2.854720e-14
3  6.588443e+01 2.136488e-01
4  8.707198e+01 3.696676e-01
5  1.059166e+02 5.137575e-01
6  1.227812e+02 6.473019e-01
7  1.516631e+02 8.872626e-01
8  1.754756e+02 1.097060e+00
9  1.954518e+02 1.282300e+00
10 2.124678e+02 1.447234e+00
11 2.399759e+02 1.728578e+00
12 2.613125e+02 1.959844e+00

$sds
   time    Agutlumen        Cgut       Cliver         Cven        Clung
1     0 1.032179e+01 0.000000000 0.000000e+00 0.000000e+00 0.000000e+00
2     0 1.031639e+01 0.005457557 1.650086e-05 2.620629e-09 3.069981e-10
3     0 2.153693e-05 0.119525453 3.239679e-01 7.650195e-02 1.631524e-01
4     0 4.496280e-11 0.063197773 3.601831e-01 7.403211e-02 1.274712e-01
5     0 2.394675e-14 0.030546335 3.635781e-01 7.083087e-02 1.031749e-01
6     0 6.946345e-15 0.010783297 3.544207e-01 6.722798e-02 8.654823e-02
7     0 4.848413e-15 0.001052858 3.104587e-01 5.935023e-02 6.999061e-02
8     0 2.369161e-14 0.010716367 2.467317e-01 5.120072e-02 6.800879e-02
9     0 6.790850e-15 0.035156533 1.749097e-01 4.326322e-02 7.425900e-02
10    0 1.076275e-14 0.065327668 1.021997e-01 3.581436e-02 8.468070e-02
11    0 3.471102e-14 0.127364314 3.068089e-02 2.287015e-02 1.088237e-01
12    0 9.111551e-16 0.179683631 1.367086e-01 1.267756e-02 1.299852e-01
           Cart        Crest      Ckidney      Cplasma     Atubules
1  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
2  6.885637e-13 5.918353e-17 6.248470e-15 4.419843e-09 1.236183e-21
3  7.648198e-02 6.280636e-02 1.345343e-01 1.528583e-01 8.422175e-02
4  7.402060e-02 7.608474e-02 1.921568e-01 1.458131e-01 1.335856e-01
5  7.082225e-02 8.307854e-02 2.215315e-01 1.381962e-01 1.774775e-01
6  6.722166e-02 8.497911e-02 2.330531e-01 1.303670e-01 2.171659e-01
7  5.934714e-02 7.811806e-02 2.184576e-01 1.146227e-01 2.876704e-01
8  5.119958e-02 6.260781e-02 1.729107e-01 9.938872e-02 3.507792e-01
9  4.326321e-02 4.297425e-02 1.121009e-01 8.512187e-02 4.100057e-01
10 3.581495e-02 2.204258e-02 4.587176e-02 7.205284e-02 4.674494e-01
11 2.287106e-02 1.760367e-02 8.135096e-02 4.977009e-02 5.811447e-01
12 1.267829e-02 4.991450e-02 1.858500e-01 3.238377e-02 6.955797e-01
   Ametabolized          AUC
1  0.000000e+00 0.000000e+00
2  4.612694e-10 1.106549e-14
3  2.723516e+00 4.418118e-02
4  1.883033e+00 8.154231e-02
5  7.772574e-01 1.170497e-01
6  5.065925e-01 1.506228e-01
7  3.368137e+00 2.118626e-01
8  6.343270e+00 2.653325e-01
9  9.219890e+00 3.114137e-01
10 1.187979e+01 3.506548e-01
11 1.635224e+01 4.111383e-01
12 1.965570e+01 4.518323e-01

Warning messages:
1: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Clint is provided as a distribution.
2: In (function (chem.cas = NULL, chem.name = NULL, dtxsid = NULL,  :
  Funbound.plasma adjusted for in vitro partioning (Pearce, 2017).
3: In available_rblood2plasma(chem.cas = chem.cas, species = species,  :
  Human in vivo measured Rblood2plasma used.
4: In if (nchar(Clint) - nchar(gsub(",", "", Clint)) == 3) { :
  the condition has length > 1 and only the first element will be used
> 
> quit("no")
