
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #R CMD BATCH --no-timing --no-restore --no-save other_tests.R other_tests.Rout
> library(httk)
> options(warn=-1)
> 
> calc_analytic_css(chem.name="bisphenol a",model="3compartment")
Plasma concentration returned in uM units.
[1] 1.4897
> calc_analytic_css(chem.cas="80-05-7",model="3compartment")
Plasma concentration returned in uM units.
[1] 1.4897
> calc_analytic_css(parameters=parameterize_3comp(chem.cas="80-05-7"),model="3compartment")
Plasma concentration returned in uM units.
[1] 1.4897
> calc_analytic_css(chem.name="bisphenol a",model="3compartment",tissue="liver")
Tissue concentration for liver returned in uM units.
[1] 27.10683
> calc_analytic_css(chem.name="bisphenol a",model="3compartment",tissue="brain")
Tissue concentration for brain returned in uM units.
[1] 8.589967
> 
> head(solve_3comp(chem.name="bisphenol a"))
Human amounts returned in umol and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
           time Aintestine       Cliver     Csyscomp     Atubules Ametabolized
[1,] 0.00000000  306.62619  0.000000000 0.000000e+00 0.000000e+00 0.000000e+00
[2,] 0.00001000  306.46581  0.001995306 3.180762e-08 1.894357e-13 7.412964e-08
[3,] 0.01041667  177.79465 35.582650332 1.135028e+00 1.094898e-02 2.824702e+00
[4,] 0.02083333  103.09280 32.226900020 2.532184e+00 5.724005e-02 6.839882e+00
[5,] 0.03125000   59.77750 26.208920586 3.448885e+00 1.322321e-01 1.020606e+01
[6,] 0.04166667   34.66149 22.031959200 3.986032e+00 2.248919e-01 1.297745e+01
              AUC
[1,] 0.000000e+00
[2,] 7.969973e-14
[3,] 4.606475e-03
[4,] 2.408214e-02
[5,] 5.563293e-02
[6,] 9.461692e-02
> head(solve_3comp(chem.cas="80-05-7"))
Human amounts returned in umol and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
           time Aintestine       Cliver     Csyscomp     Atubules Ametabolized
[1,] 0.00000000  306.62619  0.000000000 0.000000e+00 0.000000e+00 0.000000e+00
[2,] 0.00001000  306.46581  0.001995306 3.180762e-08 1.894357e-13 7.412964e-08
[3,] 0.01041667  177.79465 35.582650332 1.135028e+00 1.094898e-02 2.824702e+00
[4,] 0.02083333  103.09280 32.226900020 2.532184e+00 5.724005e-02 6.839882e+00
[5,] 0.03125000   59.77750 26.208920586 3.448885e+00 1.322321e-01 1.020606e+01
[6,] 0.04166667   34.66149 22.031959200 3.986032e+00 2.248919e-01 1.297745e+01
              AUC
[1,] 0.000000e+00
[2,] 7.969973e-14
[3,] 4.606475e-03
[4,] 2.408214e-02
[5,] 5.563293e-02
[6,] 9.461692e-02
> head(solve_3comp(parameters=parameterize_3comp(chem.cas="80-05-7")))
Amounts returned in umol  and concentration returned in uM units.
AUC is area under plasma concentration in uM * days units with 
Rblood2plasma = 0.79.
           time Aintestine       Cliver     Csyscomp     Atubules Ametabolized
[1,] 0.00000000  306.62619  0.000000000 0.000000e+00 0.000000e+00 0.000000e+00
[2,] 0.00001000  306.46581  0.001995306 3.180762e-08 1.894357e-13 7.412964e-08
[3,] 0.01041667  177.79465 35.582650332 1.135028e+00 1.094898e-02 2.824702e+00
[4,] 0.02083333  103.09280 32.226900020 2.532184e+00 5.724005e-02 6.839882e+00
[5,] 0.03125000   59.77750 26.208920586 3.448885e+00 1.322321e-01 1.020606e+01
[6,] 0.04166667   34.66149 22.031959200 3.986032e+00 2.248919e-01 1.297745e+01
              AUC
[1,] 0.000000e+00
[2,] 7.969973e-14
[3,] 4.606475e-03
[4,] 2.408214e-02
[5,] 5.563293e-02
[6,] 9.461692e-02
> 
> script.args <- commandArgs(TRUE)
> if (length(script.args) > 0) 
+ {
+   if (any(script.args=="mctest"))
+   {
+     set.seed(12345)
+     calc_mc_css(chem.name="bisphenol a",model="3compartment")
+     set.seed(12345)
+     calc_mc_css(chem.cas="80-05-7",model="3compartment")
+     set.seed(12345)
+     calc_mc_css(parameters=parameterize_3comp(chem.cas="80-05-7"),model="3compartment")
+   }
+   if (any(script.args=="wetmoretest"))
+   {
+     wetmore.chems <- subset(chem.physical_and_invitro.data,
+       regexpr("Wetmore",Human.Clint.Reference)!=-1 &
+       regexpr("Wetmore",Human.Funbound.plasma.Reference)!=-1)
+     Css.table <- data.frame()
+     for (this.cas in sort(get_lit_cheminfo()))
+       if (this.cas %in% get_cheminfo(model="pbtk") &
+         this.cas %in% wetmore.chems$CAS)
+       {
+         Css.table[this.cas,"Css.lit"] <- get_lit_css(chem.cas=this.cas,
+           output.units="uM",
+           which.quantile=0.5)
+         Css.table[this.cas,"Css.calc"] <- calc_analytic_css(chem.cas=this.cas,
+           model="3compartment")
+       }                                                                          
+     cat(lm(log(Css.lit)~log(Css.calc),data=Css.table)$coefficients)
+       
+     #library(ggplot2)
+     #test.fig <- ggplot(Css.table,aes(x=Css.calc,y=Css.lit)) +
+     #         geom_point(size=3)+
+     #   scale_y_log10()+
+     #   scale_x_log10()+
+     #  ylab(expression(paste(C[aa]," Literature (uM)"))) +
+     #  xlab(expression(paste(C[aa]," 3compartment model (uM)"))) +
+     #  geom_abline(intercept = 0, slope = 1,linetype="dashed", colour="Blue") 
+     #
+     #dev.new()
+     #print(test.fig)
+   }
+ }
> 
> quit("no")
